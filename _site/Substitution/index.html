<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Substitution in the untyped lambda calculus | Programming Language Foundations in Agda
</title><!-- Begin Jekyll SEO tag v2.5.0 -->
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="Substitution in the untyped lambda calculus" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Programming Language Foundations in Agda" />
<meta property="og:description" content="Programming Language Foundations in Agda" />
<link rel="canonical" href="https://plfa.github.io/Substitution/" />
<meta property="og:url" content="https://plfa.github.io/Substitution/" />
<meta property="og:site_name" content="Programming Language Foundations in Agda" />
<script type="application/ld+json">
{"description":"Programming Language Foundations in Agda","@type":"WebPage","url":"https://plfa.github.io/Substitution/","headline":"Substitution in the untyped lambda calculus","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/main.css"></head>
<body><header class="site-header" role="banner">

    <div class="wrapper">

        <a class="site-title" href="/">Programming Language Foundations in Agda
</a>

        <nav class="site-nav">
            <span class="menu-icon">
                <svg viewBox="0 0 18 15" width="18px" height="15px">
                    <path fill="#424242" d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.031C17.335,0,18,0.665,18,1.484L18,1.484z"/>
                    <path fill="#424242" d="M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0c0-0.82,0.665-1.484,1.484-1.484 h15.031C17.335,6.031,18,6.696,18,7.516L18,7.516z"/>
                    <path fill="#424242" d="M18,13.516C18,14.335,17.335,15,16.516,15H1.484C0.665,15,0,14.335,0,13.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.031C17.335,12.031,18,12.696,18,13.516L18,13.516z"/>
                </svg>
            </span>

            <div class="trigger">
                <a class="page-link" href="/">Table of Contents</a>
                <a class="page-link" href="/GettingStarted/">Getting Started</a>
            </div>
        </nav>

    </div>

</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post">

  <header class="post-header">
      <h1 class="post-title">Substitution in the untyped lambda calculus</h1>
  </header>

  <p style="text-align:center;">
    
    <a alt="Previous chapter" href="/Untyped/">Prev</a>
    &bullet;
    
    
    <a alt="Source code" href="https://github.com/plfa/plfa.github.io/blob/dev/src/plfa/Substitution.lagda">Source</a>
    
    
    &bullet;
    <a alt="Next chapter" href="/LambdaReduction/">Next</a>
    
</p>


  <div class="post-content">
    <pre class="Agda"><a id="178" class="Keyword">module</a> <a id="185" href="/Substitution/" class="Module">plfa.Substitution</a> <a id="203" class="Keyword">where</a></pre>

<h2 id="introduction">Introduction</h2>

<p>The primary purpose of this chapter is to prove that substitution
commutes with itself. Barendgredt (1984) refers to this
as the substitution lemma:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>M [x:=N] [y:=L] = M [y:=L] [x:= N[y:=L] ]
</code></pre></div></div>

<p>In our setting, with de Bruijn indices for variables, the statement of
the lemma becomes:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>M [ N ] [ L ] ≡  M〔 L 〕[ N [ L ] ]                     (substitution)
</code></pre></div></div>

<p>where the notation <code class="highlighter-rouge">M 〔 L 〕</code> is for substituting L for index 1 inside
M.  In addition, because we define substitution in terms of parallel
substitution, we have the following generalization, replacing the
substitution of L with an arbitrary parallel substitution σ.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>subst σ (M [ N ]) ≡ (subst (exts σ) M) [ subst σ N ]    (subst-commute)
</code></pre></div></div>

<p>The special case for renamings is also useful.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>rename ρ (M [ N ]) ≡ (rename (ext ρ) M) [ rename ρ N ]
                                                 (rename-subst-commute)
</code></pre></div></div>

<p>The secondary purpose of this chapter is to define the σ algebra of
parallel substitution due to Abadi, Cardelli, Curien, and Levy
(1991). The equations of this algebra not only help us prove the
substitution lemma, but they are generally useful. Furthermore, when
the equations are applied from left to right, they form a rewrite
system that <em>decides</em> whether any two substitutions are equal.</p>

<h2 id="imports">Imports</h2>

<pre class="Agda"><a id="1551" class="Keyword">open</a> <a id="1556" class="Keyword">import</a> <a id="1563" href="/Untyped/" class="Module">plfa.Untyped</a>
  <a id="1578" class="Keyword">using</a> <a id="1584" class="Symbol">(</a><a id="1585" href="/Untyped/#2675" class="Datatype">Type</a><a id="1589" class="Symbol">;</a> <a id="1591" href="/Untyped/#2980" class="Datatype">Context</a><a id="1598" class="Symbol">;</a> <a id="1600" href="/Untyped/#4150" class="Datatype Operator">_⊢_</a><a id="1603" class="Symbol">;</a> <a id="1605" href="/Untyped/#2694" class="InductiveConstructor">★</a><a id="1606" class="Symbol">;</a> <a id="1608" href="/Untyped/#3365" class="Datatype Operator">_∋_</a><a id="1611" class="Symbol">;</a> <a id="1613" href="/Untyped/#3002" class="InductiveConstructor">∅</a><a id="1614" class="Symbol">;</a> <a id="1616" href="/Untyped/#3018" class="InductiveConstructor Operator">_,_</a><a id="1619" class="Symbol">;</a> <a id="1621" href="/Untyped/#3401" class="InductiveConstructor">Z</a><a id="1622" class="Symbol">;</a> <a id="1624" href="/Untyped/#3446" class="InductiveConstructor Operator">S_</a><a id="1626" class="Symbol">;</a> <a id="1628" href="/Untyped/#4186" class="InductiveConstructor Operator">`_</a><a id="1630" class="Symbol">;</a> <a id="1632" href="/Untyped/#4238" class="InductiveConstructor Operator">ƛ_</a><a id="1634" class="Symbol">;</a> <a id="1636" href="/Untyped/#4298" class="InductiveConstructor Operator">_·_</a><a id="1639" class="Symbol">;</a>
         <a id="1650" href="/Untyped/#6171" class="Function">rename</a><a id="1656" class="Symbol">;</a> <a id="1658" href="/Untyped/#6931" class="Function">subst</a><a id="1663" class="Symbol">;</a> <a id="1665" href="/Untyped/#5845" class="Function">ext</a><a id="1668" class="Symbol">;</a> <a id="1670" href="/Untyped/#6623" class="Function">exts</a><a id="1674" class="Symbol">;</a> <a id="1676" href="/Untyped/#7475" class="Function Operator">_[_]</a><a id="1680" class="Symbol">;</a> <a id="1682" href="/Untyped/#7359" class="Function">subst-zero</a><a id="1692" class="Symbol">)</a>
<a id="1694" class="Keyword">import</a> <a id="1701" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html" class="Module">Relation.Binary.PropositionalEquality</a> <a id="1739" class="Symbol">as</a> <a id="1742" class="Module">Eq</a>
<a id="1745" class="Keyword">open</a> <a id="1750" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html" class="Module">Eq</a> <a id="1753" class="Keyword">using</a> <a id="1759" class="Symbol">(</a><a id="1760" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#83" class="Datatype Operator">_≡_</a><a id="1763" class="Symbol">;</a> <a id="1765" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a><a id="1769" class="Symbol">;</a> <a id="1771" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.Core.html#838" class="Function">sym</a><a id="1774" class="Symbol">;</a> <a id="1776" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#1170" class="Function">cong</a><a id="1780" class="Symbol">;</a> <a id="1782" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#1408" class="Function">cong₂</a><a id="1787" class="Symbol">;</a> <a id="1789" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#1274" class="Function">cong-app</a><a id="1797" class="Symbol">)</a>
<a id="1799" class="Keyword">open</a> <a id="1804" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#3975" class="Module">Eq.≡-Reasoning</a> <a id="1819" class="Keyword">using</a> <a id="1825" class="Symbol">(</a><a id="1826" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4076" class="Function Operator">begin_</a><a id="1832" class="Symbol">;</a> <a id="1834" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4134" class="Function Operator">_≡⟨⟩_</a><a id="1839" class="Symbol">;</a> <a id="1841" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">_≡⟨_⟩_</a><a id="1847" class="Symbol">;</a> <a id="1849" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4374" class="Function Operator">_∎</a><a id="1851" class="Symbol">)</a>
<a id="1853" class="Keyword">open</a> <a id="1858" class="Keyword">import</a> <a id="1865" href="https://agda.github.io/agda-stdlib/v0.17/Function.html" class="Module">Function</a> <a id="1874" class="Keyword">using</a> <a id="1880" class="Symbol">(</a><a id="1881" href="https://agda.github.io/agda-stdlib/v0.17/Function.html#769" class="Function Operator">_∘_</a><a id="1884" class="Symbol">)</a>
<a id="1886" class="Comment">-- open import plfa.Isomorphism using (extensionality)  -- causes a bug!</a></pre>

<pre class="Agda"><a id="1984" class="Keyword">postulate</a>
  <a id="extensionality"></a><a id="1996" href="/Substitution/#1996" class="Postulate">extensionality</a> <a id="2011" class="Symbol">:</a> <a id="2013" class="Symbol">∀</a> <a id="2015" class="Symbol">{</a><a id="2016" href="/Substitution/#2016" class="Bound">A</a> <a id="2018" href="/Substitution/#2018" class="Bound">B</a> <a id="2020" class="Symbol">:</a> <a id="2022" class="PrimitiveType">Set</a><a id="2025" class="Symbol">}</a> <a id="2027" class="Symbol">{</a><a id="2028" href="/Substitution/#2028" class="Bound">f</a> <a id="2030" href="/Substitution/#2030" class="Bound">g</a> <a id="2032" class="Symbol">:</a> <a id="2034" href="/Substitution/#2016" class="Bound">A</a> <a id="2036" class="Symbol">→</a> <a id="2038" href="/Substitution/#2018" class="Bound">B</a><a id="2039" class="Symbol">}</a>
    <a id="2045" class="Symbol">→</a> <a id="2047" class="Symbol">(∀</a> <a id="2050" class="Symbol">(</a><a id="2051" href="/Substitution/#2051" class="Bound">x</a> <a id="2053" class="Symbol">:</a> <a id="2055" href="/Substitution/#2016" class="Bound">A</a><a id="2056" class="Symbol">)</a> <a id="2058" class="Symbol">→</a> <a id="2060" href="/Substitution/#2028" class="Bound">f</a> <a id="2062" href="/Substitution/#2051" class="Bound">x</a> <a id="2064" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="2066" href="/Substitution/#2030" class="Bound">g</a> <a id="2068" href="/Substitution/#2051" class="Bound">x</a><a id="2069" class="Symbol">)</a>
      <a id="2077" class="Comment">-----------------------</a>
    <a id="2105" class="Symbol">→</a> <a id="2107" href="/Substitution/#2028" class="Bound">f</a> <a id="2109" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="2111" href="/Substitution/#2030" class="Bound">g</a></pre>

<h2 id="notation">Notation</h2>

<p>We introduce the following shorthand for the type of a <em>renaming</em> from
variables in context <code class="highlighter-rouge">Γ</code> to variables in context <code class="highlighter-rouge">Δ</code>.</p>

<pre class="Agda"><a id="Rename"></a><a id="2277" href="/Substitution/#2277" class="Function">Rename</a> <a id="2284" class="Symbol">:</a> <a id="2286" href="/Untyped/#2980" class="Datatype">Context</a> <a id="2294" class="Symbol">→</a> <a id="2296" href="/Untyped/#2980" class="Datatype">Context</a> <a id="2304" class="Symbol">→</a> <a id="2306" class="PrimitiveType">Set</a>
<a id="2310" href="/Substitution/#2277" class="Function">Rename</a> <a id="2317" href="/Substitution/#2317" class="Bound">Γ</a> <a id="2319" href="/Substitution/#2319" class="Bound">Δ</a> <a id="2321" class="Symbol">=</a> <a id="2323" class="Symbol">∀{</a><a id="2325" href="/Substitution/#2325" class="Bound">A</a><a id="2326" class="Symbol">}</a> <a id="2328" class="Symbol">→</a> <a id="2330" href="/Substitution/#2317" class="Bound">Γ</a> <a id="2332" href="/Untyped/#3365" class="Datatype Operator">∋</a> <a id="2334" href="/Substitution/#2325" class="Bound">A</a> <a id="2336" class="Symbol">→</a> <a id="2338" href="/Substitution/#2319" class="Bound">Δ</a> <a id="2340" href="/Untyped/#3365" class="Datatype Operator">∋</a> <a id="2342" href="/Substitution/#2325" class="Bound">A</a></pre>

<p>Similarly, we introduce the following shorthand for the type of a
<em>substitution</em> from variables in context <code class="highlighter-rouge">Γ</code> to terms in context <code class="highlighter-rouge">Δ</code>.</p>

<pre class="Agda"><a id="Subst"></a><a id="2506" href="/Substitution/#2506" class="Function">Subst</a> <a id="2512" class="Symbol">:</a> <a id="2514" href="/Untyped/#2980" class="Datatype">Context</a> <a id="2522" class="Symbol">→</a> <a id="2524" href="/Untyped/#2980" class="Datatype">Context</a> <a id="2532" class="Symbol">→</a> <a id="2534" class="PrimitiveType">Set</a>
<a id="2538" href="/Substitution/#2506" class="Function">Subst</a> <a id="2544" href="/Substitution/#2544" class="Bound">Γ</a> <a id="2546" href="/Substitution/#2546" class="Bound">Δ</a> <a id="2548" class="Symbol">=</a> <a id="2550" class="Symbol">∀{</a><a id="2552" href="/Substitution/#2552" class="Bound">A</a><a id="2553" class="Symbol">}</a> <a id="2555" class="Symbol">→</a> <a id="2557" href="/Substitution/#2544" class="Bound">Γ</a> <a id="2559" href="/Untyped/#3365" class="Datatype Operator">∋</a> <a id="2561" href="/Substitution/#2552" class="Bound">A</a> <a id="2563" class="Symbol">→</a> <a id="2565" href="/Substitution/#2546" class="Bound">Δ</a> <a id="2567" href="/Untyped/#4150" class="Datatype Operator">⊢</a> <a id="2569" href="/Substitution/#2552" class="Bound">A</a></pre>

<p>We use the following more succinct notation the <code class="highlighter-rouge">subst</code> function.</p>

<pre class="Agda"><a id="⟪_⟫"></a><a id="2663" href="/Substitution/#2663" class="Function Operator">⟪_⟫</a> <a id="2667" class="Symbol">:</a> <a id="2669" class="Symbol">∀{</a><a id="2671" href="/Substitution/#2671" class="Bound">Γ</a> <a id="2673" href="/Substitution/#2673" class="Bound">Δ</a> <a id="2675" href="/Substitution/#2675" class="Bound">A</a><a id="2676" class="Symbol">}</a> <a id="2678" class="Symbol">→</a> <a id="2680" href="/Substitution/#2506" class="Function">Subst</a> <a id="2686" href="/Substitution/#2671" class="Bound">Γ</a> <a id="2688" href="/Substitution/#2673" class="Bound">Δ</a> <a id="2690" class="Symbol">→</a> <a id="2692" href="/Substitution/#2671" class="Bound">Γ</a> <a id="2694" href="/Untyped/#4150" class="Datatype Operator">⊢</a> <a id="2696" href="/Substitution/#2675" class="Bound">A</a> <a id="2698" class="Symbol">→</a> <a id="2700" href="/Substitution/#2673" class="Bound">Δ</a> <a id="2702" href="/Untyped/#4150" class="Datatype Operator">⊢</a> <a id="2704" href="/Substitution/#2675" class="Bound">A</a>
<a id="2706" href="/Substitution/#2663" class="Function Operator">⟪</a> <a id="2708" href="/Substitution/#2708" class="Bound">σ</a> <a id="2710" href="/Substitution/#2663" class="Function Operator">⟫</a> <a id="2712" class="Symbol">=</a> <a id="2714" class="Symbol">λ</a> <a id="2716" href="/Substitution/#2716" class="Bound">M</a> <a id="2718" class="Symbol">→</a> <a id="2720" href="/Untyped/#6931" class="Function">subst</a> <a id="2726" href="/Substitution/#2708" class="Bound">σ</a> <a id="2728" href="/Substitution/#2716" class="Bound">M</a></pre>

<h2 id="the-σ-algebra-of-substitution">The σ algebra of substitution</h2>

<p>Substitutions map de Bruijn indices (natural numbers) to terms, so we
can view a substitution simply as a sequence of terms, or more
precisely, as an infinite sequence of terms. The σ algebra consists of
four operations for building such sequences: identity <code class="highlighter-rouge">ids</code>, shift
<code class="highlighter-rouge">↑</code>, cons <code class="highlighter-rouge">M • σ</code>, and sequencing <code class="highlighter-rouge">σ ⨟ τ</code>.  The sequence <code class="highlighter-rouge">0, 1, 2, ...</code>
is constructed by the identity substitution.</p>

<pre class="Agda"><a id="ids"></a><a id="3179" href="/Substitution/#3179" class="Function">ids</a> <a id="3183" class="Symbol">:</a> <a id="3185" class="Symbol">∀{</a><a id="3187" href="/Substitution/#3187" class="Bound">Γ</a><a id="3188" class="Symbol">}</a> <a id="3190" class="Symbol">→</a> <a id="3192" href="/Substitution/#2506" class="Function">Subst</a> <a id="3198" href="/Substitution/#3187" class="Bound">Γ</a> <a id="3200" href="/Substitution/#3187" class="Bound">Γ</a>
<a id="3202" href="/Substitution/#3179" class="Function">ids</a> <a id="3206" href="/Substitution/#3206" class="Bound">x</a> <a id="3208" class="Symbol">=</a> <a id="3210" href="/Untyped/#4186" class="InductiveConstructor Operator">`</a> <a id="3212" href="/Substitution/#3206" class="Bound">x</a></pre>

<p>The shift operation <code class="highlighter-rouge">↑</code> constructs the sequence</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>1, 2, 3, ...
</code></pre></div></div>

<p>and is defined as follows.</p>

<pre class="Agda"><a id="↑"></a><a id="3334" href="/Substitution/#3334" class="Function">↑</a> <a id="3336" class="Symbol">:</a> <a id="3338" class="Symbol">∀{</a><a id="3340" href="/Substitution/#3340" class="Bound">Γ</a> <a id="3342" href="/Substitution/#3342" class="Bound">A</a><a id="3343" class="Symbol">}</a> <a id="3345" class="Symbol">→</a> <a id="3347" href="/Substitution/#2506" class="Function">Subst</a> <a id="3353" href="/Substitution/#3340" class="Bound">Γ</a> <a id="3355" class="Symbol">(</a><a id="3356" href="/Substitution/#3340" class="Bound">Γ</a> <a id="3358" href="/Untyped/#3018" class="InductiveConstructor Operator">,</a> <a id="3360" href="/Substitution/#3342" class="Bound">A</a><a id="3361" class="Symbol">)</a>
<a id="3363" href="/Substitution/#3334" class="Function">↑</a> <a id="3365" href="/Substitution/#3365" class="Bound">x</a> <a id="3367" class="Symbol">=</a> <a id="3369" href="/Untyped/#4186" class="InductiveConstructor Operator">`</a> <a id="3371" class="Symbol">(</a><a id="3372" href="/Untyped/#3446" class="InductiveConstructor Operator">S</a> <a id="3374" href="/Substitution/#3365" class="Bound">x</a><a id="3375" class="Symbol">)</a></pre>

<p>Given a term <code class="highlighter-rouge">M</code> and substitution <code class="highlighter-rouge">σ</code>, the operation
<code class="highlighter-rouge">M • σ</code> constructs the sequence</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>M , σ 0, σ 1, σ 2, ...
</code></pre></div></div>

<p>This operation is analogous to the <code class="highlighter-rouge">cons</code> operation of Lisp.</p>

<pre class="Agda"><a id="3578" class="Keyword">infixr</a> <a id="3585" class="Number">6</a> <a id="3587" href="/Substitution/#3592" class="Function Operator">_•_</a>

<a id="_•_"></a><a id="3592" href="/Substitution/#3592" class="Function Operator">_•_</a> <a id="3596" class="Symbol">:</a> <a id="3598" class="Symbol">∀{</a><a id="3600" href="/Substitution/#3600" class="Bound">Γ</a> <a id="3602" href="/Substitution/#3602" class="Bound">Δ</a> <a id="3604" href="/Substitution/#3604" class="Bound">A</a><a id="3605" class="Symbol">}</a> <a id="3607" class="Symbol">→</a> <a id="3609" class="Symbol">(</a><a id="3610" href="/Substitution/#3602" class="Bound">Δ</a> <a id="3612" href="/Untyped/#4150" class="Datatype Operator">⊢</a> <a id="3614" href="/Substitution/#3604" class="Bound">A</a><a id="3615" class="Symbol">)</a> <a id="3617" class="Symbol">→</a> <a id="3619" href="/Substitution/#2506" class="Function">Subst</a> <a id="3625" href="/Substitution/#3600" class="Bound">Γ</a> <a id="3627" href="/Substitution/#3602" class="Bound">Δ</a> <a id="3629" class="Symbol">→</a> <a id="3631" href="/Substitution/#2506" class="Function">Subst</a> <a id="3637" class="Symbol">(</a><a id="3638" href="/Substitution/#3600" class="Bound">Γ</a> <a id="3640" href="/Untyped/#3018" class="InductiveConstructor Operator">,</a> <a id="3642" href="/Substitution/#3604" class="Bound">A</a><a id="3643" class="Symbol">)</a> <a id="3645" href="/Substitution/#3602" class="Bound">Δ</a>
<a id="3647" class="Symbol">(</a><a id="3648" href="/Substitution/#3648" class="Bound">M</a> <a id="3650" href="/Substitution/#3592" class="Function Operator">•</a> <a id="3652" href="/Substitution/#3652" class="Bound">σ</a><a id="3653" class="Symbol">)</a> <a id="3655" href="/Untyped/#3401" class="InductiveConstructor">Z</a> <a id="3657" class="Symbol">=</a> <a id="3659" href="/Substitution/#3648" class="Bound">M</a>
<a id="3661" class="Symbol">(</a><a id="3662" href="/Substitution/#3662" class="Bound">M</a> <a id="3664" href="/Substitution/#3592" class="Function Operator">•</a> <a id="3666" href="/Substitution/#3666" class="Bound">σ</a><a id="3667" class="Symbol">)</a> <a id="3669" class="Symbol">(</a><a id="3670" href="/Untyped/#3446" class="InductiveConstructor Operator">S</a> <a id="3672" href="/Substitution/#3672" class="Bound">x</a><a id="3673" class="Symbol">)</a> <a id="3675" class="Symbol">=</a> <a id="3677" href="/Substitution/#3666" class="Bound">σ</a> <a id="3679" href="/Substitution/#3672" class="Bound">x</a></pre>

<p>Given two substitutions <code class="highlighter-rouge">σ</code> and <code class="highlighter-rouge">τ</code>, the sequencing operation <code class="highlighter-rouge">σ ⨟ τ</code>
produces the sequence</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>⟪τ⟫(σ 0), ⟪τ⟫(σ 1), ⟪τ⟫(σ 2), ...
</code></pre></div></div>

<p>That is, it composes the two substitutions by first applying
<code class="highlighter-rouge">σ</code> and then applying <code class="highlighter-rouge">τ</code>.</p>

<pre class="Agda"><a id="3931" class="Keyword">infixr</a> <a id="3938" class="Number">5</a> <a id="3940" href="/Substitution/#3945" class="Function Operator">_⨟_</a>

<a id="_⨟_"></a><a id="3945" href="/Substitution/#3945" class="Function Operator">_⨟_</a> <a id="3949" class="Symbol">:</a> <a id="3951" class="Symbol">∀{</a><a id="3953" href="/Substitution/#3953" class="Bound">Γ</a> <a id="3955" href="/Substitution/#3955" class="Bound">Δ</a> <a id="3957" href="/Substitution/#3957" class="Bound">Σ</a><a id="3958" class="Symbol">}</a> <a id="3960" class="Symbol">→</a> <a id="3962" href="/Substitution/#2506" class="Function">Subst</a> <a id="3968" href="/Substitution/#3953" class="Bound">Γ</a> <a id="3970" href="/Substitution/#3955" class="Bound">Δ</a> <a id="3972" class="Symbol">→</a> <a id="3974" href="/Substitution/#2506" class="Function">Subst</a> <a id="3980" href="/Substitution/#3955" class="Bound">Δ</a> <a id="3982" href="/Substitution/#3957" class="Bound">Σ</a> <a id="3984" class="Symbol">→</a> <a id="3986" href="/Substitution/#2506" class="Function">Subst</a> <a id="3992" href="/Substitution/#3953" class="Bound">Γ</a> <a id="3994" href="/Substitution/#3957" class="Bound">Σ</a>
<a id="3996" href="/Substitution/#3996" class="Bound">σ</a> <a id="3998" href="/Substitution/#3945" class="Function Operator">⨟</a> <a id="4000" href="/Substitution/#4000" class="Bound">τ</a> <a id="4002" class="Symbol">=</a> <a id="4004" href="/Substitution/#2663" class="Function Operator">⟪</a> <a id="4006" href="/Substitution/#4000" class="Bound">τ</a> <a id="4008" href="/Substitution/#2663" class="Function Operator">⟫</a> <a id="4010" href="https://agda.github.io/agda-stdlib/v0.17/Function.html#769" class="Function Operator">∘</a> <a id="4012" href="/Substitution/#3996" class="Bound">σ</a></pre>

<p>For the sequencing operation, Abadi et al. use the notation of
function composition, writing <code class="highlighter-rouge">σ ∘ τ</code>, but still with <code class="highlighter-rouge">σ</code> applied
before <code class="highlighter-rouge">τ</code>, which is the opposite of standard mathematical
practice. We instead write <code class="highlighter-rouge">σ ⨟ τ</code>, because semicolon is
the standard notation for forward function composition.</p>

<h2 id="the-σ-algebra-equations">The σ algebra equations</h2>

<p>The σ algebra includes the following equations.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>(sub-head)  ⟪ M • σ ⟫ (` Z) ≡ M
(sub-tail)  ↑ ⨟ (M • σ)    ≡ σ
(sub-η)     (⟪ σ ⟫ (` Z)) • (↑ ⨟ σ) ≡ σ
(Z-shift)   (` Z) • ↑      ≡ ids

(sub-id)    ⟪ ids ⟫ M      ≡ M
(sub-app)   ⟪ σ ⟫ (L · M)  ≡ (⟪ σ ⟫ L) · (⟪ σ ⟫ M)
(sub-abs)   ⟪ σ ⟫ (ƛ N)    ≡ ƛ ⟪ σ ⟫ N
(sub-sub)   ⟪ τ ⟫ ⟪ σ ⟫ M  ≡ ⟪ σ ⨟ τ ⟫ M

(sub-idL)   ids ⨟ σ        ≡ σ
(sub-idR)   σ ⨟ ids        ≡ σ
(sub-assoc) (σ ⨟ τ) ⨟ θ    ≡ σ ⨟ (τ ⨟ θ)
(sub-dist)  (M • σ) ⨟ τ    ≡ (⟪ τ ⟫ M) • (σ ⨟ τ)
</code></pre></div></div>

<p>The first group of equations describe how the <code class="highlighter-rouge">•</code> operator acts like cons.
The equation <code class="highlighter-rouge">sub-head</code> says that the variable zero <code class="highlighter-rouge">Z</code> returns the
head of the sequence (it acts like the <code class="highlighter-rouge">car</code> of Lisp).  Similarly,
<code class="highlighter-rouge">sub-tail</code> says that sequencing with shift <code class="highlighter-rouge">↑</code> returns the tail of the
sequence (it acts like <code class="highlighter-rouge">cdr</code> of Lisp).  The <code class="highlighter-rouge">sub-η</code> equation is the
η-expansion rule for sequences, saying that taking the head and tail
of a sequence, and then cons’ing them together yields the original
sequence. The <code class="highlighter-rouge">Z-shift</code> equation says that cons’ing zero onto the
shifted sequence produces the identity sequence.</p>

<p>The next four equations involve applying substitutions to terms.  The
equation <code class="highlighter-rouge">sub-id</code> says that the identity substitution returns the term
unchanged. The equations <code class="highlighter-rouge">sub-app</code> and <code class="highlighter-rouge">sub-abs</code> says that
substitution is a congruence for the lambda calculus. The <code class="highlighter-rouge">sub-sub</code>
equation says that the sequence operator <code class="highlighter-rouge">⨟</code> behaves as intended.</p>

<p>The last four equations concern the sequencing of substitutions.
The first two equations, <code class="highlighter-rouge">sub-idL</code> and <code class="highlighter-rouge">sub-idR</code>, say that
<code class="highlighter-rouge">ids</code> is the left and right unit of the sequencing operator.
The <code class="highlighter-rouge">sub-assoc</code> equation says that sequencing is associative.
Finally, <code class="highlighter-rouge">sub-dist</code> says that post-sequencing distributes through cons.</p>

<h2 id="relating-the-σ-algebra-and-substitution-functions">Relating the σ algebra and substitution functions</h2>

<p>The definitions of substitution <code class="highlighter-rouge">N [ M ]</code> and parallel substitution
<code class="highlighter-rouge">subst σ N</code> depend on several auxiliary functions: <code class="highlighter-rouge">rename</code>, <code class="highlighter-rouge">exts</code>,
<code class="highlighter-rouge">ext</code>, and <code class="highlighter-rouge">subst-zero</code>. We shall relate those functions to terms in
the σ algebra.</p>

<p>To begin with, renaming can be expressed in terms of substitution.
We have</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>rename ρ M ≡ ⟪ ren ρ ⟫ M               (rename-subst-ren)
</code></pre></div></div>

<p>where <code class="highlighter-rouge">ren</code> turns a renaming <code class="highlighter-rouge">ρ</code> into a substitution by post-composing
<code class="highlighter-rouge">ρ</code> with the identity substitution.</p>

<pre class="Agda"><a id="ren"></a><a id="6703" href="/Substitution/#6703" class="Function">ren</a> <a id="6707" class="Symbol">:</a> <a id="6709" class="Symbol">∀{</a><a id="6711" href="/Substitution/#6711" class="Bound">Γ</a> <a id="6713" href="/Substitution/#6713" class="Bound">Δ</a><a id="6714" class="Symbol">}</a> <a id="6716" class="Symbol">→</a> <a id="6718" href="/Substitution/#2277" class="Function">Rename</a> <a id="6725" href="/Substitution/#6711" class="Bound">Γ</a> <a id="6727" href="/Substitution/#6713" class="Bound">Δ</a> <a id="6729" class="Symbol">→</a> <a id="6731" href="/Substitution/#2506" class="Function">Subst</a> <a id="6737" href="/Substitution/#6711" class="Bound">Γ</a> <a id="6739" href="/Substitution/#6713" class="Bound">Δ</a>
<a id="6741" href="/Substitution/#6703" class="Function">ren</a> <a id="6745" href="/Substitution/#6745" class="Bound">ρ</a> <a id="6747" class="Symbol">=</a> <a id="6749" href="/Substitution/#3179" class="Function">ids</a> <a id="6753" href="https://agda.github.io/agda-stdlib/v0.17/Function.html#769" class="Function Operator">∘</a> <a id="6755" href="/Substitution/#6745" class="Bound">ρ</a></pre>

<p>When the renaming is the increment function, then it is equivalent to
shift.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ren S_ ≡ ↑                             (ren-shift)

rename S_ M ≡ ⟪ ↑ ⟫ M                  (rename-shift)
</code></pre></div></div>

<p>Renaming with the identity renaming leaves the term unchanged.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>rename (λ {A} x → x) M ≡ M             (rename-id)
</code></pre></div></div>

<p>Next we relate the <code class="highlighter-rouge">exts</code> function to the σ algebra.  Recall that the
<code class="highlighter-rouge">exts</code> function extends a substitution as follows:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>exts σ = ` Z, rename S_ (σ 0), rename S_ (σ 1), rename S_ (σ 2), ...
</code></pre></div></div>

<p>So <code class="highlighter-rouge">exts</code> is equivalent to cons’ing Z onto the sequence formed
by applying <code class="highlighter-rouge">σ</code> and then shifting.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>exts σ ≡ ` Z • (σ ⨟ ↑)                (exts-cons-shift)
</code></pre></div></div>

<p>The <code class="highlighter-rouge">ext</code> function does the same job as <code class="highlighter-rouge">exts</code> but for renamings
instead of substitutions. So composing <code class="highlighter-rouge">ext</code> with <code class="highlighter-rouge">ren</code> is the same as
composing <code class="highlighter-rouge">ren</code> with <code class="highlighter-rouge">exts</code>.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ren (ext ρ) ≡ exts (ren ρ)            (ren-ext)
</code></pre></div></div>

<p>Thus, we can recast the <code class="highlighter-rouge">exts-cons-shift</code> equation in terms of
renamings.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ren (ext ρ) ≡ ` Z • (ren ρ ⨟ ↑)       (ext-cons-Z-shift)
</code></pre></div></div>

<p>It is also useful to specialize the <code class="highlighter-rouge">sub-sub</code> equation of the σ
algebra to the situation where the first substitution is a renaming.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>⟪ σ ⟫ (rename ρ M) ≡ ⟪ σ ∘ ρ ⟫ M       (rename-subst)
</code></pre></div></div>

<p>The <code class="highlighter-rouge">subst-zero M</code> substitution is equivalent to cons’ing
<code class="highlighter-rouge">M</code> onto the identity substitution.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>subst-zero M ≡ M • ids                (subst-Z-cons-ids)
</code></pre></div></div>

<p>Finally, sequencing <code class="highlighter-rouge">exts σ</code> with <code class="highlighter-rouge">subst-zero M</code> is equivalent to
cons’ing <code class="highlighter-rouge">M</code> onto <code class="highlighter-rouge">σ</code>.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>exts σ ⨟ subst-zero M ≡ (M • σ)       (subst-zero-exts-cons)
</code></pre></div></div>

<h2 id="proofs-of-sub-head-sub-tail-sub-η-z-shift-sub-idl-sub-dist-and-sub-app">Proofs of sub-head, sub-tail, sub-η, Z-shift, sub-idL, sub-dist, and sub-app</h2>

<p>We start with the proofs that are immediate from the definitions of
the operators.</p>

<pre class="Agda"><a id="sub-head"></a><a id="8484" href="/Substitution/#8484" class="Function">sub-head</a> <a id="8493" class="Symbol">:</a> <a id="8495" class="Symbol">∀</a> <a id="8497" class="Symbol">{</a><a id="8498" href="/Substitution/#8498" class="Bound">Γ</a> <a id="8500" href="/Substitution/#8500" class="Bound">Δ</a><a id="8501" class="Symbol">}</a> <a id="8503" class="Symbol">{</a><a id="8504" href="/Substitution/#8504" class="Bound">A</a><a id="8505" class="Symbol">}</a> <a id="8507" class="Symbol">{</a><a id="8508" href="/Substitution/#8508" class="Bound">M</a> <a id="8510" class="Symbol">:</a> <a id="8512" href="/Substitution/#8500" class="Bound">Δ</a> <a id="8514" href="/Untyped/#4150" class="Datatype Operator">⊢</a> <a id="8516" href="/Substitution/#8504" class="Bound">A</a><a id="8517" class="Symbol">}{</a><a id="8519" href="/Substitution/#8519" class="Bound">σ</a> <a id="8521" class="Symbol">:</a> <a id="8523" href="/Substitution/#2506" class="Function">Subst</a> <a id="8529" href="/Substitution/#8498" class="Bound">Γ</a> <a id="8531" href="/Substitution/#8500" class="Bound">Δ</a><a id="8532" class="Symbol">}</a>
         <a id="8543" class="Symbol">→</a> <a id="8545" href="/Substitution/#2663" class="Function Operator">⟪</a> <a id="8547" href="/Substitution/#8508" class="Bound">M</a> <a id="8549" href="/Substitution/#3592" class="Function Operator">•</a> <a id="8551" href="/Substitution/#8519" class="Bound">σ</a> <a id="8553" href="/Substitution/#2663" class="Function Operator">⟫</a> <a id="8555" class="Symbol">(</a><a id="8556" href="/Untyped/#4186" class="InductiveConstructor Operator">`</a> <a id="8558" href="/Untyped/#3401" class="InductiveConstructor">Z</a><a id="8559" class="Symbol">)</a> <a id="8561" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="8563" href="/Substitution/#8508" class="Bound">M</a>
<a id="8565" href="/Substitution/#8484" class="Function">sub-head</a> <a id="8574" class="Symbol">=</a> <a id="8576" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a></pre>

<pre class="Agda"><a id="sub-tail"></a><a id="8606" href="/Substitution/#8606" class="Function">sub-tail</a> <a id="8615" class="Symbol">:</a> <a id="8617" class="Symbol">∀{</a><a id="8619" href="/Substitution/#8619" class="Bound">Γ</a> <a id="8621" href="/Substitution/#8621" class="Bound">Δ</a><a id="8622" class="Symbol">}</a> <a id="8624" class="Symbol">{</a><a id="8625" href="/Substitution/#8625" class="Bound">A</a> <a id="8627" href="/Substitution/#8627" class="Bound">B</a><a id="8628" class="Symbol">}</a> <a id="8630" class="Symbol">{</a><a id="8631" href="/Substitution/#8631" class="Bound">M</a> <a id="8633" class="Symbol">:</a> <a id="8635" href="/Substitution/#8621" class="Bound">Δ</a> <a id="8637" href="/Untyped/#4150" class="Datatype Operator">⊢</a> <a id="8639" href="/Substitution/#8625" class="Bound">A</a><a id="8640" class="Symbol">}</a> <a id="8642" class="Symbol">{</a><a id="8643" href="/Substitution/#8643" class="Bound">σ</a> <a id="8645" class="Symbol">:</a> <a id="8647" href="/Substitution/#2506" class="Function">Subst</a> <a id="8653" href="/Substitution/#8619" class="Bound">Γ</a> <a id="8655" href="/Substitution/#8621" class="Bound">Δ</a><a id="8656" class="Symbol">}</a>
         <a id="8667" class="Symbol">→</a> <a id="8669" class="Symbol">(</a><a id="8670" href="/Substitution/#3334" class="Function">↑</a> <a id="8672" href="/Substitution/#3945" class="Function Operator">⨟</a> <a id="8674" href="/Substitution/#8631" class="Bound">M</a> <a id="8676" href="/Substitution/#3592" class="Function Operator">•</a> <a id="8678" href="/Substitution/#8643" class="Bound">σ</a><a id="8679" class="Symbol">)</a> <a id="8681" class="Symbol">{</a><a id="8682" class="Argument">A</a> <a id="8684" class="Symbol">=</a> <a id="8686" href="/Substitution/#8627" class="Bound">B</a><a id="8687" class="Symbol">}</a> <a id="8689" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="8691" href="/Substitution/#8643" class="Bound">σ</a>
<a id="8693" href="/Substitution/#8606" class="Function">sub-tail</a> <a id="8702" class="Symbol">=</a> <a id="8704" href="/Substitution/#1996" class="Postulate">extensionality</a> <a id="8719" class="Symbol">λ</a> <a id="8721" href="/Substitution/#8721" class="Bound">x</a> <a id="8723" class="Symbol">→</a> <a id="8725" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a></pre>

<pre class="Agda"><a id="sub-η"></a><a id="8755" href="/Substitution/#8755" class="Function">sub-η</a> <a id="8761" class="Symbol">:</a> <a id="8763" class="Symbol">∀{</a><a id="8765" href="/Substitution/#8765" class="Bound">Γ</a> <a id="8767" href="/Substitution/#8767" class="Bound">Δ</a><a id="8768" class="Symbol">}</a> <a id="8770" class="Symbol">{</a><a id="8771" href="/Substitution/#8771" class="Bound">A</a> <a id="8773" href="/Substitution/#8773" class="Bound">B</a><a id="8774" class="Symbol">}</a> <a id="8776" class="Symbol">{</a><a id="8777" href="/Substitution/#8777" class="Bound">σ</a> <a id="8779" class="Symbol">:</a> <a id="8781" href="/Substitution/#2506" class="Function">Subst</a> <a id="8787" class="Symbol">(</a><a id="8788" href="/Substitution/#8765" class="Bound">Γ</a> <a id="8790" href="/Untyped/#3018" class="InductiveConstructor Operator">,</a> <a id="8792" href="/Substitution/#8771" class="Bound">A</a><a id="8793" class="Symbol">)</a> <a id="8795" href="/Substitution/#8767" class="Bound">Δ</a><a id="8796" class="Symbol">}</a> 
      <a id="8805" class="Symbol">→</a> <a id="8807" class="Symbol">(</a><a id="8808" href="/Substitution/#2663" class="Function Operator">⟪</a> <a id="8810" href="/Substitution/#8777" class="Bound">σ</a> <a id="8812" href="/Substitution/#2663" class="Function Operator">⟫</a> <a id="8814" class="Symbol">(</a><a id="8815" href="/Untyped/#4186" class="InductiveConstructor Operator">`</a> <a id="8817" href="/Untyped/#3401" class="InductiveConstructor">Z</a><a id="8818" class="Symbol">)</a> <a id="8820" href="/Substitution/#3592" class="Function Operator">•</a> <a id="8822" class="Symbol">(</a><a id="8823" href="/Substitution/#3334" class="Function">↑</a> <a id="8825" href="/Substitution/#3945" class="Function Operator">⨟</a> <a id="8827" href="/Substitution/#8777" class="Bound">σ</a><a id="8828" class="Symbol">))</a> <a id="8831" class="Symbol">{</a><a id="8832" class="Argument">A</a> <a id="8834" class="Symbol">=</a> <a id="8836" href="/Substitution/#8773" class="Bound">B</a><a id="8837" class="Symbol">}</a> <a id="8839" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="8841" href="/Substitution/#8777" class="Bound">σ</a>
<a id="8843" href="/Substitution/#8755" class="Function">sub-η</a> <a id="8849" class="Symbol">{</a><a id="8850" href="/Substitution/#8850" class="Bound">Γ</a><a id="8851" class="Symbol">}{</a><a id="8853" href="/Substitution/#8853" class="Bound">Δ</a><a id="8854" class="Symbol">}{</a><a id="8856" href="/Substitution/#8856" class="Bound">A</a><a id="8857" class="Symbol">}{</a><a id="8859" href="/Substitution/#8859" class="Bound">B</a><a id="8860" class="Symbol">}{</a><a id="8862" href="/Substitution/#8862" class="Bound">σ</a><a id="8863" class="Symbol">}</a> <a id="8865" class="Symbol">=</a> <a id="8867" href="/Substitution/#1996" class="Postulate">extensionality</a> <a id="8882" class="Symbol">λ</a> <a id="8884" href="/Substitution/#8884" class="Bound">x</a> <a id="8886" class="Symbol">→</a> <a id="8888" href="/Substitution/#8907" class="Function">lemma</a>
   <a id="8897" class="Keyword">where</a> 
   <a id="8907" href="/Substitution/#8907" class="Function">lemma</a> <a id="8913" class="Symbol">:</a> <a id="8915" class="Symbol">∀</a> <a id="8917" class="Symbol">{</a><a id="8918" href="/Substitution/#8918" class="Bound">x</a><a id="8919" class="Symbol">}</a> <a id="8921" class="Symbol">→</a> <a id="8923" class="Symbol">((</a><a id="8925" href="/Substitution/#2663" class="Function Operator">⟪</a> <a id="8927" href="/Substitution/#8862" class="Bound">σ</a> <a id="8929" href="/Substitution/#2663" class="Function Operator">⟫</a> <a id="8931" class="Symbol">(</a><a id="8932" href="/Untyped/#4186" class="InductiveConstructor Operator">`</a> <a id="8934" href="/Untyped/#3401" class="InductiveConstructor">Z</a><a id="8935" class="Symbol">))</a> <a id="8938" href="/Substitution/#3592" class="Function Operator">•</a> <a id="8940" class="Symbol">(</a><a id="8941" href="/Substitution/#3334" class="Function">↑</a> <a id="8943" href="/Substitution/#3945" class="Function Operator">⨟</a> <a id="8945" href="/Substitution/#8862" class="Bound">σ</a><a id="8946" class="Symbol">))</a> <a id="8949" href="/Substitution/#8918" class="Bound">x</a> <a id="8951" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="8953" href="/Substitution/#8862" class="Bound">σ</a> <a id="8955" href="/Substitution/#8918" class="Bound">x</a>
   <a id="8960" href="/Substitution/#8907" class="Function">lemma</a> <a id="8966" class="Symbol">{</a><a id="8967" class="Argument">x</a> <a id="8969" class="Symbol">=</a> <a id="8971" href="/Untyped/#3401" class="InductiveConstructor">Z</a><a id="8972" class="Symbol">}</a> <a id="8974" class="Symbol">=</a> <a id="8976" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a>
   <a id="8984" href="/Substitution/#8907" class="Function">lemma</a> <a id="8990" class="Symbol">{</a><a id="8991" class="Argument">x</a> <a id="8993" class="Symbol">=</a> <a id="8995" href="/Untyped/#3446" class="InductiveConstructor Operator">S</a> <a id="8997" href="/Substitution/#8997" class="Bound">x</a><a id="8998" class="Symbol">}</a> <a id="9000" class="Symbol">=</a> <a id="9002" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a></pre>

<pre class="Agda"><a id="Z-shift"></a><a id="9032" href="/Substitution/#9032" class="Function">Z-shift</a> <a id="9040" class="Symbol">:</a> <a id="9042" class="Symbol">∀{</a><a id="9044" href="/Substitution/#9044" class="Bound">Γ</a><a id="9045" class="Symbol">}{</a><a id="9047" href="/Substitution/#9047" class="Bound">A</a> <a id="9049" href="/Substitution/#9049" class="Bound">B</a><a id="9050" class="Symbol">}</a>
        <a id="9060" class="Symbol">→</a> <a id="9062" class="Symbol">((</a><a id="9064" href="/Untyped/#4186" class="InductiveConstructor Operator">`</a> <a id="9066" href="/Untyped/#3401" class="InductiveConstructor">Z</a><a id="9067" class="Symbol">)</a> <a id="9069" href="/Substitution/#3592" class="Function Operator">•</a> <a id="9071" href="/Substitution/#3334" class="Function">↑</a><a id="9072" class="Symbol">)</a> <a id="9074" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="9076" href="/Substitution/#3179" class="Function">ids</a> <a id="9080" class="Symbol">{</a><a id="9081" href="/Substitution/#9044" class="Bound">Γ</a> <a id="9083" href="/Untyped/#3018" class="InductiveConstructor Operator">,</a> <a id="9085" href="/Substitution/#9047" class="Bound">A</a><a id="9086" class="Symbol">}</a> <a id="9088" class="Symbol">{</a><a id="9089" href="/Substitution/#9049" class="Bound">B</a><a id="9090" class="Symbol">}</a>
<a id="9092" href="/Substitution/#9032" class="Function">Z-shift</a> <a id="9100" class="Symbol">{</a><a id="9101" href="/Substitution/#9101" class="Bound">Γ</a><a id="9102" class="Symbol">}{</a><a id="9104" href="/Substitution/#9104" class="Bound">A</a><a id="9105" class="Symbol">}{</a><a id="9107" href="/Substitution/#9107" class="Bound">B</a><a id="9108" class="Symbol">}</a> <a id="9110" class="Symbol">=</a> <a id="9112" href="/Substitution/#1996" class="Postulate">extensionality</a> <a id="9127" href="/Substitution/#9146" class="Function">lemma</a> 
   <a id="9137" class="Keyword">where</a>
   <a id="9146" href="/Substitution/#9146" class="Function">lemma</a> <a id="9152" class="Symbol">:</a> <a id="9154" class="Symbol">(</a><a id="9155" href="/Substitution/#9155" class="Bound">x</a> <a id="9157" class="Symbol">:</a> <a id="9159" href="/Substitution/#9101" class="Bound">Γ</a> <a id="9161" href="/Untyped/#3018" class="InductiveConstructor Operator">,</a> <a id="9163" href="/Substitution/#9104" class="Bound">A</a> <a id="9165" href="/Untyped/#3365" class="Datatype Operator">∋</a> <a id="9167" href="/Substitution/#9107" class="Bound">B</a><a id="9168" class="Symbol">)</a> <a id="9170" class="Symbol">→</a> <a id="9172" class="Symbol">((</a><a id="9174" href="/Untyped/#4186" class="InductiveConstructor Operator">`</a> <a id="9176" href="/Untyped/#3401" class="InductiveConstructor">Z</a><a id="9177" class="Symbol">)</a> <a id="9179" href="/Substitution/#3592" class="Function Operator">•</a> <a id="9181" href="/Substitution/#3334" class="Function">↑</a><a id="9182" class="Symbol">)</a> <a id="9184" href="/Substitution/#9155" class="Bound">x</a> <a id="9186" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="9188" href="/Substitution/#3179" class="Function">ids</a> <a id="9192" href="/Substitution/#9155" class="Bound">x</a>
   <a id="9197" href="/Substitution/#9146" class="Function">lemma</a> <a id="9203" href="/Untyped/#3401" class="InductiveConstructor">Z</a> <a id="9205" class="Symbol">=</a> <a id="9207" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a>
   <a id="9215" href="/Substitution/#9146" class="Function">lemma</a> <a id="9221" class="Symbol">(</a><a id="9222" href="/Untyped/#3446" class="InductiveConstructor Operator">S</a> <a id="9224" href="/Substitution/#9224" class="Bound">y</a><a id="9225" class="Symbol">)</a> <a id="9227" class="Symbol">=</a> <a id="9229" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a></pre>

<pre class="Agda"><a id="sub-idL"></a><a id="9259" href="/Substitution/#9259" class="Function">sub-idL</a> <a id="9267" class="Symbol">:</a> <a id="9269" class="Symbol">∀{</a><a id="9271" href="/Substitution/#9271" class="Bound">Γ</a> <a id="9273" href="/Substitution/#9273" class="Bound">Δ</a><a id="9274" class="Symbol">}</a> <a id="9276" class="Symbol">{</a><a id="9277" href="/Substitution/#9277" class="Bound">σ</a> <a id="9279" class="Symbol">:</a> <a id="9281" href="/Substitution/#2506" class="Function">Subst</a> <a id="9287" href="/Substitution/#9271" class="Bound">Γ</a> <a id="9289" href="/Substitution/#9273" class="Bound">Δ</a><a id="9290" class="Symbol">}</a> <a id="9292" class="Symbol">{</a><a id="9293" href="/Substitution/#9293" class="Bound">A</a><a id="9294" class="Symbol">}</a>
       <a id="9303" class="Symbol">→</a> <a id="9305" href="/Substitution/#3179" class="Function">ids</a> <a id="9309" href="/Substitution/#3945" class="Function Operator">⨟</a> <a id="9311" href="/Substitution/#9277" class="Bound">σ</a> <a id="9313" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="9315" href="/Substitution/#9277" class="Bound">σ</a> <a id="9317" class="Symbol">{</a><a id="9318" href="/Substitution/#9293" class="Bound">A</a><a id="9319" class="Symbol">}</a>
<a id="9321" href="/Substitution/#9259" class="Function">sub-idL</a> <a id="9329" class="Symbol">=</a> <a id="9331" href="/Substitution/#1996" class="Postulate">extensionality</a> <a id="9346" class="Symbol">λ</a> <a id="9348" href="/Substitution/#9348" class="Bound">x</a> <a id="9350" class="Symbol">→</a> <a id="9352" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a></pre>

<pre class="Agda"><a id="sub-dist"></a><a id="9382" href="/Substitution/#9382" class="Function">sub-dist</a> <a id="9391" class="Symbol">:</a>  <a id="9394" class="Symbol">∀{</a><a id="9396" href="/Substitution/#9396" class="Bound">Γ</a> <a id="9398" href="/Substitution/#9398" class="Bound">Δ</a> <a id="9400" href="/Substitution/#9400" class="Bound">Σ</a> <a id="9402" class="Symbol">:</a> <a id="9404" href="/Untyped/#2980" class="Datatype">Context</a><a id="9411" class="Symbol">}</a> <a id="9413" class="Symbol">{</a><a id="9414" href="/Substitution/#9414" class="Bound">A</a> <a id="9416" href="/Substitution/#9416" class="Bound">B</a><a id="9417" class="Symbol">}</a> <a id="9419" class="Symbol">{</a><a id="9420" href="/Substitution/#9420" class="Bound">σ</a> <a id="9422" class="Symbol">:</a> <a id="9424" href="/Substitution/#2506" class="Function">Subst</a> <a id="9430" href="/Substitution/#9396" class="Bound">Γ</a> <a id="9432" href="/Substitution/#9398" class="Bound">Δ</a><a id="9433" class="Symbol">}</a> <a id="9435" class="Symbol">{</a><a id="9436" href="/Substitution/#9436" class="Bound">τ</a> <a id="9438" class="Symbol">:</a> <a id="9440" href="/Substitution/#2506" class="Function">Subst</a> <a id="9446" href="/Substitution/#9398" class="Bound">Δ</a> <a id="9448" href="/Substitution/#9400" class="Bound">Σ</a><a id="9449" class="Symbol">}</a>
              <a id="9465" class="Symbol">{</a><a id="9466" href="/Substitution/#9466" class="Bound">M</a> <a id="9468" class="Symbol">:</a> <a id="9470" href="/Substitution/#9398" class="Bound">Δ</a> <a id="9472" href="/Untyped/#4150" class="Datatype Operator">⊢</a> <a id="9474" href="/Substitution/#9414" class="Bound">A</a><a id="9475" class="Symbol">}</a>
         <a id="9486" class="Symbol">→</a> <a id="9488" class="Symbol">((</a><a id="9490" href="/Substitution/#9466" class="Bound">M</a> <a id="9492" href="/Substitution/#3592" class="Function Operator">•</a> <a id="9494" href="/Substitution/#9420" class="Bound">σ</a><a id="9495" class="Symbol">)</a> <a id="9497" href="/Substitution/#3945" class="Function Operator">⨟</a> <a id="9499" href="/Substitution/#9436" class="Bound">τ</a><a id="9500" class="Symbol">)</a> <a id="9502" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="9504" class="Symbol">((</a><a id="9506" href="/Untyped/#6931" class="Function">subst</a> <a id="9512" href="/Substitution/#9436" class="Bound">τ</a> <a id="9514" href="/Substitution/#9466" class="Bound">M</a><a id="9515" class="Symbol">)</a> <a id="9517" href="/Substitution/#3592" class="Function Operator">•</a> <a id="9519" class="Symbol">(</a><a id="9520" href="/Substitution/#9420" class="Bound">σ</a> <a id="9522" href="/Substitution/#3945" class="Function Operator">⨟</a> <a id="9524" href="/Substitution/#9436" class="Bound">τ</a><a id="9525" class="Symbol">))</a> <a id="9528" class="Symbol">{</a><a id="9529" href="/Substitution/#9416" class="Bound">B</a><a id="9530" class="Symbol">}</a>
<a id="9532" href="/Substitution/#9382" class="Function">sub-dist</a> <a id="9541" class="Symbol">{</a><a id="9542" href="/Substitution/#9542" class="Bound">Γ</a><a id="9543" class="Symbol">}{</a><a id="9545" href="/Substitution/#9545" class="Bound">Δ</a><a id="9546" class="Symbol">}{</a><a id="9548" href="/Substitution/#9548" class="Bound">Σ</a><a id="9549" class="Symbol">}{</a><a id="9551" href="/Substitution/#9551" class="Bound">A</a><a id="9552" class="Symbol">}{</a><a id="9554" href="/Substitution/#9554" class="Bound">B</a><a id="9555" class="Symbol">}{</a><a id="9557" href="/Substitution/#9557" class="Bound">σ</a><a id="9558" class="Symbol">}{</a><a id="9560" href="/Substitution/#9560" class="Bound">τ</a><a id="9561" class="Symbol">}{</a><a id="9563" href="/Substitution/#9563" class="Bound">M</a><a id="9564" class="Symbol">}</a> <a id="9566" class="Symbol">=</a> <a id="9568" href="/Substitution/#1996" class="Postulate">extensionality</a> <a id="9583" class="Symbol">λ</a> <a id="9585" href="/Substitution/#9585" class="Bound">x</a> <a id="9587" class="Symbol">→</a> <a id="9589" href="/Substitution/#9613" class="Function">lemma</a> <a id="9595" class="Symbol">{</a><a id="9596" class="Argument">x</a> <a id="9598" class="Symbol">=</a> <a id="9600" href="/Substitution/#9585" class="Bound">x</a><a id="9601" class="Symbol">}</a>
  <a id="9605" class="Keyword">where</a>
  <a id="9613" href="/Substitution/#9613" class="Function">lemma</a> <a id="9619" class="Symbol">:</a> <a id="9621" class="Symbol">∀</a> <a id="9623" class="Symbol">{</a><a id="9624" href="/Substitution/#9624" class="Bound">x</a> <a id="9626" class="Symbol">:</a> <a id="9628" href="/Substitution/#9542" class="Bound">Γ</a> <a id="9630" href="/Untyped/#3018" class="InductiveConstructor Operator">,</a> <a id="9632" href="/Substitution/#9551" class="Bound">A</a> <a id="9634" href="/Untyped/#3365" class="Datatype Operator">∋</a> <a id="9636" href="/Substitution/#9554" class="Bound">B</a><a id="9637" class="Symbol">}</a> <a id="9639" class="Symbol">→</a> <a id="9641" class="Symbol">((</a><a id="9643" href="/Substitution/#9563" class="Bound">M</a> <a id="9645" href="/Substitution/#3592" class="Function Operator">•</a> <a id="9647" href="/Substitution/#9557" class="Bound">σ</a><a id="9648" class="Symbol">)</a> <a id="9650" href="/Substitution/#3945" class="Function Operator">⨟</a> <a id="9652" href="/Substitution/#9560" class="Bound">τ</a><a id="9653" class="Symbol">)</a> <a id="9655" href="/Substitution/#9624" class="Bound">x</a> <a id="9657" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="9659" class="Symbol">((</a><a id="9661" href="/Untyped/#6931" class="Function">subst</a> <a id="9667" href="/Substitution/#9560" class="Bound">τ</a> <a id="9669" href="/Substitution/#9563" class="Bound">M</a><a id="9670" class="Symbol">)</a> <a id="9672" href="/Substitution/#3592" class="Function Operator">•</a> <a id="9674" class="Symbol">(</a><a id="9675" href="/Substitution/#9557" class="Bound">σ</a> <a id="9677" href="/Substitution/#3945" class="Function Operator">⨟</a> <a id="9679" href="/Substitution/#9560" class="Bound">τ</a><a id="9680" class="Symbol">))</a> <a id="9683" href="/Substitution/#9624" class="Bound">x</a>
  <a id="9687" href="/Substitution/#9613" class="Function">lemma</a> <a id="9693" class="Symbol">{</a><a id="9694" class="Argument">x</a> <a id="9696" class="Symbol">=</a> <a id="9698" href="/Untyped/#3401" class="InductiveConstructor">Z</a><a id="9699" class="Symbol">}</a> <a id="9701" class="Symbol">=</a> <a id="9703" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a>
  <a id="9710" href="/Substitution/#9613" class="Function">lemma</a> <a id="9716" class="Symbol">{</a><a id="9717" class="Argument">x</a> <a id="9719" class="Symbol">=</a> <a id="9721" href="/Untyped/#3446" class="InductiveConstructor Operator">S</a> <a id="9723" href="/Substitution/#9723" class="Bound">x</a><a id="9724" class="Symbol">}</a> <a id="9726" class="Symbol">=</a> <a id="9728" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a></pre>

<pre class="Agda"><a id="sub-app"></a><a id="9758" href="/Substitution/#9758" class="Function">sub-app</a> <a id="9766" class="Symbol">:</a> <a id="9768" class="Symbol">∀{</a><a id="9770" href="/Substitution/#9770" class="Bound">Γ</a> <a id="9772" href="/Substitution/#9772" class="Bound">Δ</a><a id="9773" class="Symbol">}</a> <a id="9775" class="Symbol">{</a><a id="9776" href="/Substitution/#9776" class="Bound">σ</a> <a id="9778" class="Symbol">:</a> <a id="9780" href="/Substitution/#2506" class="Function">Subst</a> <a id="9786" href="/Substitution/#9770" class="Bound">Γ</a> <a id="9788" href="/Substitution/#9772" class="Bound">Δ</a><a id="9789" class="Symbol">}</a> <a id="9791" class="Symbol">{</a><a id="9792" href="/Substitution/#9792" class="Bound">L</a> <a id="9794" class="Symbol">:</a> <a id="9796" href="/Substitution/#9770" class="Bound">Γ</a> <a id="9798" href="/Untyped/#4150" class="Datatype Operator">⊢</a> <a id="9800" href="/Untyped/#2694" class="InductiveConstructor">★</a><a id="9801" class="Symbol">}{</a><a id="9803" href="/Substitution/#9803" class="Bound">M</a> <a id="9805" class="Symbol">:</a> <a id="9807" href="/Substitution/#9770" class="Bound">Γ</a> <a id="9809" href="/Untyped/#4150" class="Datatype Operator">⊢</a> <a id="9811" href="/Untyped/#2694" class="InductiveConstructor">★</a><a id="9812" class="Symbol">}</a>
        <a id="9822" class="Symbol">→</a> <a id="9824" href="/Substitution/#2663" class="Function Operator">⟪</a> <a id="9826" href="/Substitution/#9776" class="Bound">σ</a> <a id="9828" href="/Substitution/#2663" class="Function Operator">⟫</a> <a id="9830" class="Symbol">(</a><a id="9831" href="/Substitution/#9792" class="Bound">L</a> <a id="9833" href="/Untyped/#4298" class="InductiveConstructor Operator">·</a> <a id="9835" href="/Substitution/#9803" class="Bound">M</a><a id="9836" class="Symbol">)</a>  <a id="9839" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="9841" class="Symbol">(</a><a id="9842" href="/Substitution/#2663" class="Function Operator">⟪</a> <a id="9844" href="/Substitution/#9776" class="Bound">σ</a> <a id="9846" href="/Substitution/#2663" class="Function Operator">⟫</a> <a id="9848" href="/Substitution/#9792" class="Bound">L</a><a id="9849" class="Symbol">)</a> <a id="9851" href="/Untyped/#4298" class="InductiveConstructor Operator">·</a> <a id="9853" class="Symbol">(</a><a id="9854" href="/Substitution/#2663" class="Function Operator">⟪</a> <a id="9856" href="/Substitution/#9776" class="Bound">σ</a> <a id="9858" href="/Substitution/#2663" class="Function Operator">⟫</a> <a id="9860" href="/Substitution/#9803" class="Bound">M</a><a id="9861" class="Symbol">)</a>
<a id="9863" href="/Substitution/#9758" class="Function">sub-app</a> <a id="9871" class="Symbol">=</a> <a id="9873" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a></pre>

<h2 id="interlude-congruences">Interlude: congruences</h2>

<p>In this section we establish congruence rules for the σ algebra
operators <code class="highlighter-rouge">•</code> and <code class="highlighter-rouge">⨟</code> and for <code class="highlighter-rouge">subst</code> and its helper functions <code class="highlighter-rouge">ext</code>,
<code class="highlighter-rouge">rename</code>, <code class="highlighter-rouge">exts</code>, and <code class="highlighter-rouge">subst-zero</code>. These congruence rules help with
the equational reasoning in the later sections of this chapter.</p>

<p>[JGS: I would have liked to prove all of these via cong and cong₂,
 but I have not yet found a way to make that work. It seems that
 various implicit parameters get in the way.]</p>

<pre class="Agda"><a id="cong-ext"></a><a id="10386" href="/Substitution/#10386" class="Function">cong-ext</a> <a id="10395" class="Symbol">:</a> <a id="10397" class="Symbol">∀{</a><a id="10399" href="/Substitution/#10399" class="Bound">Γ</a> <a id="10401" href="/Substitution/#10401" class="Bound">Δ</a><a id="10402" class="Symbol">}{</a><a id="10404" href="/Substitution/#10404" class="Bound">ρ</a> <a id="10406" href="/Substitution/#10406" class="Bound">ρ′</a> <a id="10409" class="Symbol">:</a> <a id="10411" href="/Substitution/#2277" class="Function">Rename</a> <a id="10418" href="/Substitution/#10399" class="Bound">Γ</a> <a id="10420" href="/Substitution/#10401" class="Bound">Δ</a><a id="10421" class="Symbol">}{</a><a id="10423" href="/Substitution/#10423" class="Bound">B</a><a id="10424" class="Symbol">}</a>
   <a id="10429" class="Symbol">→</a> <a id="10431" class="Symbol">(∀{</a><a id="10434" href="/Substitution/#10434" class="Bound">A</a><a id="10435" class="Symbol">}</a> <a id="10437" class="Symbol">→</a> <a id="10439" href="/Substitution/#10404" class="Bound">ρ</a> <a id="10441" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="10443" href="/Substitution/#10406" class="Bound">ρ′</a> <a id="10446" class="Symbol">{</a><a id="10447" href="/Substitution/#10434" class="Bound">A</a><a id="10448" class="Symbol">})</a>
     <a id="10456" class="Comment">---------------------------------</a>
   <a id="10493" class="Symbol">→</a> <a id="10495" class="Symbol">∀{</a><a id="10497" href="/Substitution/#10497" class="Bound">A</a><a id="10498" class="Symbol">}</a> <a id="10500" class="Symbol">→</a> <a id="10502" href="/Untyped/#5845" class="Function">ext</a> <a id="10506" href="/Substitution/#10404" class="Bound">ρ</a> <a id="10508" class="Symbol">{</a><a id="10509" class="Argument">B</a> <a id="10511" class="Symbol">=</a> <a id="10513" href="/Substitution/#10423" class="Bound">B</a><a id="10514" class="Symbol">}</a> <a id="10516" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="10518" href="/Untyped/#5845" class="Function">ext</a> <a id="10522" href="/Substitution/#10406" class="Bound">ρ′</a> <a id="10525" class="Symbol">{</a><a id="10526" href="/Substitution/#10497" class="Bound">A</a><a id="10527" class="Symbol">}</a>
<a id="10529" href="/Substitution/#10386" class="Function">cong-ext</a><a id="10537" class="Symbol">{</a><a id="10538" href="/Substitution/#10538" class="Bound">Γ</a><a id="10539" class="Symbol">}{</a><a id="10541" href="/Substitution/#10541" class="Bound">Δ</a><a id="10542" class="Symbol">}{</a><a id="10544" href="/Substitution/#10544" class="Bound">ρ</a><a id="10545" class="Symbol">}{</a><a id="10547" href="/Substitution/#10547" class="Bound">ρ′</a><a id="10549" class="Symbol">}{</a><a id="10551" href="/Substitution/#10551" class="Bound">B</a><a id="10552" class="Symbol">}</a> <a id="10554" href="/Substitution/#10554" class="Bound">rr</a> <a id="10557" class="Symbol">{</a><a id="10558" href="/Substitution/#10558" class="Bound">A</a><a id="10559" class="Symbol">}</a> <a id="10561" class="Symbol">=</a> <a id="10563" href="/Substitution/#1996" class="Postulate">extensionality</a> <a id="10578" class="Symbol">λ</a> <a id="10580" href="/Substitution/#10580" class="Bound">x</a> <a id="10582" class="Symbol">→</a> <a id="10584" href="/Substitution/#10604" class="Function">lemma</a> <a id="10590" class="Symbol">{</a><a id="10591" href="/Substitution/#10580" class="Bound">x</a><a id="10592" class="Symbol">}</a>
  <a id="10596" class="Keyword">where</a>
  <a id="10604" href="/Substitution/#10604" class="Function">lemma</a> <a id="10610" class="Symbol">:</a> <a id="10612" class="Symbol">∀{</a><a id="10614" href="/Substitution/#10614" class="Bound">x</a> <a id="10616" class="Symbol">:</a> <a id="10618" href="/Substitution/#10538" class="Bound">Γ</a> <a id="10620" href="/Untyped/#3018" class="InductiveConstructor Operator">,</a> <a id="10622" href="/Substitution/#10551" class="Bound">B</a> <a id="10624" href="/Untyped/#3365" class="Datatype Operator">∋</a> <a id="10626" href="/Substitution/#10558" class="Bound">A</a><a id="10627" class="Symbol">}</a> <a id="10629" class="Symbol">→</a> <a id="10631" href="/Untyped/#5845" class="Function">ext</a> <a id="10635" href="/Substitution/#10544" class="Bound">ρ</a> <a id="10637" href="/Substitution/#10614" class="Bound">x</a> <a id="10639" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="10641" href="/Untyped/#5845" class="Function">ext</a> <a id="10645" href="/Substitution/#10547" class="Bound">ρ′</a> <a id="10648" href="/Substitution/#10614" class="Bound">x</a>
  <a id="10652" href="/Substitution/#10604" class="Function">lemma</a> <a id="10658" class="Symbol">{</a><a id="10659" href="/Untyped/#3401" class="InductiveConstructor">Z</a><a id="10660" class="Symbol">}</a> <a id="10662" class="Symbol">=</a> <a id="10664" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a>
  <a id="10671" href="/Substitution/#10604" class="Function">lemma</a> <a id="10677" class="Symbol">{</a><a id="10678" href="/Untyped/#3446" class="InductiveConstructor Operator">S</a> <a id="10680" href="/Substitution/#10680" class="Bound">y</a><a id="10681" class="Symbol">}</a> <a id="10683" class="Symbol">=</a> <a id="10685" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#1170" class="Function">cong</a> <a id="10690" href="/Untyped/#3446" class="InductiveConstructor Operator">S_</a> <a id="10693" class="Symbol">(</a><a id="10694" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#1274" class="Function">cong-app</a> <a id="10703" href="/Substitution/#10554" class="Bound">rr</a> <a id="10706" href="/Substitution/#10680" class="Bound">y</a><a id="10707" class="Symbol">)</a></pre>

<pre class="Agda"><a id="cong-rename"></a><a id="10734" href="/Substitution/#10734" class="Function">cong-rename</a> <a id="10746" class="Symbol">:</a> <a id="10748" class="Symbol">∀{</a><a id="10750" href="/Substitution/#10750" class="Bound">Γ</a> <a id="10752" href="/Substitution/#10752" class="Bound">Δ</a><a id="10753" class="Symbol">}{</a><a id="10755" href="/Substitution/#10755" class="Bound">ρ</a> <a id="10757" href="/Substitution/#10757" class="Bound">ρ′</a> <a id="10760" class="Symbol">:</a> <a id="10762" href="/Substitution/#2277" class="Function">Rename</a> <a id="10769" href="/Substitution/#10750" class="Bound">Γ</a> <a id="10771" href="/Substitution/#10752" class="Bound">Δ</a><a id="10772" class="Symbol">}{</a><a id="10774" href="/Substitution/#10774" class="Bound">B</a><a id="10775" class="Symbol">}{</a><a id="10777" href="/Substitution/#10777" class="Bound">M</a> <a id="10779" href="/Substitution/#10779" class="Bound">M′</a> <a id="10782" class="Symbol">:</a> <a id="10784" href="/Substitution/#10750" class="Bound">Γ</a> <a id="10786" href="/Untyped/#4150" class="Datatype Operator">⊢</a> <a id="10788" href="/Substitution/#10774" class="Bound">B</a><a id="10789" class="Symbol">}</a>
        <a id="10799" class="Symbol">→</a> <a id="10801" class="Symbol">(∀{</a><a id="10804" href="/Substitution/#10804" class="Bound">A</a><a id="10805" class="Symbol">}</a> <a id="10807" class="Symbol">→</a> <a id="10809" href="/Substitution/#10755" class="Bound">ρ</a> <a id="10811" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="10813" href="/Substitution/#10757" class="Bound">ρ′</a> <a id="10816" class="Symbol">{</a><a id="10817" href="/Substitution/#10804" class="Bound">A</a><a id="10818" class="Symbol">})</a>  <a id="10822" class="Symbol">→</a>  <a id="10825" href="/Substitution/#10777" class="Bound">M</a> <a id="10827" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="10829" href="/Substitution/#10779" class="Bound">M′</a>
          <a id="10842" class="Comment">------------------------------</a>
        <a id="10881" class="Symbol">→</a> <a id="10883" href="/Untyped/#6171" class="Function">rename</a> <a id="10890" href="/Substitution/#10755" class="Bound">ρ</a> <a id="10892" href="/Substitution/#10777" class="Bound">M</a> <a id="10894" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="10896" href="/Untyped/#6171" class="Function">rename</a> <a id="10903" href="/Substitution/#10757" class="Bound">ρ′</a> <a id="10906" href="/Substitution/#10777" class="Bound">M</a>
<a id="10908" href="/Substitution/#10734" class="Function">cong-rename</a> <a id="10920" class="Symbol">{</a><a id="10921" class="Argument">M</a> <a id="10923" class="Symbol">=</a> <a id="10925" href="/Untyped/#4186" class="InductiveConstructor Operator">`</a> <a id="10927" href="/Substitution/#10927" class="Bound">x</a><a id="10928" class="Symbol">}</a> <a id="10930" href="/Substitution/#10930" class="Bound">rr</a> <a id="10933" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a> <a id="10938" class="Symbol">=</a> <a id="10940" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#1170" class="Function">cong</a> <a id="10945" href="/Untyped/#4186" class="InductiveConstructor Operator">`_</a> <a id="10948" class="Symbol">(</a><a id="10949" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#1274" class="Function">cong-app</a> <a id="10958" href="/Substitution/#10930" class="Bound">rr</a> <a id="10961" href="/Substitution/#10927" class="Bound">x</a><a id="10962" class="Symbol">)</a>
<a id="10964" href="/Substitution/#10734" class="Function">cong-rename</a> <a id="10976" class="Symbol">{</a><a id="10977" class="Argument">ρ</a> <a id="10979" class="Symbol">=</a> <a id="10981" href="/Substitution/#10981" class="Bound">ρ</a><a id="10982" class="Symbol">}</a> <a id="10984" class="Symbol">{</a><a id="10985" class="Argument">ρ′</a> <a id="10988" class="Symbol">=</a> <a id="10990" href="/Substitution/#10990" class="Bound">ρ′</a><a id="10992" class="Symbol">}</a> <a id="10994" class="Symbol">{</a><a id="10995" class="Argument">M</a> <a id="10997" class="Symbol">=</a> <a id="10999" href="/Untyped/#4238" class="InductiveConstructor Operator">ƛ</a> <a id="11001" href="/Substitution/#11001" class="Bound">N</a><a id="11002" class="Symbol">}</a> <a id="11004" href="/Substitution/#11004" class="Bound">rr</a> <a id="11007" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a> <a id="11012" class="Symbol">=</a>
   <a id="11017" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#1170" class="Function">cong</a> <a id="11022" href="/Untyped/#4238" class="InductiveConstructor Operator">ƛ_</a> <a id="11025" class="Symbol">(</a><a id="11026" href="/Substitution/#10734" class="Function">cong-rename</a> <a id="11038" class="Symbol">{</a><a id="11039" class="Argument">ρ</a> <a id="11041" class="Symbol">=</a> <a id="11043" href="/Untyped/#5845" class="Function">ext</a> <a id="11047" href="/Substitution/#10981" class="Bound">ρ</a><a id="11048" class="Symbol">}{</a><a id="11050" class="Argument">ρ′</a> <a id="11053" class="Symbol">=</a> <a id="11055" href="/Untyped/#5845" class="Function">ext</a> <a id="11059" href="/Substitution/#10990" class="Bound">ρ′</a><a id="11061" class="Symbol">}{</a><a id="11063" class="Argument">M</a> <a id="11065" class="Symbol">=</a> <a id="11067" href="/Substitution/#11001" class="Bound">N</a><a id="11068" class="Symbol">}</a> <a id="11070" class="Symbol">(</a><a id="11071" href="/Substitution/#10386" class="Function">cong-ext</a> <a id="11080" href="/Substitution/#11004" class="Bound">rr</a><a id="11082" class="Symbol">)</a> <a id="11084" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a><a id="11088" class="Symbol">)</a>
<a id="11090" href="/Substitution/#10734" class="Function">cong-rename</a> <a id="11102" class="Symbol">{</a><a id="11103" class="Argument">M</a> <a id="11105" class="Symbol">=</a> <a id="11107" href="/Substitution/#11107" class="Bound">L</a> <a id="11109" href="/Untyped/#4298" class="InductiveConstructor Operator">·</a> <a id="11111" href="/Substitution/#11111" class="Bound">M</a><a id="11112" class="Symbol">}</a> <a id="11114" href="/Substitution/#11114" class="Bound">rr</a> <a id="11117" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a> <a id="11122" class="Symbol">=</a>
   <a id="11127" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#1408" class="Function">cong₂</a> <a id="11133" href="/Untyped/#4298" class="InductiveConstructor Operator">_·_</a> <a id="11137" class="Symbol">(</a><a id="11138" href="/Substitution/#10734" class="Function">cong-rename</a> <a id="11150" href="/Substitution/#11114" class="Bound">rr</a> <a id="11153" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a><a id="11157" class="Symbol">)</a> <a id="11159" class="Symbol">(</a><a id="11160" href="/Substitution/#10734" class="Function">cong-rename</a> <a id="11172" href="/Substitution/#11114" class="Bound">rr</a> <a id="11175" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a><a id="11179" class="Symbol">)</a></pre>

<pre class="Agda"><a id="cong-exts"></a><a id="11206" href="/Substitution/#11206" class="Function">cong-exts</a> <a id="11216" class="Symbol">:</a> <a id="11218" class="Symbol">∀{</a><a id="11220" href="/Substitution/#11220" class="Bound">Γ</a> <a id="11222" href="/Substitution/#11222" class="Bound">Δ</a><a id="11223" class="Symbol">}{</a><a id="11225" href="/Substitution/#11225" class="Bound">σ</a> <a id="11227" href="/Substitution/#11227" class="Bound">σ′</a> <a id="11230" class="Symbol">:</a> <a id="11232" href="/Substitution/#2506" class="Function">Subst</a> <a id="11238" href="/Substitution/#11220" class="Bound">Γ</a> <a id="11240" href="/Substitution/#11222" class="Bound">Δ</a><a id="11241" class="Symbol">}{</a><a id="11243" href="/Substitution/#11243" class="Bound">B</a><a id="11244" class="Symbol">}</a>
   <a id="11249" class="Symbol">→</a> <a id="11251" class="Symbol">(∀{</a><a id="11254" href="/Substitution/#11254" class="Bound">A</a><a id="11255" class="Symbol">}</a> <a id="11257" class="Symbol">→</a> <a id="11259" href="/Substitution/#11225" class="Bound">σ</a> <a id="11261" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="11263" href="/Substitution/#11227" class="Bound">σ′</a> <a id="11266" class="Symbol">{</a><a id="11267" href="/Substitution/#11254" class="Bound">A</a><a id="11268" class="Symbol">})</a>
     <a id="11276" class="Comment">-----------------------------------</a>
   <a id="11315" class="Symbol">→</a> <a id="11317" class="Symbol">∀{</a><a id="11319" href="/Substitution/#11319" class="Bound">A</a><a id="11320" class="Symbol">}</a> <a id="11322" class="Symbol">→</a> <a id="11324" href="/Untyped/#6623" class="Function">exts</a> <a id="11329" href="/Substitution/#11225" class="Bound">σ</a> <a id="11331" class="Symbol">{</a><a id="11332" class="Argument">B</a> <a id="11334" class="Symbol">=</a> <a id="11336" href="/Substitution/#11243" class="Bound">B</a><a id="11337" class="Symbol">}</a> <a id="11339" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="11341" href="/Untyped/#6623" class="Function">exts</a> <a id="11346" href="/Substitution/#11227" class="Bound">σ′</a> <a id="11349" class="Symbol">{</a><a id="11350" href="/Substitution/#11319" class="Bound">A</a><a id="11351" class="Symbol">}</a>
<a id="11353" href="/Substitution/#11206" class="Function">cong-exts</a><a id="11362" class="Symbol">{</a><a id="11363" href="/Substitution/#11363" class="Bound">Γ</a><a id="11364" class="Symbol">}{</a><a id="11366" href="/Substitution/#11366" class="Bound">Δ</a><a id="11367" class="Symbol">}{</a><a id="11369" href="/Substitution/#11369" class="Bound">σ</a><a id="11370" class="Symbol">}{</a><a id="11372" href="/Substitution/#11372" class="Bound">σ′</a><a id="11374" class="Symbol">}{</a><a id="11376" href="/Substitution/#11376" class="Bound">B</a><a id="11377" class="Symbol">}</a> <a id="11379" href="/Substitution/#11379" class="Bound">ss</a> <a id="11382" class="Symbol">{</a><a id="11383" href="/Substitution/#11383" class="Bound">A</a><a id="11384" class="Symbol">}</a> <a id="11386" class="Symbol">=</a> <a id="11388" href="/Substitution/#1996" class="Postulate">extensionality</a> <a id="11403" class="Symbol">λ</a> <a id="11405" href="/Substitution/#11405" class="Bound">x</a> <a id="11407" class="Symbol">→</a> <a id="11409" href="/Substitution/#11431" class="Function">lemma</a> <a id="11415" class="Symbol">{</a><a id="11416" href="/Substitution/#11405" class="Bound">x</a><a id="11417" class="Symbol">}</a>
   <a id="11422" class="Keyword">where</a>
   <a id="11431" href="/Substitution/#11431" class="Function">lemma</a> <a id="11437" class="Symbol">:</a> <a id="11439" class="Symbol">∀{</a><a id="11441" href="/Substitution/#11441" class="Bound">x</a><a id="11442" class="Symbol">}</a> <a id="11444" class="Symbol">→</a> <a id="11446" href="/Untyped/#6623" class="Function">exts</a> <a id="11451" href="/Substitution/#11369" class="Bound">σ</a> <a id="11453" href="/Substitution/#11441" class="Bound">x</a> <a id="11455" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="11457" href="/Untyped/#6623" class="Function">exts</a> <a id="11462" href="/Substitution/#11372" class="Bound">σ′</a> <a id="11465" href="/Substitution/#11441" class="Bound">x</a>
   <a id="11470" href="/Substitution/#11431" class="Function">lemma</a> <a id="11476" class="Symbol">{</a><a id="11477" href="/Untyped/#3401" class="InductiveConstructor">Z</a><a id="11478" class="Symbol">}</a> <a id="11480" class="Symbol">=</a> <a id="11482" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a>
   <a id="11490" href="/Substitution/#11431" class="Function">lemma</a> <a id="11496" class="Symbol">{</a><a id="11497" href="/Untyped/#3446" class="InductiveConstructor Operator">S</a> <a id="11499" href="/Substitution/#11499" class="Bound">x</a><a id="11500" class="Symbol">}</a> <a id="11502" class="Symbol">=</a> <a id="11504" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#1170" class="Function">cong</a> <a id="11509" class="Symbol">(</a><a id="11510" href="/Untyped/#6171" class="Function">rename</a> <a id="11517" href="/Untyped/#3446" class="InductiveConstructor Operator">S_</a><a id="11519" class="Symbol">)</a> <a id="11521" class="Symbol">(</a><a id="11522" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#1274" class="Function">cong-app</a> <a id="11531" class="Symbol">(</a><a id="11532" href="/Substitution/#11379" class="Bound">ss</a> <a id="11535" class="Symbol">{</a><a id="11536" href="/Substitution/#11383" class="Bound">A</a><a id="11537" class="Symbol">})</a> <a id="11540" href="/Substitution/#11499" class="Bound">x</a><a id="11541" class="Symbol">)</a></pre>

<pre class="Agda"><a id="cong-sub"></a><a id="11568" href="/Substitution/#11568" class="Function">cong-sub</a> <a id="11577" class="Symbol">:</a> <a id="11579" class="Symbol">∀{</a><a id="11581" href="/Substitution/#11581" class="Bound">Γ</a> <a id="11583" href="/Substitution/#11583" class="Bound">Δ</a><a id="11584" class="Symbol">}{</a><a id="11586" href="/Substitution/#11586" class="Bound">σ</a> <a id="11588" href="/Substitution/#11588" class="Bound">σ′</a> <a id="11591" class="Symbol">:</a> <a id="11593" href="/Substitution/#2506" class="Function">Subst</a> <a id="11599" href="/Substitution/#11581" class="Bound">Γ</a> <a id="11601" href="/Substitution/#11583" class="Bound">Δ</a><a id="11602" class="Symbol">}{</a><a id="11604" href="/Substitution/#11604" class="Bound">A</a><a id="11605" class="Symbol">}{</a><a id="11607" href="/Substitution/#11607" class="Bound">M</a> <a id="11609" href="/Substitution/#11609" class="Bound">M′</a> <a id="11612" class="Symbol">:</a> <a id="11614" href="/Substitution/#11581" class="Bound">Γ</a> <a id="11616" href="/Untyped/#4150" class="Datatype Operator">⊢</a> <a id="11618" href="/Substitution/#11604" class="Bound">A</a><a id="11619" class="Symbol">}</a>
            <a id="11633" class="Symbol">→</a> <a id="11635" class="Symbol">(∀{</a><a id="11638" href="/Substitution/#11638" class="Bound">A</a><a id="11639" class="Symbol">}</a> <a id="11641" class="Symbol">→</a> <a id="11643" href="/Substitution/#11586" class="Bound">σ</a> <a id="11645" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="11647" href="/Substitution/#11588" class="Bound">σ′</a> <a id="11650" class="Symbol">{</a><a id="11651" href="/Substitution/#11638" class="Bound">A</a><a id="11652" class="Symbol">})</a>  <a id="11656" class="Symbol">→</a>  <a id="11659" href="/Substitution/#11607" class="Bound">M</a> <a id="11661" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="11663" href="/Substitution/#11609" class="Bound">M′</a>
              <a id="11680" class="Comment">------------------------------</a>
            <a id="11723" class="Symbol">→</a> <a id="11725" href="/Untyped/#6931" class="Function">subst</a> <a id="11731" href="/Substitution/#11586" class="Bound">σ</a> <a id="11733" href="/Substitution/#11607" class="Bound">M</a> <a id="11735" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="11737" href="/Untyped/#6931" class="Function">subst</a> <a id="11743" href="/Substitution/#11588" class="Bound">σ′</a> <a id="11746" href="/Substitution/#11609" class="Bound">M′</a>
<a id="11749" href="/Substitution/#11568" class="Function">cong-sub</a> <a id="11758" class="Symbol">{</a><a id="11759" href="/Substitution/#11759" class="Bound">Γ</a><a id="11760" class="Symbol">}</a> <a id="11762" class="Symbol">{</a><a id="11763" href="/Substitution/#11763" class="Bound">Δ</a><a id="11764" class="Symbol">}</a> <a id="11766" class="Symbol">{</a><a id="11767" href="/Substitution/#11767" class="Bound">σ</a><a id="11768" class="Symbol">}</a> <a id="11770" class="Symbol">{</a><a id="11771" href="/Substitution/#11771" class="Bound">σ′</a><a id="11773" class="Symbol">}</a> <a id="11775" class="Symbol">{</a><a id="11776" href="/Substitution/#11776" class="Bound">A</a><a id="11777" class="Symbol">}</a> <a id="11779" class="Symbol">{</a><a id="11780" href="/Untyped/#4186" class="InductiveConstructor Operator">`</a> <a id="11782" href="/Substitution/#11782" class="Bound">x</a><a id="11783" class="Symbol">}</a> <a id="11785" href="/Substitution/#11785" class="Bound">ss</a> <a id="11788" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a> <a id="11793" class="Symbol">=</a> <a id="11795" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#1274" class="Function">cong-app</a> <a id="11804" href="/Substitution/#11785" class="Bound">ss</a> <a id="11807" href="/Substitution/#11782" class="Bound">x</a>
<a id="11809" href="/Substitution/#11568" class="Function">cong-sub</a> <a id="11818" class="Symbol">{</a><a id="11819" href="/Substitution/#11819" class="Bound">Γ</a><a id="11820" class="Symbol">}</a> <a id="11822" class="Symbol">{</a><a id="11823" href="/Substitution/#11823" class="Bound">Δ</a><a id="11824" class="Symbol">}</a> <a id="11826" class="Symbol">{</a><a id="11827" href="/Substitution/#11827" class="Bound">σ</a><a id="11828" class="Symbol">}</a> <a id="11830" class="Symbol">{</a><a id="11831" href="/Substitution/#11831" class="Bound">σ′</a><a id="11833" class="Symbol">}</a> <a id="11835" class="Symbol">{</a><a id="11836" href="/Substitution/#11836" class="Bound">A</a><a id="11837" class="Symbol">}</a> <a id="11839" class="Symbol">{</a><a id="11840" href="/Untyped/#4238" class="InductiveConstructor Operator">ƛ</a> <a id="11842" href="/Substitution/#11842" class="Bound">M</a><a id="11843" class="Symbol">}</a> <a id="11845" href="/Substitution/#11845" class="Bound">ss</a> <a id="11848" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a> <a id="11853" class="Symbol">=</a>
   <a id="11858" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#1170" class="Function">cong</a> <a id="11863" href="/Untyped/#4238" class="InductiveConstructor Operator">ƛ_</a> <a id="11866" class="Symbol">(</a><a id="11867" href="/Substitution/#11568" class="Function">cong-sub</a> <a id="11876" class="Symbol">{</a><a id="11877" class="Argument">σ</a> <a id="11879" class="Symbol">=</a> <a id="11881" href="/Untyped/#6623" class="Function">exts</a> <a id="11886" href="/Substitution/#11827" class="Bound">σ</a><a id="11887" class="Symbol">}{</a><a id="11889" class="Argument">σ′</a> <a id="11892" class="Symbol">=</a> <a id="11894" href="/Untyped/#6623" class="Function">exts</a> <a id="11899" href="/Substitution/#11831" class="Bound">σ′</a><a id="11901" class="Symbol">}</a> <a id="11903" class="Symbol">{</a><a id="11904" class="Argument">M</a> <a id="11906" class="Symbol">=</a> <a id="11908" href="/Substitution/#11842" class="Bound">M</a><a id="11909" class="Symbol">}</a> <a id="11911" class="Symbol">(</a><a id="11912" href="/Substitution/#11206" class="Function">cong-exts</a> <a id="11922" href="/Substitution/#11845" class="Bound">ss</a><a id="11924" class="Symbol">)</a> <a id="11926" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a><a id="11930" class="Symbol">)</a>
<a id="11932" href="/Substitution/#11568" class="Function">cong-sub</a> <a id="11941" class="Symbol">{</a><a id="11942" href="/Substitution/#11942" class="Bound">Γ</a><a id="11943" class="Symbol">}</a> <a id="11945" class="Symbol">{</a><a id="11946" href="/Substitution/#11946" class="Bound">Δ</a><a id="11947" class="Symbol">}</a> <a id="11949" class="Symbol">{</a><a id="11950" href="/Substitution/#11950" class="Bound">σ</a><a id="11951" class="Symbol">}</a> <a id="11953" class="Symbol">{</a><a id="11954" href="/Substitution/#11954" class="Bound">σ′</a><a id="11956" class="Symbol">}</a> <a id="11958" class="Symbol">{</a><a id="11959" href="/Substitution/#11959" class="Bound">A</a><a id="11960" class="Symbol">}</a> <a id="11962" class="Symbol">{</a><a id="11963" href="/Substitution/#11963" class="Bound">L</a> <a id="11965" href="/Untyped/#4298" class="InductiveConstructor Operator">·</a> <a id="11967" href="/Substitution/#11967" class="Bound">M</a><a id="11968" class="Symbol">}</a> <a id="11970" href="/Substitution/#11970" class="Bound">ss</a> <a id="11973" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a> <a id="11978" class="Symbol">=</a> 
   <a id="11984" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#1408" class="Function">cong₂</a> <a id="11990" href="/Untyped/#4298" class="InductiveConstructor Operator">_·_</a> <a id="11994" class="Symbol">(</a><a id="11995" href="/Substitution/#11568" class="Function">cong-sub</a> <a id="12004" class="Symbol">{</a><a id="12005" class="Argument">M</a> <a id="12007" class="Symbol">=</a> <a id="12009" href="/Substitution/#11963" class="Bound">L</a><a id="12010" class="Symbol">}</a> <a id="12012" href="/Substitution/#11970" class="Bound">ss</a> <a id="12015" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a><a id="12019" class="Symbol">)</a> <a id="12021" class="Symbol">(</a><a id="12022" href="/Substitution/#11568" class="Function">cong-sub</a> <a id="12031" class="Symbol">{</a><a id="12032" class="Argument">M</a> <a id="12034" class="Symbol">=</a> <a id="12036" href="/Substitution/#11967" class="Bound">M</a><a id="12037" class="Symbol">}</a> <a id="12039" href="/Substitution/#11970" class="Bound">ss</a> <a id="12042" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a><a id="12046" class="Symbol">)</a></pre>

<pre class="Agda"><a id="cong-sub-zero"></a><a id="12073" href="/Substitution/#12073" class="Function">cong-sub-zero</a> <a id="12087" class="Symbol">:</a> <a id="12089" class="Symbol">∀{</a><a id="12091" href="/Substitution/#12091" class="Bound">Γ</a><a id="12092" class="Symbol">}{</a><a id="12094" href="/Substitution/#12094" class="Bound">B</a> <a id="12096" class="Symbol">:</a> <a id="12098" href="/Untyped/#2675" class="Datatype">Type</a><a id="12102" class="Symbol">}{</a><a id="12104" href="/Substitution/#12104" class="Bound">M</a> <a id="12106" href="/Substitution/#12106" class="Bound">M′</a> <a id="12109" class="Symbol">:</a> <a id="12111" href="/Substitution/#12091" class="Bound">Γ</a> <a id="12113" href="/Untyped/#4150" class="Datatype Operator">⊢</a> <a id="12115" href="/Substitution/#12094" class="Bound">B</a><a id="12116" class="Symbol">}</a>
  <a id="12120" class="Symbol">→</a> <a id="12122" href="/Substitution/#12104" class="Bound">M</a> <a id="12124" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="12126" href="/Substitution/#12106" class="Bound">M′</a>
    <a id="12133" class="Comment">-----------------------------------------</a>
  <a id="12177" class="Symbol">→</a> <a id="12179" class="Symbol">∀{</a><a id="12181" href="/Substitution/#12181" class="Bound">A</a><a id="12182" class="Symbol">}</a> <a id="12184" class="Symbol">→</a> <a id="12186" href="/Untyped/#7359" class="Function">subst-zero</a> <a id="12197" href="/Substitution/#12104" class="Bound">M</a> <a id="12199" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="12201" class="Symbol">(</a><a id="12202" href="/Untyped/#7359" class="Function">subst-zero</a> <a id="12213" href="/Substitution/#12106" class="Bound">M′</a><a id="12215" class="Symbol">)</a> <a id="12217" class="Symbol">{</a><a id="12218" href="/Substitution/#12181" class="Bound">A</a><a id="12219" class="Symbol">}</a>
<a id="12221" href="/Substitution/#12073" class="Function">cong-sub-zero</a> <a id="12235" class="Symbol">{</a><a id="12236" href="/Substitution/#12236" class="Bound">Γ</a><a id="12237" class="Symbol">}{</a><a id="12239" href="/Substitution/#12239" class="Bound">B</a><a id="12240" class="Symbol">}{</a><a id="12242" href="/Substitution/#12242" class="Bound">M</a><a id="12243" class="Symbol">}{</a><a id="12245" href="/Substitution/#12245" class="Bound">M′</a><a id="12247" class="Symbol">}</a> <a id="12249" href="/Substitution/#12249" class="Bound">mm&#39;</a> <a id="12253" class="Symbol">{</a><a id="12254" href="/Substitution/#12254" class="Bound">A</a><a id="12255" class="Symbol">}</a> <a id="12257" class="Symbol">=</a>
   <a id="12262" href="/Substitution/#1996" class="Postulate">extensionality</a> <a id="12277" class="Symbol">λ</a> <a id="12279" href="/Substitution/#12279" class="Bound">x</a> <a id="12281" class="Symbol">→</a> <a id="12283" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#1170" class="Function">cong</a> <a id="12288" class="Symbol">(λ</a> <a id="12291" href="/Substitution/#12291" class="Bound">z</a> <a id="12293" class="Symbol">→</a> <a id="12295" href="/Untyped/#7359" class="Function">subst-zero</a> <a id="12306" href="/Substitution/#12291" class="Bound">z</a> <a id="12308" href="/Substitution/#12279" class="Bound">x</a><a id="12309" class="Symbol">)</a> <a id="12311" href="/Substitution/#12249" class="Bound">mm&#39;</a></pre>

<pre class="Agda"><a id="cong-cons"></a><a id="12340" href="/Substitution/#12340" class="Function">cong-cons</a> <a id="12350" class="Symbol">:</a> <a id="12352" class="Symbol">∀{</a><a id="12354" href="/Substitution/#12354" class="Bound">Γ</a> <a id="12356" href="/Substitution/#12356" class="Bound">Δ</a><a id="12357" class="Symbol">}{</a><a id="12359" href="/Substitution/#12359" class="Bound">A</a><a id="12360" class="Symbol">}{</a><a id="12362" href="/Substitution/#12362" class="Bound">M</a> <a id="12364" href="/Substitution/#12364" class="Bound">N</a> <a id="12366" class="Symbol">:</a> <a id="12368" href="/Substitution/#12356" class="Bound">Δ</a> <a id="12370" href="/Untyped/#4150" class="Datatype Operator">⊢</a> <a id="12372" href="/Substitution/#12359" class="Bound">A</a><a id="12373" class="Symbol">}{</a><a id="12375" href="/Substitution/#12375" class="Bound">σ</a> <a id="12377" href="/Substitution/#12377" class="Bound">τ</a> <a id="12379" class="Symbol">:</a> <a id="12381" href="/Substitution/#2506" class="Function">Subst</a> <a id="12387" href="/Substitution/#12354" class="Bound">Γ</a> <a id="12389" href="/Substitution/#12356" class="Bound">Δ</a><a id="12390" class="Symbol">}</a>
  <a id="12394" class="Symbol">→</a> <a id="12396" href="/Substitution/#12362" class="Bound">M</a> <a id="12398" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="12400" href="/Substitution/#12364" class="Bound">N</a>  <a id="12403" class="Symbol">→</a>  <a id="12406" class="Symbol">(∀{</a><a id="12409" href="/Substitution/#12409" class="Bound">A</a><a id="12410" class="Symbol">}</a> <a id="12412" class="Symbol">→</a> <a id="12414" href="/Substitution/#12375" class="Bound">σ</a> <a id="12416" class="Symbol">{</a><a id="12417" href="/Substitution/#12409" class="Bound">A</a><a id="12418" class="Symbol">}</a> <a id="12420" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="12422" href="/Substitution/#12377" class="Bound">τ</a> <a id="12424" class="Symbol">{</a><a id="12425" href="/Substitution/#12409" class="Bound">A</a><a id="12426" class="Symbol">})</a>
    <a id="12433" class="Comment">--------------------------------</a>
  <a id="12468" class="Symbol">→</a> <a id="12470" class="Symbol">∀{</a><a id="12472" href="/Substitution/#12472" class="Bound">A</a><a id="12473" class="Symbol">}</a> <a id="12475" class="Symbol">→</a> <a id="12477" class="Symbol">(</a><a id="12478" href="/Substitution/#12362" class="Bound">M</a> <a id="12480" href="/Substitution/#3592" class="Function Operator">•</a> <a id="12482" href="/Substitution/#12375" class="Bound">σ</a><a id="12483" class="Symbol">)</a> <a id="12485" class="Symbol">{</a><a id="12486" href="/Substitution/#12472" class="Bound">A</a><a id="12487" class="Symbol">}</a> <a id="12489" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="12491" class="Symbol">(</a><a id="12492" href="/Substitution/#12364" class="Bound">N</a> <a id="12494" href="/Substitution/#3592" class="Function Operator">•</a> <a id="12496" href="/Substitution/#12377" class="Bound">τ</a><a id="12497" class="Symbol">)</a> <a id="12499" class="Symbol">{</a><a id="12500" href="/Substitution/#12472" class="Bound">A</a><a id="12501" class="Symbol">}</a>
<a id="12503" href="/Substitution/#12340" class="Function">cong-cons</a><a id="12512" class="Symbol">{</a><a id="12513" href="/Substitution/#12513" class="Bound">Γ</a><a id="12514" class="Symbol">}{</a><a id="12516" href="/Substitution/#12516" class="Bound">Δ</a><a id="12517" class="Symbol">}{</a><a id="12519" href="/Substitution/#12519" class="Bound">A</a><a id="12520" class="Symbol">}{</a><a id="12522" href="/Substitution/#12522" class="Bound">M</a><a id="12523" class="Symbol">}{</a><a id="12525" href="/Substitution/#12525" class="Bound">N</a><a id="12526" class="Symbol">}{</a><a id="12528" href="/Substitution/#12528" class="Bound">σ</a><a id="12529" class="Symbol">}{</a><a id="12531" href="/Substitution/#12531" class="Bound">τ</a><a id="12532" class="Symbol">}</a> <a id="12534" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a> <a id="12539" href="/Substitution/#12539" class="Bound">st</a> <a id="12542" class="Symbol">{</a><a id="12543" href="/Substitution/#12543" class="Bound">A′</a><a id="12545" class="Symbol">}</a> <a id="12547" class="Symbol">=</a> <a id="12549" href="/Substitution/#1996" class="Postulate">extensionality</a> <a id="12564" href="/Substitution/#12580" class="Function">lemma</a>
  <a id="12572" class="Keyword">where</a>
  <a id="12580" href="/Substitution/#12580" class="Function">lemma</a> <a id="12586" class="Symbol">:</a> <a id="12588" class="Symbol">(</a><a id="12589" href="/Substitution/#12589" class="Bound">x</a> <a id="12591" class="Symbol">:</a> <a id="12593" href="/Substitution/#12513" class="Bound">Γ</a> <a id="12595" href="/Untyped/#3018" class="InductiveConstructor Operator">,</a> <a id="12597" href="/Substitution/#12519" class="Bound">A</a> <a id="12599" href="/Untyped/#3365" class="Datatype Operator">∋</a> <a id="12601" href="/Substitution/#12543" class="Bound">A′</a><a id="12603" class="Symbol">)</a> <a id="12605" class="Symbol">→</a> <a id="12607" class="Symbol">(</a><a id="12608" href="/Substitution/#12522" class="Bound">M</a> <a id="12610" href="/Substitution/#3592" class="Function Operator">•</a> <a id="12612" href="/Substitution/#12528" class="Bound">σ</a><a id="12613" class="Symbol">)</a> <a id="12615" href="/Substitution/#12589" class="Bound">x</a> <a id="12617" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="12619" class="Symbol">(</a><a id="12620" href="/Substitution/#12522" class="Bound">M</a> <a id="12622" href="/Substitution/#3592" class="Function Operator">•</a> <a id="12624" href="/Substitution/#12531" class="Bound">τ</a><a id="12625" class="Symbol">)</a> <a id="12627" href="/Substitution/#12589" class="Bound">x</a>
  <a id="12631" href="/Substitution/#12580" class="Function">lemma</a> <a id="12637" href="/Untyped/#3401" class="InductiveConstructor">Z</a> <a id="12639" class="Symbol">=</a> <a id="12641" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a>
  <a id="12648" href="/Substitution/#12580" class="Function">lemma</a> <a id="12654" class="Symbol">(</a><a id="12655" href="/Untyped/#3446" class="InductiveConstructor Operator">S</a> <a id="12657" href="/Substitution/#12657" class="Bound">x</a><a id="12658" class="Symbol">)</a> <a id="12660" class="Symbol">=</a> <a id="12662" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#1274" class="Function">cong-app</a> <a id="12671" href="/Substitution/#12539" class="Bound">st</a> <a id="12674" href="/Substitution/#12657" class="Bound">x</a></pre>

<pre class="Agda"><a id="cong-seq"></a><a id="12701" href="/Substitution/#12701" class="Function">cong-seq</a> <a id="12710" class="Symbol">:</a> <a id="12712" class="Symbol">∀{</a><a id="12714" href="/Substitution/#12714" class="Bound">Γ</a> <a id="12716" href="/Substitution/#12716" class="Bound">Δ</a> <a id="12718" href="/Substitution/#12718" class="Bound">Σ</a><a id="12719" class="Symbol">}{</a><a id="12721" href="/Substitution/#12721" class="Bound">σ</a> <a id="12723" href="/Substitution/#12723" class="Bound">σ′</a> <a id="12726" class="Symbol">:</a> <a id="12728" href="/Substitution/#2506" class="Function">Subst</a> <a id="12734" href="/Substitution/#12714" class="Bound">Γ</a> <a id="12736" href="/Substitution/#12716" class="Bound">Δ</a><a id="12737" class="Symbol">}{</a><a id="12739" href="/Substitution/#12739" class="Bound">τ</a> <a id="12741" href="/Substitution/#12741" class="Bound">τ′</a> <a id="12744" class="Symbol">:</a> <a id="12746" href="/Substitution/#2506" class="Function">Subst</a> <a id="12752" href="/Substitution/#12716" class="Bound">Δ</a> <a id="12754" href="/Substitution/#12718" class="Bound">Σ</a><a id="12755" class="Symbol">}</a>
  <a id="12759" class="Symbol">→</a> <a id="12761" class="Symbol">(∀{</a><a id="12764" href="/Substitution/#12764" class="Bound">A</a><a id="12765" class="Symbol">}</a> <a id="12767" class="Symbol">→</a> <a id="12769" href="/Substitution/#12721" class="Bound">σ</a> <a id="12771" class="Symbol">{</a><a id="12772" href="/Substitution/#12764" class="Bound">A</a><a id="12773" class="Symbol">}</a> <a id="12775" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="12777" href="/Substitution/#12723" class="Bound">σ′</a> <a id="12780" class="Symbol">{</a><a id="12781" href="/Substitution/#12764" class="Bound">A</a><a id="12782" class="Symbol">})</a> <a id="12785" class="Symbol">→</a> <a id="12787" class="Symbol">(∀{</a><a id="12790" href="/Substitution/#12790" class="Bound">A</a><a id="12791" class="Symbol">}</a> <a id="12793" class="Symbol">→</a> <a id="12795" href="/Substitution/#12739" class="Bound">τ</a> <a id="12797" class="Symbol">{</a><a id="12798" href="/Substitution/#12790" class="Bound">A</a><a id="12799" class="Symbol">}</a> <a id="12801" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="12803" href="/Substitution/#12741" class="Bound">τ′</a> <a id="12806" class="Symbol">{</a><a id="12807" href="/Substitution/#12790" class="Bound">A</a><a id="12808" class="Symbol">})</a>
  <a id="12813" class="Symbol">→</a> <a id="12815" class="Symbol">∀{</a><a id="12817" href="/Substitution/#12817" class="Bound">A</a><a id="12818" class="Symbol">}</a> <a id="12820" class="Symbol">→</a> <a id="12822" class="Symbol">(</a><a id="12823" href="/Substitution/#12721" class="Bound">σ</a> <a id="12825" href="/Substitution/#3945" class="Function Operator">⨟</a> <a id="12827" href="/Substitution/#12739" class="Bound">τ</a><a id="12828" class="Symbol">)</a> <a id="12830" class="Symbol">{</a><a id="12831" href="/Substitution/#12817" class="Bound">A</a><a id="12832" class="Symbol">}</a> <a id="12834" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="12836" class="Symbol">(</a><a id="12837" href="/Substitution/#12723" class="Bound">σ′</a> <a id="12840" href="/Substitution/#3945" class="Function Operator">⨟</a> <a id="12842" href="/Substitution/#12741" class="Bound">τ′</a><a id="12844" class="Symbol">)</a> <a id="12846" class="Symbol">{</a><a id="12847" href="/Substitution/#12817" class="Bound">A</a><a id="12848" class="Symbol">}</a>
<a id="12850" href="/Substitution/#12701" class="Function">cong-seq</a> <a id="12859" class="Symbol">{</a><a id="12860" href="/Substitution/#12860" class="Bound">Γ</a><a id="12861" class="Symbol">}{</a><a id="12863" href="/Substitution/#12863" class="Bound">Δ</a><a id="12864" class="Symbol">}{</a><a id="12866" href="/Substitution/#12866" class="Bound">Σ</a><a id="12867" class="Symbol">}{</a><a id="12869" href="/Substitution/#12869" class="Bound">σ</a><a id="12870" class="Symbol">}{</a><a id="12872" href="/Substitution/#12872" class="Bound">σ′</a><a id="12874" class="Symbol">}{</a><a id="12876" href="/Substitution/#12876" class="Bound">τ</a><a id="12877" class="Symbol">}{</a><a id="12879" href="/Substitution/#12879" class="Bound">τ′</a><a id="12881" class="Symbol">}</a> <a id="12883" href="/Substitution/#12883" class="Bound">ss&#39;</a> <a id="12887" href="/Substitution/#12887" class="Bound">tt&#39;</a> <a id="12891" class="Symbol">{</a><a id="12892" href="/Substitution/#12892" class="Bound">A</a><a id="12893" class="Symbol">}</a> <a id="12895" class="Symbol">=</a> <a id="12897" href="/Substitution/#1996" class="Postulate">extensionality</a> <a id="12912" href="/Substitution/#12928" class="Function">lemma</a>
  <a id="12920" class="Keyword">where</a>
  <a id="12928" href="/Substitution/#12928" class="Function">lemma</a> <a id="12934" class="Symbol">:</a> <a id="12936" class="Symbol">(</a><a id="12937" href="/Substitution/#12937" class="Bound">x</a> <a id="12939" class="Symbol">:</a> <a id="12941" href="/Substitution/#12860" class="Bound">Γ</a> <a id="12943" href="/Untyped/#3365" class="Datatype Operator">∋</a> <a id="12945" href="/Substitution/#12892" class="Bound">A</a><a id="12946" class="Symbol">)</a> <a id="12948" class="Symbol">→</a> <a id="12950" class="Symbol">(</a><a id="12951" href="/Substitution/#12869" class="Bound">σ</a> <a id="12953" href="/Substitution/#3945" class="Function Operator">⨟</a> <a id="12955" href="/Substitution/#12876" class="Bound">τ</a><a id="12956" class="Symbol">)</a> <a id="12958" href="/Substitution/#12937" class="Bound">x</a> <a id="12960" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="12962" class="Symbol">(</a><a id="12963" href="/Substitution/#12872" class="Bound">σ′</a> <a id="12966" href="/Substitution/#3945" class="Function Operator">⨟</a> <a id="12968" href="/Substitution/#12879" class="Bound">τ′</a><a id="12970" class="Symbol">)</a> <a id="12972" href="/Substitution/#12937" class="Bound">x</a>
  <a id="12976" href="/Substitution/#12928" class="Function">lemma</a> <a id="12982" href="/Substitution/#12982" class="Bound">x</a> <a id="12984" class="Symbol">=</a>
     <a id="12991" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4076" class="Function Operator">begin</a>
       <a id="13004" class="Symbol">(</a><a id="13005" href="/Substitution/#12869" class="Bound">σ</a> <a id="13007" href="/Substitution/#3945" class="Function Operator">⨟</a> <a id="13009" href="/Substitution/#12876" class="Bound">τ</a><a id="13010" class="Symbol">)</a> <a id="13012" href="/Substitution/#12982" class="Bound">x</a> 
     <a id="13020" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4134" class="Function Operator">≡⟨⟩</a>
       <a id="13031" href="/Untyped/#6931" class="Function">subst</a> <a id="13037" href="/Substitution/#12876" class="Bound">τ</a> <a id="13039" class="Symbol">(</a><a id="13040" href="/Substitution/#12869" class="Bound">σ</a> <a id="13042" href="/Substitution/#12982" class="Bound">x</a><a id="13043" class="Symbol">)</a>
     <a id="13050" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">≡⟨</a> <a id="13053" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#1170" class="Function">cong</a> <a id="13058" class="Symbol">(</a><a id="13059" href="/Untyped/#6931" class="Function">subst</a> <a id="13065" href="/Substitution/#12876" class="Bound">τ</a><a id="13066" class="Symbol">)</a> <a id="13068" class="Symbol">(</a><a id="13069" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#1274" class="Function">cong-app</a> <a id="13078" href="/Substitution/#12883" class="Bound">ss&#39;</a> <a id="13082" href="/Substitution/#12982" class="Bound">x</a><a id="13083" class="Symbol">)</a> <a id="13085" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">⟩</a>
       <a id="13094" href="/Untyped/#6931" class="Function">subst</a> <a id="13100" href="/Substitution/#12876" class="Bound">τ</a> <a id="13102" class="Symbol">(</a><a id="13103" href="/Substitution/#12872" class="Bound">σ′</a> <a id="13106" href="/Substitution/#12982" class="Bound">x</a><a id="13107" class="Symbol">)</a>
     <a id="13114" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">≡⟨</a> <a id="13117" href="/Substitution/#11568" class="Function">cong-sub</a><a id="13125" class="Symbol">{</a><a id="13126" class="Argument">M</a> <a id="13128" class="Symbol">=</a> <a id="13130" href="/Substitution/#12872" class="Bound">σ′</a> <a id="13133" href="/Substitution/#12982" class="Bound">x</a><a id="13134" class="Symbol">}</a> <a id="13136" href="/Substitution/#12887" class="Bound">tt&#39;</a> <a id="13140" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a> <a id="13145" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">⟩</a>
       <a id="13154" href="/Untyped/#6931" class="Function">subst</a> <a id="13160" href="/Substitution/#12879" class="Bound">τ′</a> <a id="13163" class="Symbol">(</a><a id="13164" href="/Substitution/#12872" class="Bound">σ′</a> <a id="13167" href="/Substitution/#12982" class="Bound">x</a><a id="13168" class="Symbol">)</a>
     <a id="13175" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4134" class="Function Operator">≡⟨⟩</a>
       <a id="13186" class="Symbol">(</a><a id="13187" href="/Substitution/#12872" class="Bound">σ′</a> <a id="13190" href="/Substitution/#3945" class="Function Operator">⨟</a> <a id="13192" href="/Substitution/#12879" class="Bound">τ′</a><a id="13194" class="Symbol">)</a> <a id="13196" href="/Substitution/#12982" class="Bound">x</a>  
     <a id="13205" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4374" class="Function Operator">∎</a></pre>

<h2 id="relating-rename-exts-ext-and-subst-zero-to-the-σ-algebra">Relating <code class="highlighter-rouge">rename</code>, <code class="highlighter-rouge">exts</code>, <code class="highlighter-rouge">ext</code>, and <code class="highlighter-rouge">subst-zero</code> to the σ algebra</h2>

<p>In this section we establish equations that relate <code class="highlighter-rouge">subst</code> and its
helper functions (<code class="highlighter-rouge">rename</code>, <code class="highlighter-rouge">exts</code>, <code class="highlighter-rouge">ext</code>, and <code class="highlighter-rouge">subst-zero</code>) to terms
in the σ algebra.</p>

<p>The first equation we prove is</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>rename ρ M ≡ ⟪ ren ρ ⟫ M              (rename-subst-ren)
</code></pre></div></div>

<p>Because <code class="highlighter-rouge">subst</code> uses the <code class="highlighter-rouge">exts</code> function, we need the following lemma
which says that <code class="highlighter-rouge">exts</code> and <code class="highlighter-rouge">ext</code> do the same thing except that <code class="highlighter-rouge">ext</code>
works on renamings and <code class="highlighter-rouge">exts</code> works on substitutions.</p>

<pre class="Agda"><a id="ren-ext"></a><a id="13764" href="/Substitution/#13764" class="Function">ren-ext</a> <a id="13772" class="Symbol">:</a> <a id="13774" class="Symbol">∀</a> <a id="13776" class="Symbol">{</a><a id="13777" href="/Substitution/#13777" class="Bound">Γ</a> <a id="13779" href="/Substitution/#13779" class="Bound">Δ</a><a id="13780" class="Symbol">}{</a><a id="13782" href="/Substitution/#13782" class="Bound">B</a> <a id="13784" href="/Substitution/#13784" class="Bound">C</a> <a id="13786" class="Symbol">:</a> <a id="13788" href="/Untyped/#2675" class="Datatype">Type</a><a id="13792" class="Symbol">}</a> <a id="13794" class="Symbol">{</a><a id="13795" href="/Substitution/#13795" class="Bound">ρ</a> <a id="13797" class="Symbol">:</a> <a id="13799" href="/Substitution/#2277" class="Function">Rename</a> <a id="13806" href="/Substitution/#13777" class="Bound">Γ</a> <a id="13808" href="/Substitution/#13779" class="Bound">Δ</a><a id="13809" class="Symbol">}</a>
        <a id="13819" class="Symbol">→</a> <a id="13821" href="/Substitution/#6703" class="Function">ren</a> <a id="13825" class="Symbol">(</a><a id="13826" href="/Untyped/#5845" class="Function">ext</a> <a id="13830" href="/Substitution/#13795" class="Bound">ρ</a> <a id="13832" class="Symbol">{</a><a id="13833" class="Argument">B</a> <a id="13835" class="Symbol">=</a> <a id="13837" href="/Substitution/#13782" class="Bound">B</a><a id="13838" class="Symbol">})</a> <a id="13841" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="13843" href="/Untyped/#6623" class="Function">exts</a> <a id="13848" class="Symbol">(</a><a id="13849" href="/Substitution/#6703" class="Function">ren</a> <a id="13853" href="/Substitution/#13795" class="Bound">ρ</a><a id="13854" class="Symbol">)</a> <a id="13856" class="Symbol">{</a><a id="13857" href="/Substitution/#13784" class="Bound">C</a><a id="13858" class="Symbol">}</a>
<a id="13860" href="/Substitution/#13764" class="Function">ren-ext</a> <a id="13868" class="Symbol">{</a><a id="13869" href="/Substitution/#13869" class="Bound">Γ</a><a id="13870" class="Symbol">}{</a><a id="13872" href="/Substitution/#13872" class="Bound">Δ</a><a id="13873" class="Symbol">}{</a><a id="13875" href="/Substitution/#13875" class="Bound">B</a><a id="13876" class="Symbol">}{</a><a id="13878" href="/Substitution/#13878" class="Bound">C</a><a id="13879" class="Symbol">}{</a><a id="13881" href="/Substitution/#13881" class="Bound">ρ</a><a id="13882" class="Symbol">}</a> <a id="13884" class="Symbol">=</a> <a id="13886" href="/Substitution/#1996" class="Postulate">extensionality</a> <a id="13901" class="Symbol">λ</a> <a id="13903" href="/Substitution/#13903" class="Bound">x</a> <a id="13905" class="Symbol">→</a> <a id="13907" href="/Substitution/#13931" class="Function">lemma</a> <a id="13913" class="Symbol">{</a><a id="13914" class="Argument">x</a> <a id="13916" class="Symbol">=</a> <a id="13918" href="/Substitution/#13903" class="Bound">x</a><a id="13919" class="Symbol">}</a>
  <a id="13923" class="Keyword">where</a>
  <a id="13931" href="/Substitution/#13931" class="Function">lemma</a> <a id="13937" class="Symbol">:</a> <a id="13939" class="Symbol">∀</a> <a id="13941" class="Symbol">{</a><a id="13942" href="/Substitution/#13942" class="Bound">x</a> <a id="13944" class="Symbol">:</a> <a id="13946" href="/Substitution/#13869" class="Bound">Γ</a> <a id="13948" href="/Untyped/#3018" class="InductiveConstructor Operator">,</a> <a id="13950" href="/Substitution/#13875" class="Bound">B</a> <a id="13952" href="/Untyped/#3365" class="Datatype Operator">∋</a> <a id="13954" href="/Substitution/#13878" class="Bound">C</a><a id="13955" class="Symbol">}</a> <a id="13957" class="Symbol">→</a> <a id="13959" class="Symbol">(</a><a id="13960" href="/Substitution/#6703" class="Function">ren</a> <a id="13964" class="Symbol">(</a><a id="13965" href="/Untyped/#5845" class="Function">ext</a> <a id="13969" href="/Substitution/#13881" class="Bound">ρ</a><a id="13970" class="Symbol">))</a> <a id="13973" href="/Substitution/#13942" class="Bound">x</a> <a id="13975" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="13977" href="/Untyped/#6623" class="Function">exts</a> <a id="13982" class="Symbol">(</a><a id="13983" href="/Substitution/#6703" class="Function">ren</a> <a id="13987" href="/Substitution/#13881" class="Bound">ρ</a><a id="13988" class="Symbol">)</a> <a id="13990" href="/Substitution/#13942" class="Bound">x</a>
  <a id="13994" href="/Substitution/#13931" class="Function">lemma</a> <a id="14000" class="Symbol">{</a><a id="14001" class="Argument">x</a> <a id="14003" class="Symbol">=</a> <a id="14005" href="/Untyped/#3401" class="InductiveConstructor">Z</a><a id="14006" class="Symbol">}</a> <a id="14008" class="Symbol">=</a> <a id="14010" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a>
  <a id="14017" href="/Substitution/#13931" class="Function">lemma</a> <a id="14023" class="Symbol">{</a><a id="14024" class="Argument">x</a> <a id="14026" class="Symbol">=</a> <a id="14028" href="/Untyped/#3446" class="InductiveConstructor Operator">S</a> <a id="14030" href="/Substitution/#14030" class="Bound">x</a><a id="14031" class="Symbol">}</a> <a id="14033" class="Symbol">=</a> <a id="14035" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a></pre>

<p>With this lemma in hand, the proof is a straightforward induction on
the term <code class="highlighter-rouge">M</code>.</p>

<pre class="Agda"><a id="rename-subst-ren"></a><a id="14149" href="/Substitution/#14149" class="Function">rename-subst-ren</a> <a id="14166" class="Symbol">:</a> <a id="14168" class="Symbol">∀</a> <a id="14170" class="Symbol">{</a><a id="14171" href="/Substitution/#14171" class="Bound">Γ</a> <a id="14173" href="/Substitution/#14173" class="Bound">Δ</a><a id="14174" class="Symbol">}{</a><a id="14176" href="/Substitution/#14176" class="Bound">A</a><a id="14177" class="Symbol">}</a> <a id="14179" class="Symbol">{</a><a id="14180" href="/Substitution/#14180" class="Bound">ρ</a> <a id="14182" class="Symbol">:</a> <a id="14184" href="/Substitution/#2277" class="Function">Rename</a> <a id="14191" href="/Substitution/#14171" class="Bound">Γ</a> <a id="14193" href="/Substitution/#14173" class="Bound">Δ</a><a id="14194" class="Symbol">}{</a><a id="14196" href="/Substitution/#14196" class="Bound">M</a> <a id="14198" class="Symbol">:</a> <a id="14200" href="/Substitution/#14171" class="Bound">Γ</a> <a id="14202" href="/Untyped/#4150" class="Datatype Operator">⊢</a> <a id="14204" href="/Substitution/#14176" class="Bound">A</a><a id="14205" class="Symbol">}</a>
                 <a id="14224" class="Symbol">→</a> <a id="14226" href="/Untyped/#6171" class="Function">rename</a> <a id="14233" href="/Substitution/#14180" class="Bound">ρ</a> <a id="14235" href="/Substitution/#14196" class="Bound">M</a> <a id="14237" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="14239" href="/Substitution/#2663" class="Function Operator">⟪</a> <a id="14241" href="/Substitution/#6703" class="Function">ren</a> <a id="14245" href="/Substitution/#14180" class="Bound">ρ</a> <a id="14247" href="/Substitution/#2663" class="Function Operator">⟫</a> <a id="14249" href="/Substitution/#14196" class="Bound">M</a>
<a id="14251" href="/Substitution/#14149" class="Function">rename-subst-ren</a> <a id="14268" class="Symbol">{</a><a id="14269" class="Argument">M</a> <a id="14271" class="Symbol">=</a> <a id="14273" href="/Untyped/#4186" class="InductiveConstructor Operator">`</a> <a id="14275" href="/Substitution/#14275" class="Bound">x</a><a id="14276" class="Symbol">}</a> <a id="14278" class="Symbol">=</a> <a id="14280" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a>
<a id="14285" href="/Substitution/#14149" class="Function">rename-subst-ren</a> <a id="14302" class="Symbol">{</a><a id="14303" class="Argument">ρ</a> <a id="14305" class="Symbol">=</a> <a id="14307" href="/Substitution/#14307" class="Bound">ρ</a><a id="14308" class="Symbol">}{</a><a id="14310" class="Argument">M</a> <a id="14312" class="Symbol">=</a> <a id="14314" href="/Untyped/#4238" class="InductiveConstructor Operator">ƛ</a> <a id="14316" href="/Substitution/#14316" class="Bound">N</a><a id="14317" class="Symbol">}</a> <a id="14319" class="Symbol">=</a>
  <a id="14323" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4076" class="Function Operator">begin</a>
      <a id="14335" href="/Untyped/#6171" class="Function">rename</a> <a id="14342" href="/Substitution/#14307" class="Bound">ρ</a> <a id="14344" class="Symbol">(</a><a id="14345" href="/Untyped/#4238" class="InductiveConstructor Operator">ƛ</a> <a id="14347" href="/Substitution/#14316" class="Bound">N</a><a id="14348" class="Symbol">)</a>
    <a id="14354" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4134" class="Function Operator">≡⟨⟩</a>
      <a id="14364" href="/Untyped/#4238" class="InductiveConstructor Operator">ƛ</a> <a id="14366" href="/Untyped/#6171" class="Function">rename</a> <a id="14373" class="Symbol">(</a><a id="14374" href="/Untyped/#5845" class="Function">ext</a> <a id="14378" href="/Substitution/#14307" class="Bound">ρ</a><a id="14379" class="Symbol">)</a> <a id="14381" href="/Substitution/#14316" class="Bound">N</a>
    <a id="14387" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">≡⟨</a> <a id="14390" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#1170" class="Function">cong</a> <a id="14395" href="/Untyped/#4238" class="InductiveConstructor Operator">ƛ_</a> <a id="14398" class="Symbol">(</a><a id="14399" href="/Substitution/#14149" class="Function">rename-subst-ren</a> <a id="14416" class="Symbol">{</a><a id="14417" class="Argument">ρ</a> <a id="14419" class="Symbol">=</a> <a id="14421" href="/Untyped/#5845" class="Function">ext</a> <a id="14425" href="/Substitution/#14307" class="Bound">ρ</a><a id="14426" class="Symbol">}{</a><a id="14428" class="Argument">M</a> <a id="14430" class="Symbol">=</a> <a id="14432" href="/Substitution/#14316" class="Bound">N</a><a id="14433" class="Symbol">})</a> <a id="14436" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">⟩</a>
      <a id="14444" href="/Untyped/#4238" class="InductiveConstructor Operator">ƛ</a> <a id="14446" href="/Substitution/#2663" class="Function Operator">⟪</a> <a id="14448" href="/Substitution/#6703" class="Function">ren</a> <a id="14452" class="Symbol">(</a><a id="14453" href="/Untyped/#5845" class="Function">ext</a> <a id="14457" href="/Substitution/#14307" class="Bound">ρ</a><a id="14458" class="Symbol">)</a> <a id="14460" href="/Substitution/#2663" class="Function Operator">⟫</a> <a id="14462" href="/Substitution/#14316" class="Bound">N</a>
    <a id="14468" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">≡⟨</a> <a id="14471" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#1170" class="Function">cong</a> <a id="14476" href="/Untyped/#4238" class="InductiveConstructor Operator">ƛ_</a> <a id="14479" class="Symbol">(</a><a id="14480" href="/Substitution/#11568" class="Function">cong-sub</a> <a id="14489" class="Symbol">{</a><a id="14490" class="Argument">M</a> <a id="14492" class="Symbol">=</a> <a id="14494" href="/Substitution/#14316" class="Bound">N</a><a id="14495" class="Symbol">}</a> <a id="14497" href="/Substitution/#13764" class="Function">ren-ext</a> <a id="14505" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a><a id="14509" class="Symbol">)</a> <a id="14511" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">⟩</a>
      <a id="14519" href="/Untyped/#4238" class="InductiveConstructor Operator">ƛ</a> <a id="14521" href="/Substitution/#2663" class="Function Operator">⟪</a> <a id="14523" href="/Untyped/#6623" class="Function">exts</a> <a id="14528" class="Symbol">(</a><a id="14529" href="/Substitution/#6703" class="Function">ren</a> <a id="14533" href="/Substitution/#14307" class="Bound">ρ</a><a id="14534" class="Symbol">)</a> <a id="14536" href="/Substitution/#2663" class="Function Operator">⟫</a>  <a id="14539" href="/Substitution/#14316" class="Bound">N</a>
    <a id="14545" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4134" class="Function Operator">≡⟨⟩</a>
      <a id="14555" href="/Substitution/#2663" class="Function Operator">⟪</a> <a id="14557" href="/Substitution/#6703" class="Function">ren</a> <a id="14561" href="/Substitution/#14307" class="Bound">ρ</a> <a id="14563" href="/Substitution/#2663" class="Function Operator">⟫</a> <a id="14565" class="Symbol">(</a><a id="14566" href="/Untyped/#4238" class="InductiveConstructor Operator">ƛ</a> <a id="14568" href="/Substitution/#14316" class="Bound">N</a><a id="14569" class="Symbol">)</a>
  <a id="14573" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4374" class="Function Operator">∎</a>
<a id="14575" href="/Substitution/#14149" class="Function">rename-subst-ren</a> <a id="14592" class="Symbol">{</a><a id="14593" class="Argument">M</a> <a id="14595" class="Symbol">=</a> <a id="14597" href="/Substitution/#14597" class="Bound">L</a> <a id="14599" href="/Untyped/#4298" class="InductiveConstructor Operator">·</a> <a id="14601" href="/Substitution/#14601" class="Bound">M</a><a id="14602" class="Symbol">}</a> <a id="14604" class="Symbol">=</a> <a id="14606" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#1408" class="Function">cong₂</a> <a id="14612" href="/Untyped/#4298" class="InductiveConstructor Operator">_·_</a> <a id="14616" href="/Substitution/#14149" class="Function">rename-subst-ren</a> <a id="14633" href="/Substitution/#14149" class="Function">rename-subst-ren</a></pre>

<p>The substitution <code class="highlighter-rouge">ren S_</code> is equivalent to <code class="highlighter-rouge">↑</code>.</p>

<pre class="Agda"><a id="ren-shift"></a><a id="14724" href="/Substitution/#14724" class="Function">ren-shift</a> <a id="14734" class="Symbol">:</a> <a id="14736" class="Symbol">∀{</a><a id="14738" href="/Substitution/#14738" class="Bound">Γ</a><a id="14739" class="Symbol">}{</a><a id="14741" href="/Substitution/#14741" class="Bound">A</a><a id="14742" class="Symbol">}{</a><a id="14744" href="/Substitution/#14744" class="Bound">B</a><a id="14745" class="Symbol">}</a>
          <a id="14757" class="Symbol">→</a> <a id="14759" href="/Substitution/#6703" class="Function">ren</a> <a id="14763" href="/Untyped/#3446" class="InductiveConstructor Operator">S_</a> <a id="14766" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="14768" href="/Substitution/#3334" class="Function">↑</a> <a id="14770" class="Symbol">{</a><a id="14771" class="Argument">A</a> <a id="14773" class="Symbol">=</a> <a id="14775" href="/Substitution/#14744" class="Bound">B</a><a id="14776" class="Symbol">}</a> <a id="14778" class="Symbol">{</a><a id="14779" href="/Substitution/#14741" class="Bound">A</a><a id="14780" class="Symbol">}</a>
<a id="14782" href="/Substitution/#14724" class="Function">ren-shift</a> <a id="14792" class="Symbol">{</a><a id="14793" href="/Substitution/#14793" class="Bound">Γ</a><a id="14794" class="Symbol">}{</a><a id="14796" href="/Substitution/#14796" class="Bound">A</a><a id="14797" class="Symbol">}{</a><a id="14799" href="/Substitution/#14799" class="Bound">B</a><a id="14800" class="Symbol">}</a> <a id="14802" class="Symbol">=</a> <a id="14804" href="/Substitution/#1996" class="Postulate">extensionality</a> <a id="14819" class="Symbol">λ</a> <a id="14821" href="/Substitution/#14821" class="Bound">x</a> <a id="14823" class="Symbol">→</a> <a id="14825" href="/Substitution/#14849" class="Function">lemma</a> <a id="14831" class="Symbol">{</a><a id="14832" class="Argument">x</a> <a id="14834" class="Symbol">=</a> <a id="14836" href="/Substitution/#14821" class="Bound">x</a><a id="14837" class="Symbol">}</a>
  <a id="14841" class="Keyword">where</a>
  <a id="14849" href="/Substitution/#14849" class="Function">lemma</a> <a id="14855" class="Symbol">:</a> <a id="14857" class="Symbol">∀</a> <a id="14859" class="Symbol">{</a><a id="14860" href="/Substitution/#14860" class="Bound">x</a> <a id="14862" class="Symbol">:</a> <a id="14864" href="/Substitution/#14793" class="Bound">Γ</a> <a id="14866" href="/Untyped/#3365" class="Datatype Operator">∋</a> <a id="14868" href="/Substitution/#14796" class="Bound">A</a><a id="14869" class="Symbol">}</a> <a id="14871" class="Symbol">→</a> <a id="14873" href="/Substitution/#6703" class="Function">ren</a> <a id="14877" class="Symbol">(</a><a id="14878" href="/Untyped/#3446" class="InductiveConstructor Operator">S_</a><a id="14880" class="Symbol">{</a><a id="14881" class="Argument">B</a> <a id="14883" class="Symbol">=</a> <a id="14885" href="/Substitution/#14799" class="Bound">B</a><a id="14886" class="Symbol">})</a> <a id="14889" href="/Substitution/#14860" class="Bound">x</a> <a id="14891" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="14893" href="/Substitution/#3334" class="Function">↑</a> <a id="14895" class="Symbol">{</a><a id="14896" class="Argument">A</a> <a id="14898" class="Symbol">=</a> <a id="14900" href="/Substitution/#14799" class="Bound">B</a><a id="14901" class="Symbol">}</a> <a id="14903" href="/Substitution/#14860" class="Bound">x</a>
  <a id="14907" href="/Substitution/#14849" class="Function">lemma</a> <a id="14913" class="Symbol">{</a><a id="14914" class="Argument">x</a> <a id="14916" class="Symbol">=</a> <a id="14918" href="/Untyped/#3401" class="InductiveConstructor">Z</a><a id="14919" class="Symbol">}</a> <a id="14921" class="Symbol">=</a> <a id="14923" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a>
  <a id="14930" href="/Substitution/#14849" class="Function">lemma</a> <a id="14936" class="Symbol">{</a><a id="14937" class="Argument">x</a> <a id="14939" class="Symbol">=</a> <a id="14941" href="/Untyped/#3446" class="InductiveConstructor Operator">S</a> <a id="14943" href="/Substitution/#14943" class="Bound">x</a><a id="14944" class="Symbol">}</a> <a id="14946" class="Symbol">=</a> <a id="14948" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a></pre>

<p>The substitution <code class="highlighter-rouge">rename S_ M</code> is equivalent to shifting: <code class="highlighter-rouge">⟪ ↑ ⟫ M</code>.</p>

<pre class="Agda"><a id="rename-shift"></a><a id="15048" href="/Substitution/#15048" class="Function">rename-shift</a> <a id="15061" class="Symbol">:</a> <a id="15063" class="Symbol">∀{</a><a id="15065" href="/Substitution/#15065" class="Bound">Γ</a><a id="15066" class="Symbol">}</a> <a id="15068" class="Symbol">{</a><a id="15069" href="/Substitution/#15069" class="Bound">A</a><a id="15070" class="Symbol">}</a> <a id="15072" class="Symbol">{</a><a id="15073" href="/Substitution/#15073" class="Bound">B</a><a id="15074" class="Symbol">}</a> <a id="15076" class="Symbol">{</a><a id="15077" href="/Substitution/#15077" class="Bound">M</a> <a id="15079" class="Symbol">:</a> <a id="15081" href="/Substitution/#15065" class="Bound">Γ</a> <a id="15083" href="/Untyped/#4150" class="Datatype Operator">⊢</a> <a id="15085" href="/Substitution/#15069" class="Bound">A</a><a id="15086" class="Symbol">}</a>
             <a id="15101" class="Symbol">→</a> <a id="15103" href="/Untyped/#6171" class="Function">rename</a> <a id="15110" class="Symbol">(</a><a id="15111" href="/Untyped/#3446" class="InductiveConstructor Operator">S_</a><a id="15113" class="Symbol">{</a><a id="15114" class="Argument">B</a> <a id="15116" class="Symbol">=</a> <a id="15118" href="/Substitution/#15073" class="Bound">B</a><a id="15119" class="Symbol">})</a> <a id="15122" href="/Substitution/#15077" class="Bound">M</a> <a id="15124" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="15126" href="/Substitution/#2663" class="Function Operator">⟪</a> <a id="15128" href="/Substitution/#3334" class="Function">↑</a> <a id="15130" href="/Substitution/#2663" class="Function Operator">⟫</a> <a id="15132" href="/Substitution/#15077" class="Bound">M</a>
<a id="15134" href="/Substitution/#15048" class="Function">rename-shift</a><a id="15146" class="Symbol">{</a><a id="15147" href="/Substitution/#15147" class="Bound">Γ</a><a id="15148" class="Symbol">}{</a><a id="15150" href="/Substitution/#15150" class="Bound">A</a><a id="15151" class="Symbol">}{</a><a id="15153" href="/Substitution/#15153" class="Bound">B</a><a id="15154" class="Symbol">}{</a><a id="15156" href="/Substitution/#15156" class="Bound">M</a><a id="15157" class="Symbol">}</a> <a id="15159" class="Symbol">=</a>
  <a id="15163" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4076" class="Function Operator">begin</a>
    <a id="15173" href="/Untyped/#6171" class="Function">rename</a> <a id="15180" href="/Untyped/#3446" class="InductiveConstructor Operator">S_</a> <a id="15183" href="/Substitution/#15156" class="Bound">M</a>
  <a id="15187" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">≡⟨</a> <a id="15190" href="/Substitution/#14149" class="Function">rename-subst-ren</a> <a id="15207" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">⟩</a>
    <a id="15213" href="/Substitution/#2663" class="Function Operator">⟪</a> <a id="15215" href="/Substitution/#6703" class="Function">ren</a> <a id="15219" href="/Untyped/#3446" class="InductiveConstructor Operator">S_</a> <a id="15222" href="/Substitution/#2663" class="Function Operator">⟫</a> <a id="15224" href="/Substitution/#15156" class="Bound">M</a>
  <a id="15228" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">≡⟨</a> <a id="15231" href="/Substitution/#11568" class="Function">cong-sub</a><a id="15239" class="Symbol">{</a><a id="15240" class="Argument">M</a> <a id="15242" class="Symbol">=</a> <a id="15244" href="/Substitution/#15156" class="Bound">M</a><a id="15245" class="Symbol">}</a> <a id="15247" href="/Substitution/#14724" class="Function">ren-shift</a> <a id="15257" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a> <a id="15262" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">⟩</a>
    <a id="15268" href="/Substitution/#2663" class="Function Operator">⟪</a> <a id="15270" href="/Substitution/#3334" class="Function">↑</a> <a id="15272" href="/Substitution/#2663" class="Function Operator">⟫</a> <a id="15274" href="/Substitution/#15156" class="Bound">M</a>
  <a id="15278" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4374" class="Function Operator">∎</a></pre>

<p>Next we prove the equation <code class="highlighter-rouge">exts-cons-shift</code>, which states that <code class="highlighter-rouge">exts</code>
is equivalent to cons’ing Z onto the sequence formed by applying <code class="highlighter-rouge">σ</code>
and then shifting. The proof is by case analysis on the variable <code class="highlighter-rouge">x</code>,
using <code class="highlighter-rouge">rename-subst-ren</code> for when <code class="highlighter-rouge">x = S y</code>.</p>

<pre class="Agda"><a id="exts-cons-shift"></a><a id="15561" href="/Substitution/#15561" class="Function">exts-cons-shift</a> <a id="15577" class="Symbol">:</a> <a id="15579" class="Symbol">∀{</a><a id="15581" href="/Substitution/#15581" class="Bound">Γ</a> <a id="15583" href="/Substitution/#15583" class="Bound">Δ</a><a id="15584" class="Symbol">}</a> <a id="15586" class="Symbol">{</a><a id="15587" href="/Substitution/#15587" class="Bound">A</a> <a id="15589" href="/Substitution/#15589" class="Bound">B</a><a id="15590" class="Symbol">}</a> <a id="15592" class="Symbol">{</a><a id="15593" href="/Substitution/#15593" class="Bound">σ</a> <a id="15595" class="Symbol">:</a> <a id="15597" href="/Substitution/#2506" class="Function">Subst</a> <a id="15603" href="/Substitution/#15581" class="Bound">Γ</a> <a id="15605" href="/Substitution/#15583" class="Bound">Δ</a><a id="15606" class="Symbol">}</a>
                <a id="15624" class="Symbol">→</a> <a id="15626" href="/Untyped/#6623" class="Function">exts</a> <a id="15631" href="/Substitution/#15593" class="Bound">σ</a> <a id="15633" class="Symbol">{</a><a id="15634" href="/Substitution/#15587" class="Bound">A</a><a id="15635" class="Symbol">}</a> <a id="15637" class="Symbol">{</a><a id="15638" href="/Substitution/#15589" class="Bound">B</a><a id="15639" class="Symbol">}</a> <a id="15641" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="15643" class="Symbol">(</a><a id="15644" href="/Untyped/#4186" class="InductiveConstructor Operator">`</a> <a id="15646" href="/Untyped/#3401" class="InductiveConstructor">Z</a> <a id="15648" href="/Substitution/#3592" class="Function Operator">•</a> <a id="15650" class="Symbol">(</a><a id="15651" href="/Substitution/#15593" class="Bound">σ</a> <a id="15653" href="/Substitution/#3945" class="Function Operator">⨟</a> <a id="15655" href="/Substitution/#3334" class="Function">↑</a><a id="15656" class="Symbol">))</a>
<a id="15659" href="/Substitution/#15561" class="Function">exts-cons-shift</a> <a id="15675" class="Symbol">=</a> <a id="15677" href="/Substitution/#1996" class="Postulate">extensionality</a> <a id="15692" class="Symbol">λ</a> <a id="15694" href="/Substitution/#15694" class="Bound">x</a> <a id="15696" class="Symbol">→</a> <a id="15698" href="/Substitution/#15721" class="Function">lemma</a><a id="15703" class="Symbol">{</a><a id="15704" class="Argument">x</a> <a id="15706" class="Symbol">=</a> <a id="15708" href="/Substitution/#15694" class="Bound">x</a><a id="15709" class="Symbol">}</a>
  <a id="15713" class="Keyword">where</a>
  <a id="15721" href="/Substitution/#15721" class="Function">lemma</a> <a id="15727" class="Symbol">:</a> <a id="15729" class="Symbol">∀{</a><a id="15731" href="/Substitution/#15731" class="Bound">Γ</a> <a id="15733" href="/Substitution/#15733" class="Bound">Δ</a><a id="15734" class="Symbol">}</a> <a id="15736" class="Symbol">{</a><a id="15737" href="/Substitution/#15737" class="Bound">A</a> <a id="15739" href="/Substitution/#15739" class="Bound">B</a><a id="15740" class="Symbol">}</a> <a id="15742" class="Symbol">{</a><a id="15743" href="/Substitution/#15743" class="Bound">σ</a> <a id="15745" class="Symbol">:</a> <a id="15747" href="/Substitution/#2506" class="Function">Subst</a> <a id="15753" href="/Substitution/#15731" class="Bound">Γ</a> <a id="15755" href="/Substitution/#15733" class="Bound">Δ</a><a id="15756" class="Symbol">}</a> <a id="15758" class="Symbol">{</a><a id="15759" href="/Substitution/#15759" class="Bound">x</a> <a id="15761" class="Symbol">:</a> <a id="15763" href="/Substitution/#15731" class="Bound">Γ</a> <a id="15765" href="/Untyped/#3018" class="InductiveConstructor Operator">,</a> <a id="15767" href="/Substitution/#15739" class="Bound">B</a> <a id="15769" href="/Untyped/#3365" class="Datatype Operator">∋</a> <a id="15771" href="/Substitution/#15737" class="Bound">A</a><a id="15772" class="Symbol">}</a>
                  <a id="15792" class="Symbol">→</a> <a id="15794" href="/Untyped/#6623" class="Function">exts</a> <a id="15799" href="/Substitution/#15743" class="Bound">σ</a> <a id="15801" href="/Substitution/#15759" class="Bound">x</a> <a id="15803" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="15805" class="Symbol">(</a><a id="15806" href="/Untyped/#4186" class="InductiveConstructor Operator">`</a> <a id="15808" href="/Untyped/#3401" class="InductiveConstructor">Z</a> <a id="15810" href="/Substitution/#3592" class="Function Operator">•</a> <a id="15812" class="Symbol">(</a><a id="15813" href="/Substitution/#15743" class="Bound">σ</a> <a id="15815" href="/Substitution/#3945" class="Function Operator">⨟</a> <a id="15817" href="/Substitution/#3334" class="Function">↑</a><a id="15818" class="Symbol">))</a> <a id="15821" href="/Substitution/#15759" class="Bound">x</a>
  <a id="15825" href="/Substitution/#15721" class="Function">lemma</a> <a id="15831" class="Symbol">{</a><a id="15832" class="Argument">x</a> <a id="15834" class="Symbol">=</a> <a id="15836" href="/Untyped/#3401" class="InductiveConstructor">Z</a><a id="15837" class="Symbol">}</a> <a id="15839" class="Symbol">=</a> <a id="15841" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a>
  <a id="15848" href="/Substitution/#15721" class="Function">lemma</a> <a id="15854" class="Symbol">{</a><a id="15855" class="Argument">x</a> <a id="15857" class="Symbol">=</a> <a id="15859" href="/Untyped/#3446" class="InductiveConstructor Operator">S</a> <a id="15861" href="/Substitution/#15861" class="Bound">y</a><a id="15862" class="Symbol">}</a> <a id="15864" class="Symbol">=</a> <a id="15866" href="/Substitution/#14149" class="Function">rename-subst-ren</a></pre>

<p>As a corollary, we have a similar correspondence for <code class="highlighter-rouge">ren (ext ρ)</code>.</p>

<pre class="Agda"><a id="ext-cons-Z-shift"></a><a id="15977" href="/Substitution/#15977" class="Function">ext-cons-Z-shift</a> <a id="15994" class="Symbol">:</a> <a id="15996" class="Symbol">∀{</a><a id="15998" href="/Substitution/#15998" class="Bound">Γ</a> <a id="16000" href="/Substitution/#16000" class="Bound">Δ</a><a id="16001" class="Symbol">}</a> <a id="16003" class="Symbol">{</a><a id="16004" href="/Substitution/#16004" class="Bound">ρ</a> <a id="16006" class="Symbol">:</a> <a id="16008" href="/Substitution/#2277" class="Function">Rename</a> <a id="16015" href="/Substitution/#15998" class="Bound">Γ</a> <a id="16017" href="/Substitution/#16000" class="Bound">Δ</a><a id="16018" class="Symbol">}{</a><a id="16020" href="/Substitution/#16020" class="Bound">A</a><a id="16021" class="Symbol">}{</a><a id="16023" href="/Substitution/#16023" class="Bound">B</a><a id="16024" class="Symbol">}</a> 
                 <a id="16044" class="Symbol">→</a> <a id="16046" href="/Substitution/#6703" class="Function">ren</a> <a id="16050" class="Symbol">(</a><a id="16051" href="/Untyped/#5845" class="Function">ext</a> <a id="16055" href="/Substitution/#16004" class="Bound">ρ</a> <a id="16057" class="Symbol">{</a><a id="16058" class="Argument">B</a> <a id="16060" class="Symbol">=</a> <a id="16062" href="/Substitution/#16023" class="Bound">B</a><a id="16063" class="Symbol">})</a> <a id="16066" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="16068" class="Symbol">(</a><a id="16069" href="/Untyped/#4186" class="InductiveConstructor Operator">`</a> <a id="16071" href="/Untyped/#3401" class="InductiveConstructor">Z</a> <a id="16073" href="/Substitution/#3592" class="Function Operator">•</a> <a id="16075" class="Symbol">(</a><a id="16076" href="/Substitution/#6703" class="Function">ren</a> <a id="16080" href="/Substitution/#16004" class="Bound">ρ</a> <a id="16082" href="/Substitution/#3945" class="Function Operator">⨟</a> <a id="16084" href="/Substitution/#3334" class="Function">↑</a><a id="16085" class="Symbol">))</a> <a id="16088" class="Symbol">{</a><a id="16089" href="/Substitution/#16020" class="Bound">A</a><a id="16090" class="Symbol">}</a>
<a id="16092" href="/Substitution/#15977" class="Function">ext-cons-Z-shift</a> <a id="16109" class="Symbol">{</a><a id="16110" href="/Substitution/#16110" class="Bound">Γ</a><a id="16111" class="Symbol">}{</a><a id="16113" href="/Substitution/#16113" class="Bound">Δ</a><a id="16114" class="Symbol">}{</a><a id="16116" href="/Substitution/#16116" class="Bound">ρ</a><a id="16117" class="Symbol">}{</a><a id="16119" href="/Substitution/#16119" class="Bound">A</a><a id="16120" class="Symbol">}{</a><a id="16122" href="/Substitution/#16122" class="Bound">B</a><a id="16123" class="Symbol">}</a> <a id="16125" class="Symbol">=</a>
  <a id="16129" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4076" class="Function Operator">begin</a>
    <a id="16139" href="/Substitution/#6703" class="Function">ren</a> <a id="16143" class="Symbol">(</a><a id="16144" href="/Untyped/#5845" class="Function">ext</a> <a id="16148" href="/Substitution/#16116" class="Bound">ρ</a><a id="16149" class="Symbol">)</a>
  <a id="16153" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">≡⟨</a> <a id="16156" href="/Substitution/#13764" class="Function">ren-ext</a> <a id="16164" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">⟩</a>
    <a id="16170" href="/Untyped/#6623" class="Function">exts</a> <a id="16175" class="Symbol">(</a><a id="16176" href="/Substitution/#6703" class="Function">ren</a> <a id="16180" href="/Substitution/#16116" class="Bound">ρ</a><a id="16181" class="Symbol">)</a>
  <a id="16185" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">≡⟨</a> <a id="16188" href="/Substitution/#15561" class="Function">exts-cons-shift</a><a id="16203" class="Symbol">{</a><a id="16204" class="Argument">σ</a> <a id="16206" class="Symbol">=</a> <a id="16208" href="/Substitution/#6703" class="Function">ren</a> <a id="16212" href="/Substitution/#16116" class="Bound">ρ</a><a id="16213" class="Symbol">}</a> <a id="16215" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">⟩</a>
   <a id="16220" class="Symbol">((</a><a id="16222" href="/Untyped/#4186" class="InductiveConstructor Operator">`</a> <a id="16224" href="/Untyped/#3401" class="InductiveConstructor">Z</a><a id="16225" class="Symbol">)</a> <a id="16227" href="/Substitution/#3592" class="Function Operator">•</a> <a id="16229" class="Symbol">(</a><a id="16230" href="/Substitution/#6703" class="Function">ren</a> <a id="16234" href="/Substitution/#16116" class="Bound">ρ</a> <a id="16236" href="/Substitution/#3945" class="Function Operator">⨟</a> <a id="16238" href="/Substitution/#3334" class="Function">↑</a><a id="16239" class="Symbol">))</a>
  <a id="16244" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4374" class="Function Operator">∎</a></pre>

<p>Finally, the <code class="highlighter-rouge">subst-zero M</code> substitution is equivalent to cons’ing <code class="highlighter-rouge">M</code>
onto the identity substitution.</p>

<pre class="Agda"><a id="subst-Z-cons-ids"></a><a id="16375" href="/Substitution/#16375" class="Function">subst-Z-cons-ids</a> <a id="16392" class="Symbol">:</a> <a id="16394" class="Symbol">∀{</a><a id="16396" href="/Substitution/#16396" class="Bound">Γ</a><a id="16397" class="Symbol">}{</a><a id="16399" href="/Substitution/#16399" class="Bound">A</a> <a id="16401" href="/Substitution/#16401" class="Bound">B</a> <a id="16403" class="Symbol">:</a> <a id="16405" href="/Untyped/#2675" class="Datatype">Type</a><a id="16409" class="Symbol">}{</a><a id="16411" href="/Substitution/#16411" class="Bound">M</a> <a id="16413" class="Symbol">:</a> <a id="16415" href="/Substitution/#16396" class="Bound">Γ</a> <a id="16417" href="/Untyped/#4150" class="Datatype Operator">⊢</a> <a id="16419" href="/Substitution/#16401" class="Bound">B</a><a id="16420" class="Symbol">}</a>
                 <a id="16439" class="Symbol">→</a> <a id="16441" href="/Untyped/#7359" class="Function">subst-zero</a> <a id="16452" href="/Substitution/#16411" class="Bound">M</a> <a id="16454" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="16456" class="Symbol">(</a><a id="16457" href="/Substitution/#16411" class="Bound">M</a> <a id="16459" href="/Substitution/#3592" class="Function Operator">•</a> <a id="16461" href="/Substitution/#3179" class="Function">ids</a><a id="16464" class="Symbol">)</a> <a id="16466" class="Symbol">{</a><a id="16467" href="/Substitution/#16399" class="Bound">A</a><a id="16468" class="Symbol">}</a>
<a id="16470" href="/Substitution/#16375" class="Function">subst-Z-cons-ids</a> <a id="16487" class="Symbol">=</a> <a id="16489" href="/Substitution/#1996" class="Postulate">extensionality</a> <a id="16504" class="Symbol">λ</a> <a id="16506" href="/Substitution/#16506" class="Bound">x</a> <a id="16508" class="Symbol">→</a> <a id="16510" href="/Substitution/#16534" class="Function">lemma</a> <a id="16516" class="Symbol">{</a><a id="16517" class="Argument">x</a> <a id="16519" class="Symbol">=</a> <a id="16521" href="/Substitution/#16506" class="Bound">x</a><a id="16522" class="Symbol">}</a>
  <a id="16526" class="Keyword">where</a>
  <a id="16534" href="/Substitution/#16534" class="Function">lemma</a> <a id="16540" class="Symbol">:</a> <a id="16542" class="Symbol">∀{</a><a id="16544" href="/Substitution/#16544" class="Bound">Γ</a><a id="16545" class="Symbol">}{</a><a id="16547" href="/Substitution/#16547" class="Bound">A</a> <a id="16549" href="/Substitution/#16549" class="Bound">B</a> <a id="16551" class="Symbol">:</a> <a id="16553" href="/Untyped/#2675" class="Datatype">Type</a><a id="16557" class="Symbol">}{</a><a id="16559" href="/Substitution/#16559" class="Bound">M</a> <a id="16561" class="Symbol">:</a> <a id="16563" href="/Substitution/#16544" class="Bound">Γ</a> <a id="16565" href="/Untyped/#4150" class="Datatype Operator">⊢</a> <a id="16567" href="/Substitution/#16549" class="Bound">B</a><a id="16568" class="Symbol">}{</a><a id="16570" href="/Substitution/#16570" class="Bound">x</a> <a id="16572" class="Symbol">:</a> <a id="16574" href="/Substitution/#16544" class="Bound">Γ</a> <a id="16576" href="/Untyped/#3018" class="InductiveConstructor Operator">,</a> <a id="16578" href="/Substitution/#16549" class="Bound">B</a> <a id="16580" href="/Untyped/#3365" class="Datatype Operator">∋</a> <a id="16582" href="/Substitution/#16547" class="Bound">A</a><a id="16583" class="Symbol">}</a>
                      <a id="16607" class="Symbol">→</a> <a id="16609" href="/Untyped/#7359" class="Function">subst-zero</a> <a id="16620" href="/Substitution/#16559" class="Bound">M</a> <a id="16622" href="/Substitution/#16570" class="Bound">x</a> <a id="16624" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="16626" class="Symbol">(</a><a id="16627" href="/Substitution/#16559" class="Bound">M</a> <a id="16629" href="/Substitution/#3592" class="Function Operator">•</a> <a id="16631" href="/Substitution/#3179" class="Function">ids</a><a id="16634" class="Symbol">)</a> <a id="16636" href="/Substitution/#16570" class="Bound">x</a>
  <a id="16640" href="/Substitution/#16534" class="Function">lemma</a> <a id="16646" class="Symbol">{</a><a id="16647" class="Argument">x</a> <a id="16649" class="Symbol">=</a> <a id="16651" href="/Untyped/#3401" class="InductiveConstructor">Z</a><a id="16652" class="Symbol">}</a> <a id="16654" class="Symbol">=</a> <a id="16656" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a>
  <a id="16663" href="/Substitution/#16534" class="Function">lemma</a> <a id="16669" class="Symbol">{</a><a id="16670" class="Argument">x</a> <a id="16672" class="Symbol">=</a> <a id="16674" href="/Untyped/#3446" class="InductiveConstructor Operator">S</a> <a id="16676" href="/Substitution/#16676" class="Bound">x</a><a id="16677" class="Symbol">}</a> <a id="16679" class="Symbol">=</a> <a id="16681" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a></pre>

<h2 id="proofs-of-sub-abs-sub-id-and-rename-id">Proofs of sub-abs, sub-id, and rename-id</h2>

<p>The equation <code class="highlighter-rouge">sub-abs</code> follows immediately from the equation
<code class="highlighter-rouge">exts-cons-shift</code>.</p>

<pre class="Agda"><a id="sub-abs"></a><a id="16838" href="/Substitution/#16838" class="Function">sub-abs</a> <a id="16846" class="Symbol">:</a> <a id="16848" class="Symbol">∀{</a><a id="16850" href="/Substitution/#16850" class="Bound">Γ</a> <a id="16852" href="/Substitution/#16852" class="Bound">Δ</a><a id="16853" class="Symbol">}</a> <a id="16855" class="Symbol">{</a><a id="16856" href="/Substitution/#16856" class="Bound">σ</a> <a id="16858" class="Symbol">:</a> <a id="16860" href="/Substitution/#2506" class="Function">Subst</a> <a id="16866" href="/Substitution/#16850" class="Bound">Γ</a> <a id="16868" href="/Substitution/#16852" class="Bound">Δ</a><a id="16869" class="Symbol">}</a> <a id="16871" class="Symbol">{</a><a id="16872" href="/Substitution/#16872" class="Bound">N</a> <a id="16874" class="Symbol">:</a> <a id="16876" href="/Substitution/#16850" class="Bound">Γ</a> <a id="16878" href="/Untyped/#3018" class="InductiveConstructor Operator">,</a> <a id="16880" href="/Untyped/#2694" class="InductiveConstructor">★</a> <a id="16882" href="/Untyped/#4150" class="Datatype Operator">⊢</a> <a id="16884" href="/Untyped/#2694" class="InductiveConstructor">★</a><a id="16885" class="Symbol">}</a>
        <a id="16895" class="Symbol">→</a> <a id="16897" href="/Substitution/#2663" class="Function Operator">⟪</a> <a id="16899" href="/Substitution/#16856" class="Bound">σ</a> <a id="16901" href="/Substitution/#2663" class="Function Operator">⟫</a> <a id="16903" class="Symbol">(</a><a id="16904" href="/Untyped/#4238" class="InductiveConstructor Operator">ƛ</a> <a id="16906" href="/Substitution/#16872" class="Bound">N</a><a id="16907" class="Symbol">)</a> <a id="16909" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="16911" href="/Untyped/#4238" class="InductiveConstructor Operator">ƛ</a> <a id="16913" href="/Substitution/#2663" class="Function Operator">⟪</a> <a id="16915" class="Symbol">(</a><a id="16916" href="/Untyped/#4186" class="InductiveConstructor Operator">`</a> <a id="16918" href="/Untyped/#3401" class="InductiveConstructor">Z</a><a id="16919" class="Symbol">)</a> <a id="16921" href="/Substitution/#3592" class="Function Operator">•</a> <a id="16923" class="Symbol">(</a><a id="16924" href="/Substitution/#16856" class="Bound">σ</a> <a id="16926" href="/Substitution/#3945" class="Function Operator">⨟</a> <a id="16928" href="/Substitution/#3334" class="Function">↑</a><a id="16929" class="Symbol">)</a> <a id="16931" href="/Substitution/#2663" class="Function Operator">⟫</a> <a id="16933" href="/Substitution/#16872" class="Bound">N</a>
<a id="16935" href="/Substitution/#16838" class="Function">sub-abs</a> <a id="16943" class="Symbol">{</a><a id="16944" class="Argument">σ</a> <a id="16946" class="Symbol">=</a> <a id="16948" href="/Substitution/#16948" class="Bound">σ</a><a id="16949" class="Symbol">}{</a><a id="16951" class="Argument">N</a> <a id="16953" class="Symbol">=</a> <a id="16955" href="/Substitution/#16955" class="Bound">N</a><a id="16956" class="Symbol">}</a> <a id="16958" class="Symbol">=</a>
   <a id="16963" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4076" class="Function Operator">begin</a>
     <a id="16974" href="/Substitution/#2663" class="Function Operator">⟪</a> <a id="16976" href="/Substitution/#16948" class="Bound">σ</a> <a id="16978" href="/Substitution/#2663" class="Function Operator">⟫</a> <a id="16980" class="Symbol">(</a><a id="16981" href="/Untyped/#4238" class="InductiveConstructor Operator">ƛ</a> <a id="16983" href="/Substitution/#16955" class="Bound">N</a><a id="16984" class="Symbol">)</a>
   <a id="16989" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4134" class="Function Operator">≡⟨⟩</a>
     <a id="16998" href="/Untyped/#4238" class="InductiveConstructor Operator">ƛ</a> <a id="17000" href="/Substitution/#2663" class="Function Operator">⟪</a> <a id="17002" href="/Untyped/#6623" class="Function">exts</a> <a id="17007" href="/Substitution/#16948" class="Bound">σ</a> <a id="17009" href="/Substitution/#2663" class="Function Operator">⟫</a> <a id="17011" href="/Substitution/#16955" class="Bound">N</a>
   <a id="17016" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">≡⟨</a> <a id="17019" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#1170" class="Function">cong</a> <a id="17024" href="/Untyped/#4238" class="InductiveConstructor Operator">ƛ_</a> <a id="17027" class="Symbol">(</a><a id="17028" href="/Substitution/#11568" class="Function">cong-sub</a><a id="17036" class="Symbol">{</a><a id="17037" class="Argument">M</a> <a id="17039" class="Symbol">=</a> <a id="17041" href="/Substitution/#16955" class="Bound">N</a><a id="17042" class="Symbol">}</a> <a id="17044" href="/Substitution/#15561" class="Function">exts-cons-shift</a> <a id="17060" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a><a id="17064" class="Symbol">)</a> <a id="17066" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">⟩</a>
     <a id="17073" href="/Untyped/#4238" class="InductiveConstructor Operator">ƛ</a> <a id="17075" href="/Substitution/#2663" class="Function Operator">⟪</a> <a id="17077" class="Symbol">(</a><a id="17078" href="/Untyped/#4186" class="InductiveConstructor Operator">`</a> <a id="17080" href="/Untyped/#3401" class="InductiveConstructor">Z</a><a id="17081" class="Symbol">)</a> <a id="17083" href="/Substitution/#3592" class="Function Operator">•</a> <a id="17085" class="Symbol">(</a><a id="17086" href="/Substitution/#16948" class="Bound">σ</a> <a id="17088" href="/Substitution/#3945" class="Function Operator">⨟</a> <a id="17090" href="/Substitution/#3334" class="Function">↑</a><a id="17091" class="Symbol">)</a> <a id="17093" href="/Substitution/#2663" class="Function Operator">⟫</a> <a id="17095" href="/Substitution/#16955" class="Bound">N</a>
   <a id="17100" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4374" class="Function Operator">∎</a></pre>

<p>The proof of <code class="highlighter-rouge">sub-id</code> requires the following lemma which says that
extending the identity substitution produces the identity
substitution.</p>

<pre class="Agda"><a id="exts-ids"></a><a id="17267" href="/Substitution/#17267" class="Function">exts-ids</a> <a id="17276" class="Symbol">:</a> <a id="17278" class="Symbol">∀{</a><a id="17280" href="/Substitution/#17280" class="Bound">Γ</a><a id="17281" class="Symbol">}{</a><a id="17283" href="/Substitution/#17283" class="Bound">A</a> <a id="17285" href="/Substitution/#17285" class="Bound">B</a><a id="17286" class="Symbol">}</a>
         <a id="17297" class="Symbol">→</a> <a id="17299" href="/Untyped/#6623" class="Function">exts</a> <a id="17304" href="/Substitution/#3179" class="Function">ids</a> <a id="17308" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="17310" href="/Substitution/#3179" class="Function">ids</a> <a id="17314" class="Symbol">{</a><a id="17315" href="/Substitution/#17280" class="Bound">Γ</a> <a id="17317" href="/Untyped/#3018" class="InductiveConstructor Operator">,</a> <a id="17319" href="/Substitution/#17285" class="Bound">B</a><a id="17320" class="Symbol">}</a> <a id="17322" class="Symbol">{</a><a id="17323" href="/Substitution/#17283" class="Bound">A</a><a id="17324" class="Symbol">}</a>
<a id="17326" href="/Substitution/#17267" class="Function">exts-ids</a> <a id="17335" class="Symbol">{</a><a id="17336" href="/Substitution/#17336" class="Bound">Γ</a><a id="17337" class="Symbol">}{</a><a id="17339" href="/Substitution/#17339" class="Bound">A</a><a id="17340" class="Symbol">}{</a><a id="17342" href="/Substitution/#17342" class="Bound">B</a><a id="17343" class="Symbol">}</a> <a id="17345" class="Symbol">=</a> <a id="17347" href="/Substitution/#1996" class="Postulate">extensionality</a> <a id="17362" href="/Substitution/#17376" class="Function">lemma</a>
  <a id="17370" class="Keyword">where</a> <a id="17376" href="/Substitution/#17376" class="Function">lemma</a> <a id="17382" class="Symbol">:</a> <a id="17384" class="Symbol">(</a><a id="17385" href="/Substitution/#17385" class="Bound">x</a> <a id="17387" class="Symbol">:</a> <a id="17389" href="/Substitution/#17336" class="Bound">Γ</a> <a id="17391" href="/Untyped/#3018" class="InductiveConstructor Operator">,</a> <a id="17393" href="/Substitution/#17342" class="Bound">B</a> <a id="17395" href="/Untyped/#3365" class="Datatype Operator">∋</a> <a id="17397" href="/Substitution/#17339" class="Bound">A</a><a id="17398" class="Symbol">)</a> <a id="17400" class="Symbol">→</a> <a id="17402" href="/Untyped/#6623" class="Function">exts</a> <a id="17407" href="/Substitution/#3179" class="Function">ids</a> <a id="17411" href="/Substitution/#17385" class="Bound">x</a> <a id="17413" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="17415" href="/Substitution/#3179" class="Function">ids</a> <a id="17419" href="/Substitution/#17385" class="Bound">x</a>
        <a id="17429" href="/Substitution/#17376" class="Function">lemma</a> <a id="17435" href="/Untyped/#3401" class="InductiveConstructor">Z</a> <a id="17437" class="Symbol">=</a> <a id="17439" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a>
        <a id="17452" href="/Substitution/#17376" class="Function">lemma</a> <a id="17458" class="Symbol">(</a><a id="17459" href="/Untyped/#3446" class="InductiveConstructor Operator">S</a> <a id="17461" href="/Substitution/#17461" class="Bound">x</a><a id="17462" class="Symbol">)</a> <a id="17464" class="Symbol">=</a> <a id="17466" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a></pre>

<p>The proof of <code class="highlighter-rouge">⟪ ids ⟫ M ≡ M</code> now follows easily by induction on <code class="highlighter-rouge">M</code>,
using <code class="highlighter-rouge">exts-ids</code> in the case for <code class="highlighter-rouge">M ≡ ƛ N</code>.</p>

<pre class="Agda"><a id="sub-id"></a><a id="17610" href="/Substitution/#17610" class="Function">sub-id</a> <a id="17617" class="Symbol">:</a> <a id="17619" class="Symbol">∀{</a><a id="17621" href="/Substitution/#17621" class="Bound">Γ</a><a id="17622" class="Symbol">}</a> <a id="17624" class="Symbol">{</a><a id="17625" href="/Substitution/#17625" class="Bound">A</a><a id="17626" class="Symbol">}</a> <a id="17628" class="Symbol">{</a><a id="17629" href="/Substitution/#17629" class="Bound">M</a> <a id="17631" class="Symbol">:</a> <a id="17633" href="/Substitution/#17621" class="Bound">Γ</a> <a id="17635" href="/Untyped/#4150" class="Datatype Operator">⊢</a> <a id="17637" href="/Substitution/#17625" class="Bound">A</a><a id="17638" class="Symbol">}</a>
         <a id="17649" class="Symbol">→</a> <a id="17651" href="/Substitution/#2663" class="Function Operator">⟪</a> <a id="17653" href="/Substitution/#3179" class="Function">ids</a> <a id="17657" href="/Substitution/#2663" class="Function Operator">⟫</a> <a id="17659" href="/Substitution/#17629" class="Bound">M</a> <a id="17661" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="17663" href="/Substitution/#17629" class="Bound">M</a>
<a id="17665" href="/Substitution/#17610" class="Function">sub-id</a> <a id="17672" class="Symbol">{</a><a id="17673" class="Argument">M</a> <a id="17675" class="Symbol">=</a> <a id="17677" href="/Untyped/#4186" class="InductiveConstructor Operator">`</a> <a id="17679" href="/Substitution/#17679" class="Bound">x</a><a id="17680" class="Symbol">}</a> <a id="17682" class="Symbol">=</a> <a id="17684" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a>
<a id="17689" href="/Substitution/#17610" class="Function">sub-id</a> <a id="17696" class="Symbol">{</a><a id="17697" class="Argument">M</a> <a id="17699" class="Symbol">=</a> <a id="17701" href="/Untyped/#4238" class="InductiveConstructor Operator">ƛ</a> <a id="17703" href="/Substitution/#17703" class="Bound">N</a><a id="17704" class="Symbol">}</a> <a id="17706" class="Symbol">=</a> 
   <a id="17712" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4076" class="Function Operator">begin</a>
     <a id="17723" href="/Substitution/#2663" class="Function Operator">⟪</a> <a id="17725" href="/Substitution/#3179" class="Function">ids</a> <a id="17729" href="/Substitution/#2663" class="Function Operator">⟫</a> <a id="17731" class="Symbol">(</a><a id="17732" href="/Untyped/#4238" class="InductiveConstructor Operator">ƛ</a> <a id="17734" href="/Substitution/#17703" class="Bound">N</a><a id="17735" class="Symbol">)</a>
   <a id="17740" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4134" class="Function Operator">≡⟨⟩</a>
     <a id="17749" href="/Untyped/#4238" class="InductiveConstructor Operator">ƛ</a> <a id="17751" href="/Substitution/#2663" class="Function Operator">⟪</a> <a id="17753" href="/Untyped/#6623" class="Function">exts</a> <a id="17758" href="/Substitution/#3179" class="Function">ids</a> <a id="17762" href="/Substitution/#2663" class="Function Operator">⟫</a> <a id="17764" href="/Substitution/#17703" class="Bound">N</a>
   <a id="17769" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">≡⟨</a> <a id="17772" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#1170" class="Function">cong</a> <a id="17777" href="/Untyped/#4238" class="InductiveConstructor Operator">ƛ_</a> <a id="17780" class="Symbol">(</a><a id="17781" href="/Substitution/#11568" class="Function">cong-sub</a><a id="17789" class="Symbol">{</a><a id="17790" class="Argument">M</a> <a id="17792" class="Symbol">=</a> <a id="17794" href="/Substitution/#17703" class="Bound">N</a><a id="17795" class="Symbol">}</a> <a id="17797" href="/Substitution/#17267" class="Function">exts-ids</a> <a id="17806" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a><a id="17810" class="Symbol">)</a>  <a id="17813" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">⟩</a>
     <a id="17820" href="/Untyped/#4238" class="InductiveConstructor Operator">ƛ</a> <a id="17822" href="/Substitution/#2663" class="Function Operator">⟪</a> <a id="17824" href="/Substitution/#3179" class="Function">ids</a> <a id="17828" href="/Substitution/#2663" class="Function Operator">⟫</a> <a id="17830" href="/Substitution/#17703" class="Bound">N</a>
   <a id="17835" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">≡⟨</a> <a id="17838" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#1170" class="Function">cong</a> <a id="17843" href="/Untyped/#4238" class="InductiveConstructor Operator">ƛ_</a> <a id="17846" href="/Substitution/#17610" class="Function">sub-id</a> <a id="17853" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">⟩</a>
     <a id="17860" href="/Untyped/#4238" class="InductiveConstructor Operator">ƛ</a> <a id="17862" href="/Substitution/#17703" class="Bound">N</a>
   <a id="17867" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4374" class="Function Operator">∎</a>
<a id="17869" href="/Substitution/#17610" class="Function">sub-id</a> <a id="17876" class="Symbol">{</a><a id="17877" class="Argument">M</a> <a id="17879" class="Symbol">=</a> <a id="17881" href="/Substitution/#17881" class="Bound">L</a> <a id="17883" href="/Untyped/#4298" class="InductiveConstructor Operator">·</a> <a id="17885" href="/Substitution/#17885" class="Bound">M</a><a id="17886" class="Symbol">}</a> <a id="17888" class="Symbol">=</a> <a id="17890" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#1408" class="Function">cong₂</a> <a id="17896" href="/Untyped/#4298" class="InductiveConstructor Operator">_·_</a> <a id="17900" href="/Substitution/#17610" class="Function">sub-id</a> <a id="17907" href="/Substitution/#17610" class="Function">sub-id</a></pre>

<p>The <code class="highlighter-rouge">rename-id</code> equation is a corollary is <code class="highlighter-rouge">sub-id</code>.</p>

<pre class="Agda"><a id="rename-id"></a><a id="17993" href="/Substitution/#17993" class="Function">rename-id</a> <a id="18003" class="Symbol">:</a> <a id="18005" class="Symbol">∀</a> <a id="18007" class="Symbol">{</a><a id="18008" href="/Substitution/#18008" class="Bound">Γ</a><a id="18009" class="Symbol">}{</a><a id="18011" href="/Substitution/#18011" class="Bound">A</a><a id="18012" class="Symbol">}</a> <a id="18014" class="Symbol">{</a><a id="18015" href="/Substitution/#18015" class="Bound">M</a> <a id="18017" class="Symbol">:</a> <a id="18019" href="/Substitution/#18008" class="Bound">Γ</a> <a id="18021" href="/Untyped/#4150" class="Datatype Operator">⊢</a> <a id="18023" href="/Substitution/#18011" class="Bound">A</a><a id="18024" class="Symbol">}</a> 
  <a id="18029" class="Symbol">→</a> <a id="18031" href="/Untyped/#6171" class="Function">rename</a> <a id="18038" class="Symbol">(λ</a> <a id="18041" class="Symbol">{</a><a id="18042" href="/Substitution/#18042" class="Bound">A</a><a id="18043" class="Symbol">}</a> <a id="18045" href="/Substitution/#18045" class="Bound">x</a> <a id="18047" class="Symbol">→</a> <a id="18049" href="/Substitution/#18045" class="Bound">x</a><a id="18050" class="Symbol">)</a> <a id="18052" href="/Substitution/#18015" class="Bound">M</a> <a id="18054" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="18056" href="/Substitution/#18015" class="Bound">M</a>
<a id="18058" href="/Substitution/#17993" class="Function">rename-id</a> <a id="18068" class="Symbol">{</a><a id="18069" class="Argument">M</a> <a id="18071" class="Symbol">=</a> <a id="18073" href="/Substitution/#18073" class="Bound">M</a><a id="18074" class="Symbol">}</a> <a id="18076" class="Symbol">=</a>
   <a id="18081" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4076" class="Function Operator">begin</a>
     <a id="18092" href="/Untyped/#6171" class="Function">rename</a> <a id="18099" class="Symbol">(λ</a> <a id="18102" class="Symbol">{</a><a id="18103" href="/Substitution/#18103" class="Bound">A</a><a id="18104" class="Symbol">}</a> <a id="18106" href="/Substitution/#18106" class="Bound">x</a> <a id="18108" class="Symbol">→</a> <a id="18110" href="/Substitution/#18106" class="Bound">x</a><a id="18111" class="Symbol">)</a> <a id="18113" href="/Substitution/#18073" class="Bound">M</a>
   <a id="18118" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">≡⟨</a> <a id="18121" href="/Substitution/#14149" class="Function">rename-subst-ren</a>  <a id="18139" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">⟩</a>
     <a id="18146" href="/Substitution/#2663" class="Function Operator">⟪</a> <a id="18148" href="/Substitution/#6703" class="Function">ren</a> <a id="18152" class="Symbol">(λ</a> <a id="18155" class="Symbol">{</a><a id="18156" href="/Substitution/#18156" class="Bound">A</a><a id="18157" class="Symbol">}</a> <a id="18159" href="/Substitution/#18159" class="Bound">x</a> <a id="18161" class="Symbol">→</a> <a id="18163" href="/Substitution/#18159" class="Bound">x</a><a id="18164" class="Symbol">)</a> <a id="18166" href="/Substitution/#2663" class="Function Operator">⟫</a> <a id="18168" href="/Substitution/#18073" class="Bound">M</a>
   <a id="18173" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4134" class="Function Operator">≡⟨⟩</a>
     <a id="18182" href="/Substitution/#2663" class="Function Operator">⟪</a> <a id="18184" href="/Substitution/#3179" class="Function">ids</a> <a id="18188" href="/Substitution/#2663" class="Function Operator">⟫</a> <a id="18190" href="/Substitution/#18073" class="Bound">M</a>
   <a id="18195" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">≡⟨</a> <a id="18198" href="/Substitution/#17610" class="Function">sub-id</a>  <a id="18206" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">⟩</a>
     <a id="18213" href="/Substitution/#18073" class="Bound">M</a>
   <a id="18218" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4374" class="Function Operator">∎</a></pre>

<h2 id="proof-of-sub-idr">Proof of sub-idR</h2>

<p>The proof of <code class="highlighter-rouge">sub-idR</code> follows directly from <code class="highlighter-rouge">sub-id</code>.</p>

<pre class="Agda"><a id="sub-idR"></a><a id="18322" href="/Substitution/#18322" class="Function">sub-idR</a> <a id="18330" class="Symbol">:</a> <a id="18332" class="Symbol">∀{</a><a id="18334" href="/Substitution/#18334" class="Bound">Γ</a> <a id="18336" href="/Substitution/#18336" class="Bound">Δ</a><a id="18337" class="Symbol">}</a> <a id="18339" class="Symbol">{</a><a id="18340" href="/Substitution/#18340" class="Bound">σ</a> <a id="18342" class="Symbol">:</a> <a id="18344" href="/Substitution/#2506" class="Function">Subst</a> <a id="18350" href="/Substitution/#18334" class="Bound">Γ</a> <a id="18352" href="/Substitution/#18336" class="Bound">Δ</a><a id="18353" class="Symbol">}</a> <a id="18355" class="Symbol">{</a><a id="18356" href="/Substitution/#18356" class="Bound">A</a><a id="18357" class="Symbol">}</a>
       <a id="18366" class="Symbol">→</a> <a id="18368" class="Symbol">(</a><a id="18369" href="/Substitution/#18340" class="Bound">σ</a> <a id="18371" href="/Substitution/#3945" class="Function Operator">⨟</a> <a id="18373" href="/Substitution/#3179" class="Function">ids</a><a id="18376" class="Symbol">)</a> <a id="18378" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="18380" href="/Substitution/#18340" class="Bound">σ</a> <a id="18382" class="Symbol">{</a><a id="18383" href="/Substitution/#18356" class="Bound">A</a><a id="18384" class="Symbol">}</a>
<a id="18386" href="/Substitution/#18322" class="Function">sub-idR</a> <a id="18394" class="Symbol">{</a><a id="18395" href="/Substitution/#18395" class="Bound">Γ</a><a id="18396" class="Symbol">}{</a><a id="18398" class="Argument">σ</a> <a id="18400" class="Symbol">=</a> <a id="18402" href="/Substitution/#18402" class="Bound">σ</a><a id="18403" class="Symbol">}{</a><a id="18405" href="/Substitution/#18405" class="Bound">A</a><a id="18406" class="Symbol">}</a> <a id="18408" class="Symbol">=</a>
          <a id="18420" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4076" class="Function Operator">begin</a>
            <a id="18438" href="/Substitution/#18402" class="Bound">σ</a> <a id="18440" href="/Substitution/#3945" class="Function Operator">⨟</a> <a id="18442" href="/Substitution/#3179" class="Function">ids</a>
          <a id="18456" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4134" class="Function Operator">≡⟨⟩</a>
            <a id="18472" href="/Substitution/#2663" class="Function Operator">⟪</a> <a id="18474" href="/Substitution/#3179" class="Function">ids</a> <a id="18478" href="/Substitution/#2663" class="Function Operator">⟫</a> <a id="18480" href="https://agda.github.io/agda-stdlib/v0.17/Function.html#769" class="Function Operator">∘</a> <a id="18482" href="/Substitution/#18402" class="Bound">σ</a>
          <a id="18494" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">≡⟨</a> <a id="18497" href="/Substitution/#1996" class="Postulate">extensionality</a> <a id="18512" class="Symbol">(λ</a> <a id="18515" href="/Substitution/#18515" class="Bound">x</a> <a id="18517" class="Symbol">→</a> <a id="18519" href="/Substitution/#17610" class="Function">sub-id</a><a id="18525" class="Symbol">)</a> <a id="18527" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">⟩</a>
            <a id="18541" href="/Substitution/#18402" class="Bound">σ</a>
          <a id="18553" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4374" class="Function Operator">∎</a></pre>

<h2 id="proof-of-sub-sub">Proof of sub-sub</h2>

<p>The <code class="highlighter-rouge">sub-sub</code> equation states that sequenced substitutions <code class="highlighter-rouge">σ ⨟ τ</code>
are equivalent to first applying <code class="highlighter-rouge">σ</code> then applying <code class="highlighter-rouge">τ</code>.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>⟪ τ ⟫ ⟪ σ ⟫ M  ≡ ⟪ σ ⨟ τ ⟫ M
</code></pre></div></div>

<p>The proof requires several lemmas. First, we need to prove the
specialization for renaming.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>rename ρ (rename ρ′ M) ≡ rename (ρ ∘ ρ′) M
</code></pre></div></div>

<p>This in turn requires the following lemma about <code class="highlighter-rouge">ext</code>.</p>

<pre class="Agda"><a id="compose-ext"></a><a id="18957" href="/Substitution/#18957" class="Function">compose-ext</a> <a id="18969" class="Symbol">:</a> <a id="18971" class="Symbol">∀{</a><a id="18973" href="/Substitution/#18973" class="Bound">Γ</a> <a id="18975" href="/Substitution/#18975" class="Bound">Δ</a> <a id="18977" href="/Substitution/#18977" class="Bound">Σ</a><a id="18978" class="Symbol">}{</a><a id="18980" href="/Substitution/#18980" class="Bound">ρ</a> <a id="18982" class="Symbol">:</a> <a id="18984" href="/Substitution/#2277" class="Function">Rename</a> <a id="18991" href="/Substitution/#18975" class="Bound">Δ</a> <a id="18993" href="/Substitution/#18977" class="Bound">Σ</a><a id="18994" class="Symbol">}</a> <a id="18996" class="Symbol">{</a><a id="18997" href="/Substitution/#18997" class="Bound">ρ′</a> <a id="19000" class="Symbol">:</a> <a id="19002" href="/Substitution/#2277" class="Function">Rename</a> <a id="19009" href="/Substitution/#18973" class="Bound">Γ</a> <a id="19011" href="/Substitution/#18975" class="Bound">Δ</a><a id="19012" class="Symbol">}</a> <a id="19014" class="Symbol">{</a><a id="19015" href="/Substitution/#19015" class="Bound">A</a> <a id="19017" href="/Substitution/#19017" class="Bound">B</a><a id="19018" class="Symbol">}</a>
            <a id="19032" class="Symbol">→</a> <a id="19034" class="Symbol">((</a><a id="19036" href="/Untyped/#5845" class="Function">ext</a> <a id="19040" href="/Substitution/#18980" class="Bound">ρ</a><a id="19041" class="Symbol">)</a> <a id="19043" href="https://agda.github.io/agda-stdlib/v0.17/Function.html#769" class="Function Operator">∘</a> <a id="19045" class="Symbol">(</a><a id="19046" href="/Untyped/#5845" class="Function">ext</a> <a id="19050" href="/Substitution/#18997" class="Bound">ρ′</a><a id="19052" class="Symbol">))</a> <a id="19055" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="19057" href="/Untyped/#5845" class="Function">ext</a> <a id="19061" class="Symbol">(</a><a id="19062" href="/Substitution/#18980" class="Bound">ρ</a> <a id="19064" href="https://agda.github.io/agda-stdlib/v0.17/Function.html#769" class="Function Operator">∘</a> <a id="19066" href="/Substitution/#18997" class="Bound">ρ′</a><a id="19068" class="Symbol">)</a> <a id="19070" class="Symbol">{</a><a id="19071" href="/Substitution/#19017" class="Bound">B</a><a id="19072" class="Symbol">}</a> <a id="19074" class="Symbol">{</a><a id="19075" href="/Substitution/#19015" class="Bound">A</a><a id="19076" class="Symbol">}</a>
<a id="19078" href="/Substitution/#18957" class="Function">compose-ext</a> <a id="19090" class="Symbol">=</a> <a id="19092" href="/Substitution/#1996" class="Postulate">extensionality</a> <a id="19107" class="Symbol">λ</a> <a id="19109" href="/Substitution/#19109" class="Bound">x</a> <a id="19111" class="Symbol">→</a> <a id="19113" href="/Substitution/#19137" class="Function">lemma</a> <a id="19119" class="Symbol">{</a><a id="19120" class="Argument">x</a> <a id="19122" class="Symbol">=</a> <a id="19124" href="/Substitution/#19109" class="Bound">x</a><a id="19125" class="Symbol">}</a>
  <a id="19129" class="Keyword">where</a>
  <a id="19137" href="/Substitution/#19137" class="Function">lemma</a> <a id="19143" class="Symbol">:</a> <a id="19145" class="Symbol">∀{</a><a id="19147" href="/Substitution/#19147" class="Bound">Γ</a> <a id="19149" href="/Substitution/#19149" class="Bound">Δ</a> <a id="19151" href="/Substitution/#19151" class="Bound">Σ</a><a id="19152" class="Symbol">}{</a><a id="19154" href="/Substitution/#19154" class="Bound">ρ</a> <a id="19156" class="Symbol">:</a> <a id="19158" href="/Substitution/#2277" class="Function">Rename</a> <a id="19165" href="/Substitution/#19149" class="Bound">Δ</a> <a id="19167" href="/Substitution/#19151" class="Bound">Σ</a><a id="19168" class="Symbol">}</a> <a id="19170" class="Symbol">{</a><a id="19171" href="/Substitution/#19171" class="Bound">ρ′</a> <a id="19174" class="Symbol">:</a> <a id="19176" href="/Substitution/#2277" class="Function">Rename</a> <a id="19183" href="/Substitution/#19147" class="Bound">Γ</a> <a id="19185" href="/Substitution/#19149" class="Bound">Δ</a><a id="19186" class="Symbol">}</a> <a id="19188" class="Symbol">{</a><a id="19189" href="/Substitution/#19189" class="Bound">A</a> <a id="19191" href="/Substitution/#19191" class="Bound">B</a><a id="19192" class="Symbol">}</a> <a id="19194" class="Symbol">{</a><a id="19195" href="/Substitution/#19195" class="Bound">x</a> <a id="19197" class="Symbol">:</a> <a id="19199" href="/Substitution/#19147" class="Bound">Γ</a> <a id="19201" href="/Untyped/#3018" class="InductiveConstructor Operator">,</a> <a id="19203" href="/Substitution/#19191" class="Bound">B</a> <a id="19205" href="/Untyped/#3365" class="Datatype Operator">∋</a> <a id="19207" href="/Substitution/#19189" class="Bound">A</a><a id="19208" class="Symbol">}</a>
              <a id="19224" class="Symbol">→</a> <a id="19226" class="Symbol">((</a><a id="19228" href="/Untyped/#5845" class="Function">ext</a> <a id="19232" href="/Substitution/#19154" class="Bound">ρ</a><a id="19233" class="Symbol">)</a> <a id="19235" href="https://agda.github.io/agda-stdlib/v0.17/Function.html#769" class="Function Operator">∘</a> <a id="19237" class="Symbol">(</a><a id="19238" href="/Untyped/#5845" class="Function">ext</a> <a id="19242" href="/Substitution/#19171" class="Bound">ρ′</a><a id="19244" class="Symbol">))</a> <a id="19247" href="/Substitution/#19195" class="Bound">x</a> <a id="19249" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="19251" href="/Untyped/#5845" class="Function">ext</a> <a id="19255" class="Symbol">(</a><a id="19256" href="/Substitution/#19154" class="Bound">ρ</a> <a id="19258" href="https://agda.github.io/agda-stdlib/v0.17/Function.html#769" class="Function Operator">∘</a> <a id="19260" href="/Substitution/#19171" class="Bound">ρ′</a><a id="19262" class="Symbol">)</a> <a id="19264" href="/Substitution/#19195" class="Bound">x</a>
  <a id="19268" href="/Substitution/#19137" class="Function">lemma</a> <a id="19274" class="Symbol">{</a><a id="19275" class="Argument">x</a> <a id="19277" class="Symbol">=</a> <a id="19279" href="/Untyped/#3401" class="InductiveConstructor">Z</a><a id="19280" class="Symbol">}</a> <a id="19282" class="Symbol">=</a> <a id="19284" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a>
  <a id="19291" href="/Substitution/#19137" class="Function">lemma</a> <a id="19297" class="Symbol">{</a><a id="19298" class="Argument">x</a> <a id="19300" class="Symbol">=</a> <a id="19302" href="/Untyped/#3446" class="InductiveConstructor Operator">S</a> <a id="19304" href="/Substitution/#19304" class="Bound">x</a><a id="19305" class="Symbol">}</a> <a id="19307" class="Symbol">=</a> <a id="19309" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a></pre>

<p>To prove that composing renamings is equivalent to applying one after
the other using <code class="highlighter-rouge">rename</code>, we proceed by induction on the term <code class="highlighter-rouge">M</code>,
using the <code class="highlighter-rouge">compose-ext</code> lemma in the case for <code class="highlighter-rouge">M ≡ ƛ N</code>.</p>

<pre class="Agda"><a id="compose-rename"></a><a id="19534" href="/Substitution/#19534" class="Function">compose-rename</a> <a id="19549" class="Symbol">:</a> <a id="19551" class="Symbol">∀{</a><a id="19553" href="/Substitution/#19553" class="Bound">Γ</a> <a id="19555" href="/Substitution/#19555" class="Bound">Δ</a> <a id="19557" href="/Substitution/#19557" class="Bound">Σ</a><a id="19558" class="Symbol">}{</a><a id="19560" href="/Substitution/#19560" class="Bound">A</a><a id="19561" class="Symbol">}{</a><a id="19563" href="/Substitution/#19563" class="Bound">M</a> <a id="19565" class="Symbol">:</a> <a id="19567" href="/Substitution/#19553" class="Bound">Γ</a> <a id="19569" href="/Untyped/#4150" class="Datatype Operator">⊢</a> <a id="19571" href="/Substitution/#19560" class="Bound">A</a><a id="19572" class="Symbol">}{</a><a id="19574" href="/Substitution/#19574" class="Bound">ρ</a> <a id="19576" class="Symbol">:</a> <a id="19578" href="/Substitution/#2277" class="Function">Rename</a> <a id="19585" href="/Substitution/#19555" class="Bound">Δ</a> <a id="19587" href="/Substitution/#19557" class="Bound">Σ</a><a id="19588" class="Symbol">}{</a><a id="19590" href="/Substitution/#19590" class="Bound">ρ′</a> <a id="19593" class="Symbol">:</a> <a id="19595" href="/Substitution/#2277" class="Function">Rename</a> <a id="19602" href="/Substitution/#19553" class="Bound">Γ</a> <a id="19604" href="/Substitution/#19555" class="Bound">Δ</a><a id="19605" class="Symbol">}</a> 
  <a id="19610" class="Symbol">→</a> <a id="19612" href="/Untyped/#6171" class="Function">rename</a> <a id="19619" href="/Substitution/#19574" class="Bound">ρ</a> <a id="19621" class="Symbol">(</a><a id="19622" href="/Untyped/#6171" class="Function">rename</a> <a id="19629" href="/Substitution/#19590" class="Bound">ρ′</a> <a id="19632" href="/Substitution/#19563" class="Bound">M</a><a id="19633" class="Symbol">)</a> <a id="19635" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="19637" href="/Untyped/#6171" class="Function">rename</a> <a id="19644" class="Symbol">(</a><a id="19645" href="/Substitution/#19574" class="Bound">ρ</a> <a id="19647" href="https://agda.github.io/agda-stdlib/v0.17/Function.html#769" class="Function Operator">∘</a> <a id="19649" href="/Substitution/#19590" class="Bound">ρ′</a><a id="19651" class="Symbol">)</a> <a id="19653" href="/Substitution/#19563" class="Bound">M</a>
<a id="19655" href="/Substitution/#19534" class="Function">compose-rename</a> <a id="19670" class="Symbol">{</a><a id="19671" class="Argument">M</a> <a id="19673" class="Symbol">=</a> <a id="19675" href="/Untyped/#4186" class="InductiveConstructor Operator">`</a> <a id="19677" href="/Substitution/#19677" class="Bound">x</a><a id="19678" class="Symbol">}</a> <a id="19680" class="Symbol">=</a> <a id="19682" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a>
<a id="19687" href="/Substitution/#19534" class="Function">compose-rename</a> <a id="19702" class="Symbol">{</a><a id="19703" href="/Substitution/#19703" class="Bound">Γ</a><a id="19704" class="Symbol">}{</a><a id="19706" href="/Substitution/#19706" class="Bound">Δ</a><a id="19707" class="Symbol">}{</a><a id="19709" href="/Substitution/#19709" class="Bound">Σ</a><a id="19710" class="Symbol">}{</a><a id="19712" href="/Substitution/#19712" class="Bound">A</a><a id="19713" class="Symbol">}{</a><a id="19715" href="/Untyped/#4238" class="InductiveConstructor Operator">ƛ</a> <a id="19717" href="/Substitution/#19717" class="Bound">N</a><a id="19718" class="Symbol">}{</a><a id="19720" href="/Substitution/#19720" class="Bound">ρ</a><a id="19721" class="Symbol">}{</a><a id="19723" href="/Substitution/#19723" class="Bound">ρ′</a><a id="19725" class="Symbol">}</a> <a id="19727" class="Symbol">=</a> <a id="19729" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#1170" class="Function">cong</a> <a id="19734" href="/Untyped/#4238" class="InductiveConstructor Operator">ƛ_</a> <a id="19737" href="/Substitution/#19749" class="Function">G</a>
  <a id="19741" class="Keyword">where</a>
  <a id="19749" href="/Substitution/#19749" class="Function">G</a> <a id="19751" class="Symbol">:</a> <a id="19753" href="/Untyped/#6171" class="Function">rename</a> <a id="19760" class="Symbol">(</a><a id="19761" href="/Untyped/#5845" class="Function">ext</a> <a id="19765" href="/Substitution/#19720" class="Bound">ρ</a><a id="19766" class="Symbol">)</a> <a id="19768" class="Symbol">(</a><a id="19769" href="/Untyped/#6171" class="Function">rename</a> <a id="19776" class="Symbol">(</a><a id="19777" href="/Untyped/#5845" class="Function">ext</a> <a id="19781" href="/Substitution/#19723" class="Bound">ρ′</a><a id="19783" class="Symbol">)</a> <a id="19785" href="/Substitution/#19717" class="Bound">N</a><a id="19786" class="Symbol">)</a> <a id="19788" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="19790" href="/Untyped/#6171" class="Function">rename</a> <a id="19797" class="Symbol">(</a><a id="19798" href="/Untyped/#5845" class="Function">ext</a> <a id="19802" class="Symbol">(</a><a id="19803" href="/Substitution/#19720" class="Bound">ρ</a> <a id="19805" href="https://agda.github.io/agda-stdlib/v0.17/Function.html#769" class="Function Operator">∘</a> <a id="19807" href="/Substitution/#19723" class="Bound">ρ′</a><a id="19809" class="Symbol">))</a> <a id="19812" href="/Substitution/#19717" class="Bound">N</a>
  <a id="19816" href="/Substitution/#19749" class="Function">G</a> <a id="19818" class="Symbol">=</a>
      <a id="19826" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4076" class="Function Operator">begin</a>
        <a id="19840" href="/Untyped/#6171" class="Function">rename</a> <a id="19847" class="Symbol">(</a><a id="19848" href="/Untyped/#5845" class="Function">ext</a> <a id="19852" href="/Substitution/#19720" class="Bound">ρ</a><a id="19853" class="Symbol">)</a> <a id="19855" class="Symbol">(</a><a id="19856" href="/Untyped/#6171" class="Function">rename</a> <a id="19863" class="Symbol">(</a><a id="19864" href="/Untyped/#5845" class="Function">ext</a> <a id="19868" href="/Substitution/#19723" class="Bound">ρ′</a><a id="19870" class="Symbol">)</a> <a id="19872" href="/Substitution/#19717" class="Bound">N</a><a id="19873" class="Symbol">)</a>
      <a id="19881" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">≡⟨</a> <a id="19884" href="/Substitution/#19534" class="Function">compose-rename</a><a id="19898" class="Symbol">{</a><a id="19899" class="Argument">ρ</a> <a id="19901" class="Symbol">=</a> <a id="19903" href="/Untyped/#5845" class="Function">ext</a> <a id="19907" href="/Substitution/#19720" class="Bound">ρ</a><a id="19908" class="Symbol">}{</a><a id="19910" class="Argument">ρ′</a> <a id="19913" class="Symbol">=</a> <a id="19915" href="/Untyped/#5845" class="Function">ext</a> <a id="19919" href="/Substitution/#19723" class="Bound">ρ′</a><a id="19921" class="Symbol">}</a> <a id="19923" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">⟩</a>
        <a id="19933" href="/Untyped/#6171" class="Function">rename</a> <a id="19940" class="Symbol">((</a><a id="19942" href="/Untyped/#5845" class="Function">ext</a> <a id="19946" href="/Substitution/#19720" class="Bound">ρ</a><a id="19947" class="Symbol">)</a> <a id="19949" href="https://agda.github.io/agda-stdlib/v0.17/Function.html#769" class="Function Operator">∘</a> <a id="19951" class="Symbol">(</a><a id="19952" href="/Untyped/#5845" class="Function">ext</a> <a id="19956" href="/Substitution/#19723" class="Bound">ρ′</a><a id="19958" class="Symbol">))</a> <a id="19961" href="/Substitution/#19717" class="Bound">N</a>
      <a id="19969" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">≡⟨</a> <a id="19972" href="/Substitution/#10734" class="Function">cong-rename</a> <a id="19984" href="/Substitution/#18957" class="Function">compose-ext</a> <a id="19996" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a> <a id="20001" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">⟩</a>
        <a id="20011" href="/Untyped/#6171" class="Function">rename</a> <a id="20018" class="Symbol">(</a><a id="20019" href="/Untyped/#5845" class="Function">ext</a> <a id="20023" class="Symbol">(</a><a id="20024" href="/Substitution/#19720" class="Bound">ρ</a> <a id="20026" href="https://agda.github.io/agda-stdlib/v0.17/Function.html#769" class="Function Operator">∘</a> <a id="20028" href="/Substitution/#19723" class="Bound">ρ′</a><a id="20030" class="Symbol">))</a> <a id="20033" href="/Substitution/#19717" class="Bound">N</a>
      <a id="20041" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4374" class="Function Operator">∎</a>        
<a id="20051" href="/Substitution/#19534" class="Function">compose-rename</a> <a id="20066" class="Symbol">{</a><a id="20067" class="Argument">M</a> <a id="20069" class="Symbol">=</a> <a id="20071" href="/Substitution/#20071" class="Bound">L</a> <a id="20073" href="/Untyped/#4298" class="InductiveConstructor Operator">·</a> <a id="20075" href="/Substitution/#20075" class="Bound">M</a><a id="20076" class="Symbol">}</a> <a id="20078" class="Symbol">=</a> <a id="20080" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#1408" class="Function">cong₂</a> <a id="20086" href="/Untyped/#4298" class="InductiveConstructor Operator">_·_</a> <a id="20090" href="/Substitution/#19534" class="Function">compose-rename</a> <a id="20105" href="/Substitution/#19534" class="Function">compose-rename</a></pre>

<p>The next lemma states that if a renaming and substitution commute on
variables, then they also commute on terms. We explain the proof in
detail below.</p>

<pre class="Agda"><a id="commute-subst-rename"></a><a id="20297" href="/Substitution/#20297" class="Function">commute-subst-rename</a> <a id="20318" class="Symbol">:</a> <a id="20320" class="Symbol">∀{</a><a id="20322" href="/Substitution/#20322" class="Bound">Γ</a> <a id="20324" href="/Substitution/#20324" class="Bound">Δ</a><a id="20325" class="Symbol">}{</a><a id="20327" href="/Substitution/#20327" class="Bound">M</a> <a id="20329" class="Symbol">:</a> <a id="20331" href="/Substitution/#20322" class="Bound">Γ</a> <a id="20333" href="/Untyped/#4150" class="Datatype Operator">⊢</a> <a id="20335" href="/Untyped/#2694" class="InductiveConstructor">★</a><a id="20336" class="Symbol">}{</a><a id="20338" href="/Substitution/#20338" class="Bound">σ</a> <a id="20340" class="Symbol">:</a> <a id="20342" href="/Substitution/#2506" class="Function">Subst</a> <a id="20348" href="/Substitution/#20322" class="Bound">Γ</a> <a id="20350" href="/Substitution/#20324" class="Bound">Δ</a><a id="20351" class="Symbol">}</a>
                        <a id="20377" class="Symbol">{</a><a id="20378" href="/Substitution/#20378" class="Bound">ρ</a> <a id="20380" class="Symbol">:</a> <a id="20382" class="Symbol">∀{</a><a id="20384" href="/Substitution/#20384" class="Bound">Γ</a><a id="20385" class="Symbol">}</a> <a id="20387" class="Symbol">→</a> <a id="20389" href="/Substitution/#2277" class="Function">Rename</a> <a id="20396" href="/Substitution/#20384" class="Bound">Γ</a> <a id="20398" class="Symbol">(</a><a id="20399" href="/Substitution/#20384" class="Bound">Γ</a> <a id="20401" href="/Untyped/#3018" class="InductiveConstructor Operator">,</a> <a id="20403" href="/Untyped/#2694" class="InductiveConstructor">★</a><a id="20404" class="Symbol">)}</a>
     <a id="20412" class="Symbol">→</a> <a id="20414" class="Symbol">(∀{</a><a id="20417" href="/Substitution/#20417" class="Bound">x</a> <a id="20419" class="Symbol">:</a> <a id="20421" href="/Substitution/#20322" class="Bound">Γ</a> <a id="20423" href="/Untyped/#3365" class="Datatype Operator">∋</a> <a id="20425" href="/Untyped/#2694" class="InductiveConstructor">★</a><a id="20426" class="Symbol">}</a> <a id="20428" class="Symbol">→</a> <a id="20430" href="/Untyped/#6623" class="Function">exts</a> <a id="20435" href="/Substitution/#20338" class="Bound">σ</a> <a id="20437" class="Symbol">{</a><a id="20438" class="Argument">B</a> <a id="20440" class="Symbol">=</a> <a id="20442" href="/Untyped/#2694" class="InductiveConstructor">★</a><a id="20443" class="Symbol">}</a> <a id="20445" class="Symbol">(</a><a id="20446" href="/Substitution/#20378" class="Bound">ρ</a> <a id="20448" href="/Substitution/#20417" class="Bound">x</a><a id="20449" class="Symbol">)</a> <a id="20451" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="20453" href="/Untyped/#6171" class="Function">rename</a> <a id="20460" href="/Substitution/#20378" class="Bound">ρ</a> <a id="20462" class="Symbol">(</a><a id="20463" href="/Substitution/#20338" class="Bound">σ</a> <a id="20465" href="/Substitution/#20417" class="Bound">x</a><a id="20466" class="Symbol">))</a>
     <a id="20474" class="Symbol">→</a> <a id="20476" href="/Untyped/#6931" class="Function">subst</a> <a id="20482" class="Symbol">(</a><a id="20483" href="/Untyped/#6623" class="Function">exts</a> <a id="20488" href="/Substitution/#20338" class="Bound">σ</a> <a id="20490" class="Symbol">{</a><a id="20491" class="Argument">B</a> <a id="20493" class="Symbol">=</a> <a id="20495" href="/Untyped/#2694" class="InductiveConstructor">★</a><a id="20496" class="Symbol">})</a> <a id="20499" class="Symbol">(</a><a id="20500" href="/Untyped/#6171" class="Function">rename</a> <a id="20507" href="/Substitution/#20378" class="Bound">ρ</a> <a id="20509" href="/Substitution/#20327" class="Bound">M</a><a id="20510" class="Symbol">)</a> <a id="20512" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="20514" href="/Untyped/#6171" class="Function">rename</a> <a id="20521" href="/Substitution/#20378" class="Bound">ρ</a> <a id="20523" class="Symbol">(</a><a id="20524" href="/Untyped/#6931" class="Function">subst</a> <a id="20530" href="/Substitution/#20338" class="Bound">σ</a> <a id="20532" href="/Substitution/#20327" class="Bound">M</a><a id="20533" class="Symbol">)</a>
<a id="20535" href="/Substitution/#20297" class="Function">commute-subst-rename</a> <a id="20556" class="Symbol">{</a><a id="20557" class="Argument">M</a> <a id="20559" class="Symbol">=</a> <a id="20561" href="/Untyped/#4186" class="InductiveConstructor Operator">`</a> <a id="20563" href="/Substitution/#20563" class="Bound">x</a><a id="20564" class="Symbol">}</a> <a id="20566" href="/Substitution/#20566" class="Bound">r</a> <a id="20568" class="Symbol">=</a> <a id="20570" href="/Substitution/#20566" class="Bound">r</a>
<a id="20572" href="/Substitution/#20297" class="Function">commute-subst-rename</a><a id="20592" class="Symbol">{</a><a id="20593" href="/Substitution/#20593" class="Bound">Γ</a><a id="20594" class="Symbol">}{</a><a id="20596" href="/Substitution/#20596" class="Bound">Δ</a><a id="20597" class="Symbol">}{</a><a id="20599" href="/Untyped/#4238" class="InductiveConstructor Operator">ƛ</a> <a id="20601" href="/Substitution/#20601" class="Bound">N</a><a id="20602" class="Symbol">}{</a><a id="20604" href="/Substitution/#20604" class="Bound">σ</a><a id="20605" class="Symbol">}{</a><a id="20607" href="/Substitution/#20607" class="Bound">ρ</a><a id="20608" class="Symbol">}</a> <a id="20610" href="/Substitution/#20610" class="Bound">r</a> <a id="20612" class="Symbol">=</a>
   <a id="20617" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#1170" class="Function">cong</a> <a id="20622" href="/Untyped/#4238" class="InductiveConstructor Operator">ƛ_</a> <a id="20625" class="Symbol">(</a><a id="20626" href="/Substitution/#20297" class="Function">commute-subst-rename</a><a id="20646" class="Symbol">{</a><a id="20647" href="/Substitution/#20593" class="Bound">Γ</a> <a id="20649" href="/Untyped/#3018" class="InductiveConstructor Operator">,</a> <a id="20651" href="/Untyped/#2694" class="InductiveConstructor">★</a><a id="20652" class="Symbol">}{</a><a id="20654" href="/Substitution/#20596" class="Bound">Δ</a> <a id="20656" href="/Untyped/#3018" class="InductiveConstructor Operator">,</a> <a id="20658" href="/Untyped/#2694" class="InductiveConstructor">★</a><a id="20659" class="Symbol">}{</a><a id="20661" href="/Substitution/#20601" class="Bound">N</a><a id="20662" class="Symbol">}</a>
               <a id="20679" class="Symbol">{</a><a id="20680" href="/Untyped/#6623" class="Function">exts</a> <a id="20685" href="/Substitution/#20604" class="Bound">σ</a><a id="20686" class="Symbol">}{</a><a id="20688" class="Argument">ρ</a> <a id="20690" class="Symbol">=</a> <a id="20692" href="/Substitution/#20725" class="Function">ρ′</a><a id="20694" class="Symbol">}</a> <a id="20696" class="Symbol">(λ</a> <a id="20699" class="Symbol">{</a><a id="20700" href="/Substitution/#20700" class="Bound">x</a><a id="20701" class="Symbol">}</a> <a id="20703" class="Symbol">→</a> <a id="20705" href="/Substitution/#20798" class="Function">H</a> <a id="20707" class="Symbol">{</a><a id="20708" href="/Substitution/#20700" class="Bound">x</a><a id="20709" class="Symbol">}))</a>
   <a id="20716" class="Keyword">where</a>
   <a id="20725" href="/Substitution/#20725" class="Function">ρ′</a> <a id="20728" class="Symbol">:</a> <a id="20730" class="Symbol">∀</a> <a id="20732" class="Symbol">{</a><a id="20733" href="/Substitution/#20733" class="Bound">Γ</a><a id="20734" class="Symbol">}</a> <a id="20736" class="Symbol">→</a> <a id="20738" href="/Substitution/#2277" class="Function">Rename</a> <a id="20745" href="/Substitution/#20733" class="Bound">Γ</a> <a id="20747" class="Symbol">(</a><a id="20748" href="/Substitution/#20733" class="Bound">Γ</a> <a id="20750" href="/Untyped/#3018" class="InductiveConstructor Operator">,</a> <a id="20752" href="/Untyped/#2694" class="InductiveConstructor">★</a><a id="20753" class="Symbol">)</a>
   <a id="20758" href="/Substitution/#20725" class="Function">ρ′</a> <a id="20761" class="Symbol">{</a><a id="20762" href="/Untyped/#3002" class="InductiveConstructor">∅</a><a id="20763" class="Symbol">}</a> <a id="20765" class="Symbol">=</a> <a id="20767" class="Symbol">λ</a> <a id="20769" class="Symbol">()</a>
   <a id="20775" href="/Substitution/#20725" class="Function">ρ′</a> <a id="20778" class="Symbol">{</a><a id="20779" href="/Substitution/#20779" class="Bound">Γ</a> <a id="20781" href="/Untyped/#3018" class="InductiveConstructor Operator">,</a> <a id="20783" href="/Untyped/#2694" class="InductiveConstructor">★</a><a id="20784" class="Symbol">}</a> <a id="20786" class="Symbol">=</a> <a id="20788" href="/Untyped/#5845" class="Function">ext</a> <a id="20792" href="/Substitution/#20607" class="Bound">ρ</a>

   <a id="20798" href="/Substitution/#20798" class="Function">H</a> <a id="20800" class="Symbol">:</a> <a id="20802" class="Symbol">{</a><a id="20803" href="/Substitution/#20803" class="Bound">x</a> <a id="20805" class="Symbol">:</a> <a id="20807" href="/Substitution/#20593" class="Bound">Γ</a> <a id="20809" href="/Untyped/#3018" class="InductiveConstructor Operator">,</a> <a id="20811" href="/Untyped/#2694" class="InductiveConstructor">★</a> <a id="20813" href="/Untyped/#3365" class="Datatype Operator">∋</a> <a id="20815" href="/Untyped/#2694" class="InductiveConstructor">★</a><a id="20816" class="Symbol">}</a> <a id="20818" class="Symbol">→</a> <a id="20820" href="/Untyped/#6623" class="Function">exts</a> <a id="20825" class="Symbol">(</a><a id="20826" href="/Untyped/#6623" class="Function">exts</a> <a id="20831" href="/Substitution/#20604" class="Bound">σ</a><a id="20832" class="Symbol">)</a> <a id="20834" class="Symbol">(</a><a id="20835" href="/Untyped/#5845" class="Function">ext</a> <a id="20839" href="/Substitution/#20607" class="Bound">ρ</a> <a id="20841" href="/Substitution/#20803" class="Bound">x</a><a id="20842" class="Symbol">)</a> <a id="20844" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="20846" href="/Untyped/#6171" class="Function">rename</a> <a id="20853" class="Symbol">(</a><a id="20854" href="/Untyped/#5845" class="Function">ext</a> <a id="20858" href="/Substitution/#20607" class="Bound">ρ</a><a id="20859" class="Symbol">)</a> <a id="20861" class="Symbol">(</a><a id="20862" href="/Untyped/#6623" class="Function">exts</a> <a id="20867" href="/Substitution/#20604" class="Bound">σ</a> <a id="20869" href="/Substitution/#20803" class="Bound">x</a><a id="20870" class="Symbol">)</a>
   <a id="20875" href="/Substitution/#20798" class="Function">H</a> <a id="20877" class="Symbol">{</a><a id="20878" href="/Untyped/#3401" class="InductiveConstructor">Z</a><a id="20879" class="Symbol">}</a> <a id="20881" class="Symbol">=</a> <a id="20883" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a>
   <a id="20891" href="/Substitution/#20798" class="Function">H</a> <a id="20893" class="Symbol">{</a><a id="20894" href="/Untyped/#3446" class="InductiveConstructor Operator">S</a> <a id="20896" href="/Substitution/#20896" class="Bound">y</a><a id="20897" class="Symbol">}</a> <a id="20899" class="Symbol">=</a>
     <a id="20906" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4076" class="Function Operator">begin</a>
       <a id="20919" href="/Untyped/#6623" class="Function">exts</a> <a id="20924" class="Symbol">(</a><a id="20925" href="/Untyped/#6623" class="Function">exts</a> <a id="20930" href="/Substitution/#20604" class="Bound">σ</a><a id="20931" class="Symbol">)</a> <a id="20933" class="Symbol">(</a><a id="20934" href="/Untyped/#5845" class="Function">ext</a> <a id="20938" href="/Substitution/#20607" class="Bound">ρ</a> <a id="20940" class="Symbol">(</a><a id="20941" href="/Untyped/#3446" class="InductiveConstructor Operator">S</a> <a id="20943" href="/Substitution/#20896" class="Bound">y</a><a id="20944" class="Symbol">))</a>
     <a id="20952" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4134" class="Function Operator">≡⟨⟩</a>
       <a id="20963" href="/Untyped/#6171" class="Function">rename</a> <a id="20970" href="/Untyped/#3446" class="InductiveConstructor Operator">S_</a> <a id="20973" class="Symbol">(</a><a id="20974" href="/Untyped/#6623" class="Function">exts</a> <a id="20979" href="/Substitution/#20604" class="Bound">σ</a> <a id="20981" class="Symbol">(</a><a id="20982" href="/Substitution/#20607" class="Bound">ρ</a> <a id="20984" href="/Substitution/#20896" class="Bound">y</a><a id="20985" class="Symbol">))</a> 
     <a id="20994" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">≡⟨</a> <a id="20997" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#1170" class="Function">cong</a> <a id="21002" class="Symbol">(</a><a id="21003" href="/Untyped/#6171" class="Function">rename</a> <a id="21010" href="/Untyped/#3446" class="InductiveConstructor Operator">S_</a><a id="21012" class="Symbol">)</a> <a id="21014" href="/Substitution/#20610" class="Bound">r</a> <a id="21016" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">⟩</a>
       <a id="21025" href="/Untyped/#6171" class="Function">rename</a> <a id="21032" href="/Untyped/#3446" class="InductiveConstructor Operator">S_</a> <a id="21035" class="Symbol">(</a><a id="21036" href="/Untyped/#6171" class="Function">rename</a> <a id="21043" href="/Substitution/#20607" class="Bound">ρ</a> <a id="21045" class="Symbol">(</a><a id="21046" href="/Substitution/#20604" class="Bound">σ</a> <a id="21048" href="/Substitution/#20896" class="Bound">y</a><a id="21049" class="Symbol">))</a>
     <a id="21057" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">≡⟨</a> <a id="21060" href="/Substitution/#19534" class="Function">compose-rename</a> <a id="21075" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">⟩</a>
       <a id="21084" href="/Untyped/#6171" class="Function">rename</a> <a id="21091" class="Symbol">(</a><a id="21092" href="/Untyped/#3446" class="InductiveConstructor Operator">S_</a> <a id="21095" href="https://agda.github.io/agda-stdlib/v0.17/Function.html#769" class="Function Operator">∘</a> <a id="21097" href="/Substitution/#20607" class="Bound">ρ</a><a id="21098" class="Symbol">)</a> <a id="21100" class="Symbol">(</a><a id="21101" href="/Substitution/#20604" class="Bound">σ</a> <a id="21103" href="/Substitution/#20896" class="Bound">y</a><a id="21104" class="Symbol">)</a>
     <a id="21111" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">≡⟨</a> <a id="21114" href="/Substitution/#10734" class="Function">cong-rename</a> <a id="21126" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a> <a id="21131" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a> <a id="21136" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">⟩</a>
       <a id="21145" href="/Untyped/#6171" class="Function">rename</a> <a id="21152" class="Symbol">((</a><a id="21154" href="/Untyped/#5845" class="Function">ext</a> <a id="21158" href="/Substitution/#20607" class="Bound">ρ</a><a id="21159" class="Symbol">)</a> <a id="21161" href="https://agda.github.io/agda-stdlib/v0.17/Function.html#769" class="Function Operator">∘</a> <a id="21163" href="/Untyped/#3446" class="InductiveConstructor Operator">S_</a><a id="21165" class="Symbol">)</a> <a id="21167" class="Symbol">(</a><a id="21168" href="/Substitution/#20604" class="Bound">σ</a> <a id="21170" href="/Substitution/#20896" class="Bound">y</a><a id="21171" class="Symbol">)</a>
     <a id="21178" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">≡⟨</a> <a id="21181" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.Core.html#838" class="Function">sym</a> <a id="21185" href="/Substitution/#19534" class="Function">compose-rename</a> <a id="21200" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">⟩</a>
       <a id="21209" href="/Untyped/#6171" class="Function">rename</a> <a id="21216" class="Symbol">(</a><a id="21217" href="/Untyped/#5845" class="Function">ext</a> <a id="21221" href="/Substitution/#20607" class="Bound">ρ</a><a id="21222" class="Symbol">)</a> <a id="21224" class="Symbol">(</a><a id="21225" href="/Untyped/#6171" class="Function">rename</a> <a id="21232" href="/Untyped/#3446" class="InductiveConstructor Operator">S_</a> <a id="21235" class="Symbol">(</a><a id="21236" href="/Substitution/#20604" class="Bound">σ</a> <a id="21238" href="/Substitution/#20896" class="Bound">y</a><a id="21239" class="Symbol">))</a>
     <a id="21247" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4134" class="Function Operator">≡⟨⟩</a>
       <a id="21258" href="/Untyped/#6171" class="Function">rename</a> <a id="21265" class="Symbol">(</a><a id="21266" href="/Untyped/#5845" class="Function">ext</a> <a id="21270" href="/Substitution/#20607" class="Bound">ρ</a><a id="21271" class="Symbol">)</a> <a id="21273" class="Symbol">(</a><a id="21274" href="/Untyped/#6623" class="Function">exts</a> <a id="21279" href="/Substitution/#20604" class="Bound">σ</a> <a id="21281" class="Symbol">(</a><a id="21282" href="/Untyped/#3446" class="InductiveConstructor Operator">S</a> <a id="21284" href="/Substitution/#20896" class="Bound">y</a><a id="21285" class="Symbol">))</a>
     <a id="21293" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4374" class="Function Operator">∎</a>
<a id="21295" href="/Substitution/#20297" class="Function">commute-subst-rename</a> <a id="21316" class="Symbol">{</a><a id="21317" class="Argument">M</a> <a id="21319" class="Symbol">=</a> <a id="21321" href="/Substitution/#21321" class="Bound">L</a> <a id="21323" href="/Untyped/#4298" class="InductiveConstructor Operator">·</a> <a id="21325" href="/Substitution/#21325" class="Bound">M</a><a id="21326" class="Symbol">}{</a><a id="21328" class="Argument">ρ</a> <a id="21330" class="Symbol">=</a> <a id="21332" href="/Substitution/#21332" class="Bound">ρ</a><a id="21333" class="Symbol">}</a> <a id="21335" href="/Substitution/#21335" class="Bound">r</a> <a id="21337" class="Symbol">=</a>
   <a id="21342" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#1408" class="Function">cong₂</a> <a id="21348" href="/Untyped/#4298" class="InductiveConstructor Operator">_·_</a> <a id="21352" class="Symbol">(</a><a id="21353" href="/Substitution/#20297" class="Function">commute-subst-rename</a><a id="21373" class="Symbol">{</a><a id="21374" class="Argument">M</a> <a id="21376" class="Symbol">=</a> <a id="21378" href="/Substitution/#21321" class="Bound">L</a><a id="21379" class="Symbol">}{</a><a id="21381" class="Argument">ρ</a> <a id="21383" class="Symbol">=</a> <a id="21385" href="/Substitution/#21332" class="Bound">ρ</a><a id="21386" class="Symbol">}</a> <a id="21388" href="/Substitution/#21335" class="Bound">r</a><a id="21389" class="Symbol">)</a>
             <a id="21404" class="Symbol">(</a><a id="21405" href="/Substitution/#20297" class="Function">commute-subst-rename</a><a id="21425" class="Symbol">{</a><a id="21426" class="Argument">M</a> <a id="21428" class="Symbol">=</a> <a id="21430" href="/Substitution/#21325" class="Bound">M</a><a id="21431" class="Symbol">}{</a><a id="21433" class="Argument">ρ</a> <a id="21435" class="Symbol">=</a> <a id="21437" href="/Substitution/#21332" class="Bound">ρ</a><a id="21438" class="Symbol">}</a> <a id="21440" href="/Substitution/#21335" class="Bound">r</a><a id="21441" class="Symbol">)</a></pre>

<p>The proof is by induction on the term <code class="highlighter-rouge">M</code>.</p>

<ul>
  <li>
    <p>If <code class="highlighter-rouge">M</code> is a variable, then we use the premise to conclude.</p>
  </li>
  <li>
    <p>If <code class="highlighter-rouge">M ≡ ƛ N</code>, we conclude using the induction hypothesis for
<code class="highlighter-rouge">N</code>. However, to use the induction hypothesis, we must show
that</p>

    <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  exts (exts σ) (ext ρ x) ≡ rename (ext ρ) (exts σ x)
</code></pre></div>    </div>

    <p>We prove this equation by cases on x.</p>

    <ul>
      <li>
        <p>If <code class="highlighter-rouge">x = Z</code>, the two sides are equal by definition.</p>
      </li>
      <li>
        <p>If <code class="highlighter-rouge">x = S y</code>, we obtain the goal by the following equational reasoning.</p>

        <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>exts (exts σ) (ext ρ (S y))   ≡ rename S_ (exts σ (ρ y))    ≡ rename S_ (rename S_ (σ (ρ y)      (by the premise)   ≡ rename (ext ρ) (exts σ (S y))      (by compose-rename)   ≡ rename ((ext ρ) ∘ S_) (σ y)   ≡ rename (ext ρ) (rename S_ (σ y))   (by compose-rename)   ≡ rename (ext ρ) (exts σ (S y))
</code></pre></div>        </div>
      </li>
    </ul>
  </li>
  <li>
    <p>If <code class="highlighter-rouge">M</code> is an application, we obtain the goal using the induction
hypothesis for each subterm.</p>
  </li>
</ul>

<p>The last lemma needed to prove <code class="highlighter-rouge">sub-sub</code> states that the <code class="highlighter-rouge">exts</code>
function distributes with sequencing. It is a corollary of
<code class="highlighter-rouge">commute-subst-rename</code> as described below.  (It would have been nicer
to prove this directly by equational reasoning in the σ algebra, but
that would require the <code class="highlighter-rouge">sub-assoc</code> equation, whose proof depends on
<code class="highlighter-rouge">sub-sub</code>, which in turn depends on this lemma.)</p>

<pre class="Agda"><a id="exts-seq"></a><a id="22771" href="/Substitution/#22771" class="Function">exts-seq</a> <a id="22780" class="Symbol">:</a> <a id="22782" class="Symbol">∀{</a><a id="22784" href="/Substitution/#22784" class="Bound">Γ</a> <a id="22786" href="/Substitution/#22786" class="Bound">Δ</a> <a id="22788" href="/Substitution/#22788" class="Bound">Δ′</a><a id="22790" class="Symbol">}</a> <a id="22792" class="Symbol">{</a><a id="22793" href="/Substitution/#22793" class="Bound">σ₁</a> <a id="22796" class="Symbol">:</a> <a id="22798" href="/Substitution/#2506" class="Function">Subst</a> <a id="22804" href="/Substitution/#22784" class="Bound">Γ</a> <a id="22806" href="/Substitution/#22786" class="Bound">Δ</a><a id="22807" class="Symbol">}</a> <a id="22809" class="Symbol">{</a><a id="22810" href="/Substitution/#22810" class="Bound">σ₂</a> <a id="22813" class="Symbol">:</a> <a id="22815" href="/Substitution/#2506" class="Function">Subst</a> <a id="22821" href="/Substitution/#22786" class="Bound">Δ</a> <a id="22823" href="/Substitution/#22788" class="Bound">Δ′</a><a id="22825" class="Symbol">}</a>
         <a id="22836" class="Symbol">→</a> <a id="22838" class="Symbol">∀</a> <a id="22840" class="Symbol">{</a><a id="22841" href="/Substitution/#22841" class="Bound">A</a><a id="22842" class="Symbol">}</a> <a id="22844" class="Symbol">→</a> <a id="22846" class="Symbol">(</a><a id="22847" href="/Untyped/#6623" class="Function">exts</a> <a id="22852" href="/Substitution/#22793" class="Bound">σ₁</a> <a id="22855" href="/Substitution/#3945" class="Function Operator">⨟</a> <a id="22857" href="/Untyped/#6623" class="Function">exts</a> <a id="22862" href="/Substitution/#22810" class="Bound">σ₂</a><a id="22864" class="Symbol">)</a> <a id="22866" class="Symbol">{</a><a id="22867" href="/Substitution/#22841" class="Bound">A</a><a id="22868" class="Symbol">}</a> <a id="22870" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="22872" href="/Untyped/#6623" class="Function">exts</a> <a id="22877" class="Symbol">(</a><a id="22878" href="/Substitution/#22793" class="Bound">σ₁</a> <a id="22881" href="/Substitution/#3945" class="Function Operator">⨟</a> <a id="22883" href="/Substitution/#22810" class="Bound">σ₂</a><a id="22885" class="Symbol">)</a>
<a id="22887" href="/Substitution/#22771" class="Function">exts-seq</a> <a id="22896" class="Symbol">=</a> <a id="22898" href="/Substitution/#1996" class="Postulate">extensionality</a> <a id="22913" class="Symbol">λ</a> <a id="22915" href="/Substitution/#22915" class="Bound">x</a> <a id="22917" class="Symbol">→</a> <a id="22919" href="/Substitution/#22943" class="Function">lemma</a> <a id="22925" class="Symbol">{</a><a id="22926" class="Argument">x</a> <a id="22928" class="Symbol">=</a> <a id="22930" href="/Substitution/#22915" class="Bound">x</a><a id="22931" class="Symbol">}</a>
  <a id="22935" class="Keyword">where</a>
  <a id="22943" href="/Substitution/#22943" class="Function">lemma</a> <a id="22949" class="Symbol">:</a> <a id="22951" class="Symbol">∀{</a><a id="22953" href="/Substitution/#22953" class="Bound">Γ</a> <a id="22955" href="/Substitution/#22955" class="Bound">Δ</a> <a id="22957" href="/Substitution/#22957" class="Bound">Δ′</a><a id="22959" class="Symbol">}{</a><a id="22961" href="/Substitution/#22961" class="Bound">A</a><a id="22962" class="Symbol">}{</a><a id="22964" href="/Substitution/#22964" class="Bound">x</a> <a id="22966" class="Symbol">:</a> <a id="22968" href="/Substitution/#22953" class="Bound">Γ</a> <a id="22970" href="/Untyped/#3018" class="InductiveConstructor Operator">,</a> <a id="22972" href="/Untyped/#2694" class="InductiveConstructor">★</a> <a id="22974" href="/Untyped/#3365" class="Datatype Operator">∋</a> <a id="22976" href="/Substitution/#22961" class="Bound">A</a><a id="22977" class="Symbol">}</a> <a id="22979" class="Symbol">{</a><a id="22980" href="/Substitution/#22980" class="Bound">σ₁</a> <a id="22983" class="Symbol">:</a> <a id="22985" href="/Substitution/#2506" class="Function">Subst</a> <a id="22991" href="/Substitution/#22953" class="Bound">Γ</a> <a id="22993" href="/Substitution/#22955" class="Bound">Δ</a><a id="22994" class="Symbol">}{</a><a id="22996" href="/Substitution/#22996" class="Bound">σ₂</a> <a id="22999" class="Symbol">:</a> <a id="23001" href="/Substitution/#2506" class="Function">Subst</a> <a id="23007" href="/Substitution/#22955" class="Bound">Δ</a> <a id="23009" href="/Substitution/#22957" class="Bound">Δ′</a><a id="23011" class="Symbol">}</a>
     <a id="23018" class="Symbol">→</a> <a id="23020" class="Symbol">(</a><a id="23021" href="/Untyped/#6623" class="Function">exts</a> <a id="23026" href="/Substitution/#22980" class="Bound">σ₁</a> <a id="23029" href="/Substitution/#3945" class="Function Operator">⨟</a> <a id="23031" href="/Untyped/#6623" class="Function">exts</a> <a id="23036" href="/Substitution/#22996" class="Bound">σ₂</a><a id="23038" class="Symbol">)</a> <a id="23040" href="/Substitution/#22964" class="Bound">x</a> <a id="23042" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="23044" href="/Untyped/#6623" class="Function">exts</a> <a id="23049" class="Symbol">(</a><a id="23050" href="/Substitution/#22980" class="Bound">σ₁</a> <a id="23053" href="/Substitution/#3945" class="Function Operator">⨟</a> <a id="23055" href="/Substitution/#22996" class="Bound">σ₂</a><a id="23057" class="Symbol">)</a> <a id="23059" href="/Substitution/#22964" class="Bound">x</a>
  <a id="23063" href="/Substitution/#22943" class="Function">lemma</a> <a id="23069" class="Symbol">{</a><a id="23070" class="Argument">x</a> <a id="23072" class="Symbol">=</a> <a id="23074" href="/Untyped/#3401" class="InductiveConstructor">Z</a><a id="23075" class="Symbol">}</a> <a id="23077" class="Symbol">=</a> <a id="23079" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a>
  <a id="23086" href="/Substitution/#22943" class="Function">lemma</a> <a id="23092" class="Symbol">{</a><a id="23093" class="Argument">A</a> <a id="23095" class="Symbol">=</a> <a id="23097" href="/Untyped/#2694" class="InductiveConstructor">★</a><a id="23098" class="Symbol">}{</a><a id="23100" class="Argument">x</a> <a id="23102" class="Symbol">=</a> <a id="23104" href="/Untyped/#3446" class="InductiveConstructor Operator">S</a> <a id="23106" href="/Substitution/#23106" class="Bound">x</a><a id="23107" class="Symbol">}{</a><a id="23109" href="/Substitution/#23109" class="Bound">σ₁</a><a id="23111" class="Symbol">}{</a><a id="23113" href="/Substitution/#23113" class="Bound">σ₂</a><a id="23115" class="Symbol">}</a> <a id="23117" class="Symbol">=</a>
     <a id="23124" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4076" class="Function Operator">begin</a>
       <a id="23137" class="Symbol">(</a><a id="23138" href="/Untyped/#6623" class="Function">exts</a> <a id="23143" href="/Substitution/#23109" class="Bound">σ₁</a> <a id="23146" href="/Substitution/#3945" class="Function Operator">⨟</a> <a id="23148" href="/Untyped/#6623" class="Function">exts</a> <a id="23153" href="/Substitution/#23113" class="Bound">σ₂</a><a id="23155" class="Symbol">)</a> <a id="23157" class="Symbol">(</a><a id="23158" href="/Untyped/#3446" class="InductiveConstructor Operator">S</a> <a id="23160" href="/Substitution/#23106" class="Bound">x</a><a id="23161" class="Symbol">)</a>
     <a id="23168" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4134" class="Function Operator">≡⟨⟩</a>
       <a id="23179" href="/Substitution/#2663" class="Function Operator">⟪</a> <a id="23181" href="/Untyped/#6623" class="Function">exts</a> <a id="23186" href="/Substitution/#23113" class="Bound">σ₂</a> <a id="23189" href="/Substitution/#2663" class="Function Operator">⟫</a> <a id="23191" class="Symbol">(</a><a id="23192" href="/Untyped/#6171" class="Function">rename</a> <a id="23199" href="/Untyped/#3446" class="InductiveConstructor Operator">S_</a> <a id="23202" class="Symbol">(</a><a id="23203" href="/Substitution/#23109" class="Bound">σ₁</a> <a id="23206" href="/Substitution/#23106" class="Bound">x</a><a id="23207" class="Symbol">))</a>
     <a id="23215" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">≡⟨</a> <a id="23218" href="/Substitution/#20297" class="Function">commute-subst-rename</a><a id="23238" class="Symbol">{</a><a id="23239" class="Argument">M</a> <a id="23241" class="Symbol">=</a> <a id="23243" href="/Substitution/#23109" class="Bound">σ₁</a> <a id="23246" href="/Substitution/#23106" class="Bound">x</a><a id="23247" class="Symbol">}{</a><a id="23249" class="Argument">σ</a> <a id="23251" class="Symbol">=</a> <a id="23253" href="/Substitution/#23113" class="Bound">σ₂</a><a id="23255" class="Symbol">}{</a><a id="23257" class="Argument">ρ</a> <a id="23259" class="Symbol">=</a> <a id="23261" href="/Untyped/#3446" class="InductiveConstructor Operator">S_</a><a id="23263" class="Symbol">}</a> <a id="23265" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a> <a id="23270" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">⟩</a>
       <a id="23279" href="/Untyped/#6171" class="Function">rename</a> <a id="23286" href="/Untyped/#3446" class="InductiveConstructor Operator">S_</a> <a id="23289" class="Symbol">(</a><a id="23290" href="/Substitution/#2663" class="Function Operator">⟪</a> <a id="23292" href="/Substitution/#23113" class="Bound">σ₂</a> <a id="23295" href="/Substitution/#2663" class="Function Operator">⟫</a> <a id="23297" class="Symbol">(</a><a id="23298" href="/Substitution/#23109" class="Bound">σ₁</a> <a id="23301" href="/Substitution/#23106" class="Bound">x</a><a id="23302" class="Symbol">))</a>
     <a id="23310" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4134" class="Function Operator">≡⟨⟩</a>
       <a id="23321" href="/Untyped/#6171" class="Function">rename</a> <a id="23328" href="/Untyped/#3446" class="InductiveConstructor Operator">S_</a> <a id="23331" class="Symbol">((</a><a id="23333" href="/Substitution/#23109" class="Bound">σ₁</a> <a id="23336" href="/Substitution/#3945" class="Function Operator">⨟</a> <a id="23338" href="/Substitution/#23113" class="Bound">σ₂</a><a id="23340" class="Symbol">)</a> <a id="23342" href="/Substitution/#23106" class="Bound">x</a><a id="23343" class="Symbol">)</a>
     <a id="23350" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4374" class="Function Operator">∎</a></pre>

<p>The proof proceed by cases on <code class="highlighter-rouge">x</code>.</p>

<ul>
  <li>
    <p>If <code class="highlighter-rouge">x = Z</code>, the two sides are equal by the definition of <code class="highlighter-rouge">exts</code>
and sequencing.</p>
  </li>
  <li>
    <p>If <code class="highlighter-rouge">x = S x</code>, we unfold the first use of <code class="highlighter-rouge">exts</code> and sequencing, then
apply the lemma <code class="highlighter-rouge">commute-subst-rename</code>. We conclude by the
definition of sequencing.</p>
  </li>
</ul>

<p>Now we come to the proof of <code class="highlighter-rouge">sub-sub</code>, which we explain below.</p>

<pre class="Agda"><a id="sub-sub"></a><a id="23724" href="/Substitution/#23724" class="Function">sub-sub</a> <a id="23732" class="Symbol">:</a> <a id="23734" class="Symbol">∀{</a><a id="23736" href="/Substitution/#23736" class="Bound">Γ</a> <a id="23738" href="/Substitution/#23738" class="Bound">Δ</a> <a id="23740" href="/Substitution/#23740" class="Bound">Σ</a><a id="23741" class="Symbol">}{</a><a id="23743" href="/Substitution/#23743" class="Bound">A</a><a id="23744" class="Symbol">}{</a><a id="23746" href="/Substitution/#23746" class="Bound">M</a> <a id="23748" class="Symbol">:</a> <a id="23750" href="/Substitution/#23736" class="Bound">Γ</a> <a id="23752" href="/Untyped/#4150" class="Datatype Operator">⊢</a> <a id="23754" href="/Substitution/#23743" class="Bound">A</a><a id="23755" class="Symbol">}</a> <a id="23757" class="Symbol">{</a><a id="23758" href="/Substitution/#23758" class="Bound">σ₁</a> <a id="23761" class="Symbol">:</a> <a id="23763" href="/Substitution/#2506" class="Function">Subst</a> <a id="23769" href="/Substitution/#23736" class="Bound">Γ</a> <a id="23771" href="/Substitution/#23738" class="Bound">Δ</a><a id="23772" class="Symbol">}{</a><a id="23774" href="/Substitution/#23774" class="Bound">σ₂</a> <a id="23777" class="Symbol">:</a> <a id="23779" href="/Substitution/#2506" class="Function">Subst</a> <a id="23785" href="/Substitution/#23738" class="Bound">Δ</a> <a id="23787" href="/Substitution/#23740" class="Bound">Σ</a><a id="23788" class="Symbol">}</a> 
            <a id="23803" class="Symbol">→</a> <a id="23805" href="/Substitution/#2663" class="Function Operator">⟪</a> <a id="23807" href="/Substitution/#23774" class="Bound">σ₂</a> <a id="23810" href="/Substitution/#2663" class="Function Operator">⟫</a> <a id="23812" class="Symbol">(</a><a id="23813" href="/Substitution/#2663" class="Function Operator">⟪</a> <a id="23815" href="/Substitution/#23758" class="Bound">σ₁</a> <a id="23818" href="/Substitution/#2663" class="Function Operator">⟫</a> <a id="23820" href="/Substitution/#23746" class="Bound">M</a><a id="23821" class="Symbol">)</a> <a id="23823" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="23825" href="/Substitution/#2663" class="Function Operator">⟪</a> <a id="23827" href="/Substitution/#23758" class="Bound">σ₁</a> <a id="23830" href="/Substitution/#3945" class="Function Operator">⨟</a> <a id="23832" href="/Substitution/#23774" class="Bound">σ₂</a> <a id="23835" href="/Substitution/#2663" class="Function Operator">⟫</a> <a id="23837" href="/Substitution/#23746" class="Bound">M</a>
<a id="23839" href="/Substitution/#23724" class="Function">sub-sub</a> <a id="23847" class="Symbol">{</a><a id="23848" class="Argument">M</a> <a id="23850" class="Symbol">=</a> <a id="23852" href="/Untyped/#4186" class="InductiveConstructor Operator">`</a> <a id="23854" href="/Substitution/#23854" class="Bound">x</a><a id="23855" class="Symbol">}</a> <a id="23857" class="Symbol">=</a> <a id="23859" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a>
<a id="23864" href="/Substitution/#23724" class="Function">sub-sub</a> <a id="23872" class="Symbol">{</a><a id="23873" href="/Substitution/#23873" class="Bound">Γ</a><a id="23874" class="Symbol">}{</a><a id="23876" href="/Substitution/#23876" class="Bound">Δ</a><a id="23877" class="Symbol">}{</a><a id="23879" href="/Substitution/#23879" class="Bound">Σ</a><a id="23880" class="Symbol">}{</a><a id="23882" href="/Substitution/#23882" class="Bound">A</a><a id="23883" class="Symbol">}{</a><a id="23885" href="/Untyped/#4238" class="InductiveConstructor Operator">ƛ</a> <a id="23887" href="/Substitution/#23887" class="Bound">N</a><a id="23888" class="Symbol">}{</a><a id="23890" href="/Substitution/#23890" class="Bound">σ₁</a><a id="23892" class="Symbol">}{</a><a id="23894" href="/Substitution/#23894" class="Bound">σ₂</a><a id="23896" class="Symbol">}</a> <a id="23898" class="Symbol">=</a>
   <a id="23903" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4076" class="Function Operator">begin</a>
     <a id="23914" href="/Substitution/#2663" class="Function Operator">⟪</a> <a id="23916" href="/Substitution/#23894" class="Bound">σ₂</a> <a id="23919" href="/Substitution/#2663" class="Function Operator">⟫</a> <a id="23921" class="Symbol">(</a><a id="23922" href="/Substitution/#2663" class="Function Operator">⟪</a> <a id="23924" href="/Substitution/#23890" class="Bound">σ₁</a> <a id="23927" href="/Substitution/#2663" class="Function Operator">⟫</a> <a id="23929" class="Symbol">(</a><a id="23930" href="/Untyped/#4238" class="InductiveConstructor Operator">ƛ</a> <a id="23932" href="/Substitution/#23887" class="Bound">N</a><a id="23933" class="Symbol">))</a>
   <a id="23939" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4134" class="Function Operator">≡⟨⟩</a>
     <a id="23948" href="/Untyped/#4238" class="InductiveConstructor Operator">ƛ</a> <a id="23950" href="/Substitution/#2663" class="Function Operator">⟪</a> <a id="23952" href="/Untyped/#6623" class="Function">exts</a> <a id="23957" href="/Substitution/#23894" class="Bound">σ₂</a> <a id="23960" href="/Substitution/#2663" class="Function Operator">⟫</a> <a id="23962" class="Symbol">(</a><a id="23963" href="/Substitution/#2663" class="Function Operator">⟪</a> <a id="23965" href="/Untyped/#6623" class="Function">exts</a> <a id="23970" href="/Substitution/#23890" class="Bound">σ₁</a> <a id="23973" href="/Substitution/#2663" class="Function Operator">⟫</a> <a id="23975" href="/Substitution/#23887" class="Bound">N</a><a id="23976" class="Symbol">)</a>
   <a id="23981" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">≡⟨</a> <a id="23984" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#1170" class="Function">cong</a> <a id="23989" href="/Untyped/#4238" class="InductiveConstructor Operator">ƛ_</a> <a id="23992" class="Symbol">(</a><a id="23993" href="/Substitution/#23724" class="Function">sub-sub</a><a id="24000" class="Symbol">{</a><a id="24001" class="Argument">M</a> <a id="24003" class="Symbol">=</a> <a id="24005" href="/Substitution/#23887" class="Bound">N</a><a id="24006" class="Symbol">}{</a><a id="24008" class="Argument">σ₁</a> <a id="24011" class="Symbol">=</a> <a id="24013" href="/Untyped/#6623" class="Function">exts</a> <a id="24018" href="/Substitution/#23890" class="Bound">σ₁</a><a id="24020" class="Symbol">}{</a><a id="24022" class="Argument">σ₂</a> <a id="24025" class="Symbol">=</a> <a id="24027" href="/Untyped/#6623" class="Function">exts</a> <a id="24032" href="/Substitution/#23894" class="Bound">σ₂</a><a id="24034" class="Symbol">})</a> <a id="24037" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">⟩</a>
     <a id="24044" href="/Untyped/#4238" class="InductiveConstructor Operator">ƛ</a> <a id="24046" href="/Substitution/#2663" class="Function Operator">⟪</a> <a id="24048" href="/Untyped/#6623" class="Function">exts</a> <a id="24053" href="/Substitution/#23890" class="Bound">σ₁</a> <a id="24056" href="/Substitution/#3945" class="Function Operator">⨟</a> <a id="24058" href="/Untyped/#6623" class="Function">exts</a> <a id="24063" href="/Substitution/#23894" class="Bound">σ₂</a> <a id="24066" href="/Substitution/#2663" class="Function Operator">⟫</a> <a id="24068" href="/Substitution/#23887" class="Bound">N</a>
   <a id="24073" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">≡⟨</a> <a id="24076" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#1170" class="Function">cong</a> <a id="24081" href="/Untyped/#4238" class="InductiveConstructor Operator">ƛ_</a> <a id="24084" class="Symbol">(</a><a id="24085" href="/Substitution/#11568" class="Function">cong-sub</a><a id="24093" class="Symbol">{</a><a id="24094" class="Argument">M</a> <a id="24096" class="Symbol">=</a> <a id="24098" href="/Substitution/#23887" class="Bound">N</a><a id="24099" class="Symbol">}</a> <a id="24101" class="Symbol">(λ</a> <a id="24104" class="Symbol">{</a><a id="24105" href="/Substitution/#24105" class="Bound">A</a><a id="24106" class="Symbol">}</a> <a id="24108" class="Symbol">→</a> <a id="24110" href="/Substitution/#22771" class="Function">exts-seq</a><a id="24118" class="Symbol">)</a> <a id="24120" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a><a id="24124" class="Symbol">)</a> <a id="24126" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">⟩</a>
     <a id="24133" href="/Untyped/#4238" class="InductiveConstructor Operator">ƛ</a> <a id="24135" href="/Substitution/#2663" class="Function Operator">⟪</a> <a id="24137" href="/Untyped/#6623" class="Function">exts</a> <a id="24142" class="Symbol">(</a> <a id="24144" href="/Substitution/#23890" class="Bound">σ₁</a> <a id="24147" href="/Substitution/#3945" class="Function Operator">⨟</a> <a id="24149" href="/Substitution/#23894" class="Bound">σ₂</a><a id="24151" class="Symbol">)</a> <a id="24153" href="/Substitution/#2663" class="Function Operator">⟫</a> <a id="24155" href="/Substitution/#23887" class="Bound">N</a>
   <a id="24160" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4374" class="Function Operator">∎</a>
<a id="24162" href="/Substitution/#23724" class="Function">sub-sub</a> <a id="24170" class="Symbol">{</a><a id="24171" class="Argument">M</a> <a id="24173" class="Symbol">=</a> <a id="24175" href="/Substitution/#24175" class="Bound">L</a> <a id="24177" href="/Untyped/#4298" class="InductiveConstructor Operator">·</a> <a id="24179" href="/Substitution/#24179" class="Bound">M</a><a id="24180" class="Symbol">}</a> <a id="24182" class="Symbol">=</a> <a id="24184" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#1408" class="Function">cong₂</a> <a id="24190" href="/Untyped/#4298" class="InductiveConstructor Operator">_·_</a> <a id="24194" class="Symbol">(</a><a id="24195" href="/Substitution/#23724" class="Function">sub-sub</a><a id="24202" class="Symbol">{</a><a id="24203" class="Argument">M</a> <a id="24205" class="Symbol">=</a> <a id="24207" href="/Substitution/#24175" class="Bound">L</a><a id="24208" class="Symbol">})</a> <a id="24211" class="Symbol">(</a><a id="24212" href="/Substitution/#23724" class="Function">sub-sub</a><a id="24219" class="Symbol">{</a><a id="24220" class="Argument">M</a> <a id="24222" class="Symbol">=</a> <a id="24224" href="/Substitution/#24179" class="Bound">M</a><a id="24225" class="Symbol">})</a></pre>

<p>We proceed by induction on the term <code class="highlighter-rouge">M</code>.</p>

<ul>
  <li>
    <p>If <code class="highlighter-rouge">M = x</code>, then both sides are equal to <code class="highlighter-rouge">σ₂ (σ₁ x)</code>.</p>
  </li>
  <li>
    <p>If <code class="highlighter-rouge">M = ƛ N</code>, we first use the induction hypothesis to show that</p>

    <p>ƛ ⟪ exts σ₂ ⟫ (⟪ exts σ₁ ⟫ N) ≡ ƛ ⟪ exts σ₁ ⨟ exts σ₂ ⟫ N</p>

    <p>and then use the lemma <code class="highlighter-rouge">exts-seq</code> to show</p>

    <p>ƛ ⟪ exts σ₁ ⨟ exts σ₂ ⟫ N ≡ ƛ ⟪ exts ( σ₁ ⨟ σ₂) ⟫ N</p>
  </li>
  <li>
    <p>If <code class="highlighter-rouge">M</code> is an application, we use the induction hypothesis
for both subterms.</p>
  </li>
</ul>

<p>The following corollary of <code class="highlighter-rouge">sub-sub</code> specializes the first
substitution to a renaming.</p>

<pre class="Agda"><a id="rename-subst"></a><a id="24758" href="/Substitution/#24758" class="Function">rename-subst</a> <a id="24771" class="Symbol">:</a> <a id="24773" class="Symbol">∀{</a><a id="24775" href="/Substitution/#24775" class="Bound">Γ</a> <a id="24777" href="/Substitution/#24777" class="Bound">Δ</a> <a id="24779" href="/Substitution/#24779" class="Bound">Δ′</a><a id="24781" class="Symbol">}{</a><a id="24783" href="/Substitution/#24783" class="Bound">M</a> <a id="24785" class="Symbol">:</a> <a id="24787" href="/Substitution/#24775" class="Bound">Γ</a> <a id="24789" href="/Untyped/#4150" class="Datatype Operator">⊢</a> <a id="24791" href="/Untyped/#2694" class="InductiveConstructor">★</a><a id="24792" class="Symbol">}{</a><a id="24794" href="/Substitution/#24794" class="Bound">ρ</a> <a id="24796" class="Symbol">:</a> <a id="24798" href="/Substitution/#2277" class="Function">Rename</a> <a id="24805" href="/Substitution/#24775" class="Bound">Γ</a> <a id="24807" href="/Substitution/#24777" class="Bound">Δ</a><a id="24808" class="Symbol">}{</a><a id="24810" href="/Substitution/#24810" class="Bound">σ</a> <a id="24812" class="Symbol">:</a> <a id="24814" href="/Substitution/#2506" class="Function">Subst</a> <a id="24820" href="/Substitution/#24777" class="Bound">Δ</a> <a id="24822" href="/Substitution/#24779" class="Bound">Δ′</a><a id="24824" class="Symbol">}</a>
             <a id="24839" class="Symbol">→</a> <a id="24841" href="/Substitution/#2663" class="Function Operator">⟪</a> <a id="24843" href="/Substitution/#24810" class="Bound">σ</a> <a id="24845" href="/Substitution/#2663" class="Function Operator">⟫</a> <a id="24847" class="Symbol">(</a><a id="24848" href="/Untyped/#6171" class="Function">rename</a> <a id="24855" href="/Substitution/#24794" class="Bound">ρ</a> <a id="24857" href="/Substitution/#24783" class="Bound">M</a><a id="24858" class="Symbol">)</a> <a id="24860" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="24862" href="/Substitution/#2663" class="Function Operator">⟪</a> <a id="24864" href="/Substitution/#24810" class="Bound">σ</a> <a id="24866" href="https://agda.github.io/agda-stdlib/v0.17/Function.html#769" class="Function Operator">∘</a> <a id="24868" href="/Substitution/#24794" class="Bound">ρ</a> <a id="24870" href="/Substitution/#2663" class="Function Operator">⟫</a> <a id="24872" href="/Substitution/#24783" class="Bound">M</a>
<a id="24874" href="/Substitution/#24758" class="Function">rename-subst</a> <a id="24887" class="Symbol">{</a><a id="24888" href="/Substitution/#24888" class="Bound">Γ</a><a id="24889" class="Symbol">}{</a><a id="24891" href="/Substitution/#24891" class="Bound">Δ</a><a id="24892" class="Symbol">}{</a><a id="24894" href="/Substitution/#24894" class="Bound">Δ′</a><a id="24896" class="Symbol">}{</a><a id="24898" href="/Substitution/#24898" class="Bound">M</a><a id="24899" class="Symbol">}{</a><a id="24901" href="/Substitution/#24901" class="Bound">ρ</a><a id="24902" class="Symbol">}{</a><a id="24904" href="/Substitution/#24904" class="Bound">σ</a><a id="24905" class="Symbol">}</a> <a id="24907" class="Symbol">=</a>
   <a id="24912" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4076" class="Function Operator">begin</a>
     <a id="24923" href="/Substitution/#2663" class="Function Operator">⟪</a> <a id="24925" href="/Substitution/#24904" class="Bound">σ</a> <a id="24927" href="/Substitution/#2663" class="Function Operator">⟫</a> <a id="24929" class="Symbol">(</a><a id="24930" href="/Untyped/#6171" class="Function">rename</a> <a id="24937" href="/Substitution/#24901" class="Bound">ρ</a> <a id="24939" href="/Substitution/#24898" class="Bound">M</a><a id="24940" class="Symbol">)</a>
   <a id="24945" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">≡⟨</a> <a id="24948" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#1170" class="Function">cong</a> <a id="24953" href="/Substitution/#2663" class="Function Operator">⟪</a> <a id="24955" href="/Substitution/#24904" class="Bound">σ</a> <a id="24957" href="/Substitution/#2663" class="Function Operator">⟫</a> <a id="24959" class="Symbol">(</a><a id="24960" href="/Substitution/#14149" class="Function">rename-subst-ren</a><a id="24976" class="Symbol">{</a><a id="24977" class="Argument">M</a> <a id="24979" class="Symbol">=</a> <a id="24981" href="/Substitution/#24898" class="Bound">M</a><a id="24982" class="Symbol">})</a> <a id="24985" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">⟩</a>
     <a id="24992" href="/Substitution/#2663" class="Function Operator">⟪</a> <a id="24994" href="/Substitution/#24904" class="Bound">σ</a> <a id="24996" href="/Substitution/#2663" class="Function Operator">⟫</a> <a id="24998" class="Symbol">(</a><a id="24999" href="/Substitution/#2663" class="Function Operator">⟪</a> <a id="25001" href="/Substitution/#6703" class="Function">ren</a> <a id="25005" href="/Substitution/#24901" class="Bound">ρ</a> <a id="25007" href="/Substitution/#2663" class="Function Operator">⟫</a> <a id="25009" href="/Substitution/#24898" class="Bound">M</a><a id="25010" class="Symbol">)</a>
   <a id="25015" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">≡⟨</a> <a id="25018" href="/Substitution/#23724" class="Function">sub-sub</a><a id="25025" class="Symbol">{</a><a id="25026" class="Argument">M</a> <a id="25028" class="Symbol">=</a> <a id="25030" href="/Substitution/#24898" class="Bound">M</a><a id="25031" class="Symbol">}</a> <a id="25033" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">⟩</a>
     <a id="25040" href="/Substitution/#2663" class="Function Operator">⟪</a> <a id="25042" href="/Substitution/#6703" class="Function">ren</a> <a id="25046" href="/Substitution/#24901" class="Bound">ρ</a> <a id="25048" href="/Substitution/#3945" class="Function Operator">⨟</a> <a id="25050" href="/Substitution/#24904" class="Bound">σ</a> <a id="25052" href="/Substitution/#2663" class="Function Operator">⟫</a> <a id="25054" href="/Substitution/#24898" class="Bound">M</a>
   <a id="25059" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4134" class="Function Operator">≡⟨⟩</a>
     <a id="25068" href="/Substitution/#2663" class="Function Operator">⟪</a> <a id="25070" href="/Substitution/#24904" class="Bound">σ</a> <a id="25072" href="https://agda.github.io/agda-stdlib/v0.17/Function.html#769" class="Function Operator">∘</a> <a id="25074" href="/Substitution/#24901" class="Bound">ρ</a> <a id="25076" href="/Substitution/#2663" class="Function Operator">⟫</a> <a id="25078" href="/Substitution/#24898" class="Bound">M</a>
   <a id="25083" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4374" class="Function Operator">∎</a></pre>

<h2 id="proof-of-sub-assoc">Proof of sub-assoc</h2>

<p>The proof of <code class="highlighter-rouge">sub-assoc</code> follows directly from <code class="highlighter-rouge">sub-sub</code> and the
definition of sequencing.</p>

<pre class="Agda"><a id="sub-assoc"></a><a id="25226" href="/Substitution/#25226" class="Function">sub-assoc</a> <a id="25236" class="Symbol">:</a> <a id="25238" class="Symbol">∀{</a><a id="25240" href="/Substitution/#25240" class="Bound">Γ</a> <a id="25242" href="/Substitution/#25242" class="Bound">Δ</a> <a id="25244" href="/Substitution/#25244" class="Bound">Σ</a> <a id="25246" href="/Substitution/#25246" class="Bound">Ψ</a> <a id="25248" class="Symbol">:</a> <a id="25250" href="/Untyped/#2980" class="Datatype">Context</a><a id="25257" class="Symbol">}</a> <a id="25259" class="Symbol">{</a><a id="25260" href="/Substitution/#25260" class="Bound">σ</a> <a id="25262" class="Symbol">:</a> <a id="25264" href="/Substitution/#2506" class="Function">Subst</a> <a id="25270" href="/Substitution/#25240" class="Bound">Γ</a> <a id="25272" href="/Substitution/#25242" class="Bound">Δ</a><a id="25273" class="Symbol">}</a> <a id="25275" class="Symbol">{</a><a id="25276" href="/Substitution/#25276" class="Bound">τ</a> <a id="25278" class="Symbol">:</a> <a id="25280" href="/Substitution/#2506" class="Function">Subst</a> <a id="25286" href="/Substitution/#25242" class="Bound">Δ</a> <a id="25288" href="/Substitution/#25244" class="Bound">Σ</a><a id="25289" class="Symbol">}</a>
             <a id="25304" class="Symbol">{</a><a id="25305" href="/Substitution/#25305" class="Bound">θ</a> <a id="25307" class="Symbol">:</a> <a id="25309" href="/Substitution/#2506" class="Function">Subst</a> <a id="25315" href="/Substitution/#25244" class="Bound">Σ</a> <a id="25317" href="/Substitution/#25246" class="Bound">Ψ</a><a id="25318" class="Symbol">}</a>
          <a id="25330" class="Symbol">→</a> <a id="25332" class="Symbol">∀{</a><a id="25334" href="/Substitution/#25334" class="Bound">A</a><a id="25335" class="Symbol">}</a> <a id="25337" class="Symbol">→</a> <a id="25339" class="Symbol">(</a><a id="25340" href="/Substitution/#25260" class="Bound">σ</a> <a id="25342" href="/Substitution/#3945" class="Function Operator">⨟</a> <a id="25344" href="/Substitution/#25276" class="Bound">τ</a><a id="25345" class="Symbol">)</a> <a id="25347" href="/Substitution/#3945" class="Function Operator">⨟</a> <a id="25349" href="/Substitution/#25305" class="Bound">θ</a> <a id="25351" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="25353" class="Symbol">(</a><a id="25354" href="/Substitution/#25260" class="Bound">σ</a> <a id="25356" href="/Substitution/#3945" class="Function Operator">⨟</a> <a id="25358" href="/Substitution/#25276" class="Bound">τ</a> <a id="25360" href="/Substitution/#3945" class="Function Operator">⨟</a> <a id="25362" href="/Substitution/#25305" class="Bound">θ</a><a id="25363" class="Symbol">)</a> <a id="25365" class="Symbol">{</a><a id="25366" href="/Substitution/#25334" class="Bound">A</a><a id="25367" class="Symbol">}</a>
<a id="25369" href="/Substitution/#25226" class="Function">sub-assoc</a> <a id="25379" class="Symbol">{</a><a id="25380" href="/Substitution/#25380" class="Bound">Γ</a><a id="25381" class="Symbol">}{</a><a id="25383" href="/Substitution/#25383" class="Bound">Δ</a><a id="25384" class="Symbol">}{</a><a id="25386" href="/Substitution/#25386" class="Bound">Σ</a><a id="25387" class="Symbol">}{</a><a id="25389" href="/Substitution/#25389" class="Bound">Ψ</a><a id="25390" class="Symbol">}{</a><a id="25392" href="/Substitution/#25392" class="Bound">σ</a><a id="25393" class="Symbol">}{</a><a id="25395" href="/Substitution/#25395" class="Bound">τ</a><a id="25396" class="Symbol">}{</a><a id="25398" href="/Substitution/#25398" class="Bound">θ</a><a id="25399" class="Symbol">}{</a><a id="25401" href="/Substitution/#25401" class="Bound">A</a><a id="25402" class="Symbol">}</a> <a id="25404" class="Symbol">=</a> <a id="25406" href="/Substitution/#1996" class="Postulate">extensionality</a> <a id="25421" class="Symbol">λ</a> <a id="25423" href="/Substitution/#25423" class="Bound">x</a> <a id="25425" class="Symbol">→</a> <a id="25427" href="/Substitution/#25450" class="Function">lemma</a><a id="25432" class="Symbol">{</a><a id="25433" class="Argument">x</a> <a id="25435" class="Symbol">=</a> <a id="25437" href="/Substitution/#25423" class="Bound">x</a><a id="25438" class="Symbol">}</a>
  <a id="25442" class="Keyword">where</a>
  <a id="25450" href="/Substitution/#25450" class="Function">lemma</a> <a id="25456" class="Symbol">:</a> <a id="25458" class="Symbol">∀</a> <a id="25460" class="Symbol">{</a><a id="25461" href="/Substitution/#25461" class="Bound">x</a> <a id="25463" class="Symbol">:</a> <a id="25465" href="/Substitution/#25380" class="Bound">Γ</a> <a id="25467" href="/Untyped/#3365" class="Datatype Operator">∋</a> <a id="25469" href="/Substitution/#25401" class="Bound">A</a><a id="25470" class="Symbol">}</a> <a id="25472" class="Symbol">→</a> <a id="25474" class="Symbol">((</a><a id="25476" href="/Substitution/#25392" class="Bound">σ</a> <a id="25478" href="/Substitution/#3945" class="Function Operator">⨟</a> <a id="25480" href="/Substitution/#25395" class="Bound">τ</a><a id="25481" class="Symbol">)</a> <a id="25483" href="/Substitution/#3945" class="Function Operator">⨟</a> <a id="25485" href="/Substitution/#25398" class="Bound">θ</a><a id="25486" class="Symbol">)</a> <a id="25488" href="/Substitution/#25461" class="Bound">x</a> <a id="25490" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="25492" class="Symbol">(</a><a id="25493" href="/Substitution/#25392" class="Bound">σ</a> <a id="25495" href="/Substitution/#3945" class="Function Operator">⨟</a> <a id="25497" href="/Substitution/#25395" class="Bound">τ</a> <a id="25499" href="/Substitution/#3945" class="Function Operator">⨟</a> <a id="25501" href="/Substitution/#25398" class="Bound">θ</a><a id="25502" class="Symbol">)</a> <a id="25504" href="/Substitution/#25461" class="Bound">x</a>
  <a id="25508" href="/Substitution/#25450" class="Function">lemma</a> <a id="25514" class="Symbol">{</a><a id="25515" href="/Substitution/#25515" class="Bound">x</a><a id="25516" class="Symbol">}</a> <a id="25518" class="Symbol">=</a>
      <a id="25526" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4076" class="Function Operator">begin</a>
        <a id="25540" class="Symbol">((</a><a id="25542" href="/Substitution/#25392" class="Bound">σ</a> <a id="25544" href="/Substitution/#3945" class="Function Operator">⨟</a> <a id="25546" href="/Substitution/#25395" class="Bound">τ</a><a id="25547" class="Symbol">)</a> <a id="25549" href="/Substitution/#3945" class="Function Operator">⨟</a> <a id="25551" href="/Substitution/#25398" class="Bound">θ</a><a id="25552" class="Symbol">)</a> <a id="25554" href="/Substitution/#25515" class="Bound">x</a>
      <a id="25562" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4134" class="Function Operator">≡⟨⟩</a>
        <a id="25574" href="/Substitution/#2663" class="Function Operator">⟪</a> <a id="25576" href="/Substitution/#25398" class="Bound">θ</a> <a id="25578" href="/Substitution/#2663" class="Function Operator">⟫</a> <a id="25580" class="Symbol">(</a><a id="25581" href="/Substitution/#2663" class="Function Operator">⟪</a> <a id="25583" href="/Substitution/#25395" class="Bound">τ</a> <a id="25585" href="/Substitution/#2663" class="Function Operator">⟫</a> <a id="25587" class="Symbol">(</a><a id="25588" href="/Substitution/#25392" class="Bound">σ</a> <a id="25590" href="/Substitution/#25515" class="Bound">x</a><a id="25591" class="Symbol">))</a>
      <a id="25600" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">≡⟨</a> <a id="25603" href="/Substitution/#23724" class="Function">sub-sub</a><a id="25610" class="Symbol">{</a><a id="25611" class="Argument">M</a> <a id="25613" class="Symbol">=</a> <a id="25615" href="/Substitution/#25392" class="Bound">σ</a> <a id="25617" href="/Substitution/#25515" class="Bound">x</a><a id="25618" class="Symbol">}</a> <a id="25620" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">⟩</a>
        <a id="25630" href="/Substitution/#2663" class="Function Operator">⟪</a> <a id="25632" href="/Substitution/#25395" class="Bound">τ</a> <a id="25634" href="/Substitution/#3945" class="Function Operator">⨟</a> <a id="25636" href="/Substitution/#25398" class="Bound">θ</a> <a id="25638" href="/Substitution/#2663" class="Function Operator">⟫</a> <a id="25640" class="Symbol">(</a><a id="25641" href="/Substitution/#25392" class="Bound">σ</a> <a id="25643" href="/Substitution/#25515" class="Bound">x</a><a id="25644" class="Symbol">)</a>
      <a id="25652" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4134" class="Function Operator">≡⟨⟩</a>
        <a id="25664" class="Symbol">(</a><a id="25665" href="/Substitution/#25392" class="Bound">σ</a> <a id="25667" href="/Substitution/#3945" class="Function Operator">⨟</a> <a id="25669" href="/Substitution/#25395" class="Bound">τ</a> <a id="25671" href="/Substitution/#3945" class="Function Operator">⨟</a> <a id="25673" href="/Substitution/#25398" class="Bound">θ</a><a id="25674" class="Symbol">)</a> <a id="25676" href="/Substitution/#25515" class="Bound">x</a>
      <a id="25684" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4374" class="Function Operator">∎</a></pre>

<h2 id="proof-of-subst-zero-exts-cons">Proof of subst-zero-exts-cons</h2>

<p>The last equation we needed to prove <code class="highlighter-rouge">subst-zero-exts-cons</code> was
<code class="highlighter-rouge">sub-assoc</code>, so we can now go ahead with its proof.  We simply apply
the equations for <code class="highlighter-rouge">exts</code> and <code class="highlighter-rouge">subst-zero</code> and then apply the σ algebra
equation to arrive at the normal form <code class="highlighter-rouge">M • σ</code>.</p>

<pre class="Agda"><a id="subst-zero-exts-cons"></a><a id="25997" href="/Substitution/#25997" class="Function">subst-zero-exts-cons</a> <a id="26018" class="Symbol">:</a> <a id="26020" class="Symbol">∀{</a><a id="26022" href="/Substitution/#26022" class="Bound">Γ</a> <a id="26024" href="/Substitution/#26024" class="Bound">Δ</a><a id="26025" class="Symbol">}{</a><a id="26027" href="/Substitution/#26027" class="Bound">σ</a> <a id="26029" class="Symbol">:</a> <a id="26031" href="/Substitution/#2506" class="Function">Subst</a> <a id="26037" href="/Substitution/#26022" class="Bound">Γ</a> <a id="26039" href="/Substitution/#26024" class="Bound">Δ</a><a id="26040" class="Symbol">}{</a><a id="26042" href="/Substitution/#26042" class="Bound">B</a><a id="26043" class="Symbol">}{</a><a id="26045" href="/Substitution/#26045" class="Bound">M</a> <a id="26047" class="Symbol">:</a> <a id="26049" href="/Substitution/#26024" class="Bound">Δ</a> <a id="26051" href="/Untyped/#4150" class="Datatype Operator">⊢</a> <a id="26053" href="/Substitution/#26042" class="Bound">B</a><a id="26054" class="Symbol">}{</a><a id="26056" href="/Substitution/#26056" class="Bound">A</a><a id="26057" class="Symbol">}</a>
                     <a id="26080" class="Symbol">→</a> <a id="26082" href="/Untyped/#6623" class="Function">exts</a> <a id="26087" href="/Substitution/#26027" class="Bound">σ</a> <a id="26089" href="/Substitution/#3945" class="Function Operator">⨟</a> <a id="26091" href="/Untyped/#7359" class="Function">subst-zero</a> <a id="26102" href="/Substitution/#26045" class="Bound">M</a> <a id="26104" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="26106" class="Symbol">(</a><a id="26107" href="/Substitution/#26045" class="Bound">M</a> <a id="26109" href="/Substitution/#3592" class="Function Operator">•</a> <a id="26111" href="/Substitution/#26027" class="Bound">σ</a><a id="26112" class="Symbol">)</a> <a id="26114" class="Symbol">{</a><a id="26115" href="/Substitution/#26056" class="Bound">A</a><a id="26116" class="Symbol">}</a>
<a id="26118" href="/Substitution/#25997" class="Function">subst-zero-exts-cons</a> <a id="26139" class="Symbol">{</a><a id="26140" href="/Substitution/#26140" class="Bound">Γ</a><a id="26141" class="Symbol">}{</a><a id="26143" href="/Substitution/#26143" class="Bound">Δ</a><a id="26144" class="Symbol">}{</a><a id="26146" href="/Substitution/#26146" class="Bound">σ</a><a id="26147" class="Symbol">}{</a><a id="26149" href="/Substitution/#26149" class="Bound">B</a><a id="26150" class="Symbol">}{</a><a id="26152" href="/Substitution/#26152" class="Bound">M</a><a id="26153" class="Symbol">}{</a><a id="26155" href="/Substitution/#26155" class="Bound">A</a><a id="26156" class="Symbol">}</a> <a id="26158" class="Symbol">=</a>
    <a id="26164" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4076" class="Function Operator">begin</a>
      <a id="26176" href="/Untyped/#6623" class="Function">exts</a> <a id="26181" href="/Substitution/#26146" class="Bound">σ</a> <a id="26183" href="/Substitution/#3945" class="Function Operator">⨟</a> <a id="26185" href="/Untyped/#7359" class="Function">subst-zero</a> <a id="26196" href="/Substitution/#26152" class="Bound">M</a>
    <a id="26202" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">≡⟨</a> <a id="26205" href="/Substitution/#12701" class="Function">cong-seq</a> <a id="26214" href="/Substitution/#15561" class="Function">exts-cons-shift</a> <a id="26230" href="/Substitution/#16375" class="Function">subst-Z-cons-ids</a> <a id="26247" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">⟩</a>
      <a id="26255" class="Symbol">(</a><a id="26256" href="/Untyped/#4186" class="InductiveConstructor Operator">`</a> <a id="26258" href="/Untyped/#3401" class="InductiveConstructor">Z</a> <a id="26260" href="/Substitution/#3592" class="Function Operator">•</a> <a id="26262" class="Symbol">(</a><a id="26263" href="/Substitution/#26146" class="Bound">σ</a> <a id="26265" href="/Substitution/#3945" class="Function Operator">⨟</a> <a id="26267" href="/Substitution/#3334" class="Function">↑</a><a id="26268" class="Symbol">))</a> <a id="26271" href="/Substitution/#3945" class="Function Operator">⨟</a> <a id="26273" class="Symbol">(</a><a id="26274" href="/Substitution/#26152" class="Bound">M</a> <a id="26276" href="/Substitution/#3592" class="Function Operator">•</a> <a id="26278" href="/Substitution/#3179" class="Function">ids</a><a id="26281" class="Symbol">)</a>
    <a id="26287" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">≡⟨</a> <a id="26290" href="/Substitution/#9382" class="Function">sub-dist</a> <a id="26299" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">⟩</a>
      <a id="26307" class="Symbol">(</a><a id="26308" href="/Substitution/#2663" class="Function Operator">⟪</a> <a id="26310" href="/Substitution/#26152" class="Bound">M</a> <a id="26312" href="/Substitution/#3592" class="Function Operator">•</a> <a id="26314" href="/Substitution/#3179" class="Function">ids</a> <a id="26318" href="/Substitution/#2663" class="Function Operator">⟫</a> <a id="26320" class="Symbol">(</a><a id="26321" href="/Untyped/#4186" class="InductiveConstructor Operator">`</a> <a id="26323" href="/Untyped/#3401" class="InductiveConstructor">Z</a><a id="26324" class="Symbol">))</a> <a id="26327" href="/Substitution/#3592" class="Function Operator">•</a> <a id="26329" class="Symbol">((</a><a id="26331" href="/Substitution/#26146" class="Bound">σ</a> <a id="26333" href="/Substitution/#3945" class="Function Operator">⨟</a> <a id="26335" href="/Substitution/#3334" class="Function">↑</a><a id="26336" class="Symbol">)</a> <a id="26338" href="/Substitution/#3945" class="Function Operator">⨟</a> <a id="26340" class="Symbol">(</a><a id="26341" href="/Substitution/#26152" class="Bound">M</a> <a id="26343" href="/Substitution/#3592" class="Function Operator">•</a> <a id="26345" href="/Substitution/#3179" class="Function">ids</a><a id="26348" class="Symbol">))</a>
    <a id="26355" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">≡⟨</a> <a id="26358" href="/Substitution/#12340" class="Function">cong-cons</a> <a id="26368" class="Symbol">(</a><a id="26369" href="/Substitution/#8484" class="Function">sub-head</a><a id="26377" class="Symbol">{</a><a id="26378" class="Argument">σ</a> <a id="26380" class="Symbol">=</a> <a id="26382" href="/Substitution/#3179" class="Function">ids</a><a id="26385" class="Symbol">})</a> <a id="26388" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a> <a id="26393" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">⟩</a>
      <a id="26401" href="/Substitution/#26152" class="Bound">M</a> <a id="26403" href="/Substitution/#3592" class="Function Operator">•</a> <a id="26405" class="Symbol">((</a><a id="26407" href="/Substitution/#26146" class="Bound">σ</a> <a id="26409" href="/Substitution/#3945" class="Function Operator">⨟</a> <a id="26411" href="/Substitution/#3334" class="Function">↑</a><a id="26412" class="Symbol">)</a> <a id="26414" href="/Substitution/#3945" class="Function Operator">⨟</a> <a id="26416" class="Symbol">(</a><a id="26417" href="/Substitution/#26152" class="Bound">M</a> <a id="26419" href="/Substitution/#3592" class="Function Operator">•</a> <a id="26421" href="/Substitution/#3179" class="Function">ids</a><a id="26424" class="Symbol">))</a>
    <a id="26431" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">≡⟨</a> <a id="26434" href="/Substitution/#12340" class="Function">cong-cons</a> <a id="26444" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a> <a id="26449" class="Symbol">(</a><a id="26450" href="/Substitution/#25226" class="Function">sub-assoc</a><a id="26459" class="Symbol">{</a><a id="26460" class="Argument">σ</a> <a id="26462" class="Symbol">=</a> <a id="26464" href="/Substitution/#26146" class="Bound">σ</a><a id="26465" class="Symbol">})</a> <a id="26468" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">⟩</a>
      <a id="26476" href="/Substitution/#26152" class="Bound">M</a> <a id="26478" href="/Substitution/#3592" class="Function Operator">•</a> <a id="26480" class="Symbol">(</a><a id="26481" href="/Substitution/#26146" class="Bound">σ</a> <a id="26483" href="/Substitution/#3945" class="Function Operator">⨟</a> <a id="26485" class="Symbol">(</a><a id="26486" href="/Substitution/#3334" class="Function">↑</a> <a id="26488" href="/Substitution/#3945" class="Function Operator">⨟</a> <a id="26490" class="Symbol">(</a><a id="26491" href="/Substitution/#26152" class="Bound">M</a> <a id="26493" href="/Substitution/#3592" class="Function Operator">•</a> <a id="26495" href="/Substitution/#3179" class="Function">ids</a><a id="26498" class="Symbol">)))</a>
    <a id="26506" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">≡⟨</a> <a id="26509" href="/Substitution/#12340" class="Function">cong-cons</a> <a id="26519" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a> <a id="26524" class="Symbol">(</a><a id="26525" href="/Substitution/#12701" class="Function">cong-seq</a><a id="26533" class="Symbol">{</a><a id="26534" class="Argument">σ</a> <a id="26536" class="Symbol">=</a> <a id="26538" href="/Substitution/#26146" class="Bound">σ</a><a id="26539" class="Symbol">}</a> <a id="26541" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a> <a id="26546" class="Symbol">(</a><a id="26547" href="/Substitution/#8606" class="Function">sub-tail</a><a id="26555" class="Symbol">{</a><a id="26556" class="Argument">M</a> <a id="26558" class="Symbol">=</a> <a id="26560" href="/Substitution/#26152" class="Bound">M</a><a id="26561" class="Symbol">}{</a><a id="26563" class="Argument">σ</a> <a id="26565" class="Symbol">=</a> <a id="26567" href="/Substitution/#3179" class="Function">ids</a><a id="26570" class="Symbol">}))</a> <a id="26574" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">⟩</a>
      <a id="26582" href="/Substitution/#26152" class="Bound">M</a> <a id="26584" href="/Substitution/#3592" class="Function Operator">•</a> <a id="26586" class="Symbol">(</a><a id="26587" href="/Substitution/#26146" class="Bound">σ</a> <a id="26589" href="/Substitution/#3945" class="Function Operator">⨟</a> <a id="26591" href="/Substitution/#3179" class="Function">ids</a><a id="26594" class="Symbol">)</a>
    <a id="26600" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">≡⟨</a> <a id="26603" href="/Substitution/#12340" class="Function">cong-cons</a> <a id="26613" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a> <a id="26618" class="Symbol">(</a><a id="26619" href="/Substitution/#18322" class="Function">sub-idR</a><a id="26626" class="Symbol">{</a><a id="26627" class="Argument">σ</a> <a id="26629" class="Symbol">=</a> <a id="26631" href="/Substitution/#26146" class="Bound">σ</a><a id="26632" class="Symbol">})</a> <a id="26635" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">⟩</a>
      <a id="26643" href="/Substitution/#26152" class="Bound">M</a> <a id="26645" href="/Substitution/#3592" class="Function Operator">•</a> <a id="26647" href="/Substitution/#26146" class="Bound">σ</a>
    <a id="26653" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4374" class="Function Operator">∎</a></pre>

<h2 id="proof-of-the-substitution-lemma">Proof of the substitution lemma</h2>

<p>We first prove the generalized form of the substitution lemma, showing
that a substitution <code class="highlighter-rouge">σ</code> commutes with the substitution of <code class="highlighter-rouge">M</code> into
<code class="highlighter-rouge">N</code>.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>⟪ exts σ ⟫ N [ ⟪ σ ⟫ M ] ≡ ⟪ σ ⟫ (N [ M ])
</code></pre></div></div>

<p>This proof is where the σ algebra pays off.  The proof is by direct
equational reasoning. Starting with the left-hand side, we apply σ
algebra equations, oriented left-to-right, until we arrive at the
normal form</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>⟪ ⟪ σ ⟫ M • σ ⟫ N
</code></pre></div></div>

<p>We then do the same with the right-hand side, arriving at the same
normal form.</p>

<pre class="Agda"><a id="subst-commute"></a><a id="27228" href="/Substitution/#27228" class="Function">subst-commute</a> <a id="27242" class="Symbol">:</a> <a id="27244" class="Symbol">∀{</a><a id="27246" href="/Substitution/#27246" class="Bound">Γ</a> <a id="27248" href="/Substitution/#27248" class="Bound">Δ</a><a id="27249" class="Symbol">}{</a><a id="27251" href="/Substitution/#27251" class="Bound">N</a> <a id="27253" class="Symbol">:</a> <a id="27255" href="/Substitution/#27246" class="Bound">Γ</a> <a id="27257" href="/Untyped/#3018" class="InductiveConstructor Operator">,</a> <a id="27259" href="/Untyped/#2694" class="InductiveConstructor">★</a> <a id="27261" href="/Untyped/#4150" class="Datatype Operator">⊢</a> <a id="27263" href="/Untyped/#2694" class="InductiveConstructor">★</a><a id="27264" class="Symbol">}{</a><a id="27266" href="/Substitution/#27266" class="Bound">M</a> <a id="27268" class="Symbol">:</a> <a id="27270" href="/Substitution/#27246" class="Bound">Γ</a> <a id="27272" href="/Untyped/#4150" class="Datatype Operator">⊢</a> <a id="27274" href="/Untyped/#2694" class="InductiveConstructor">★</a><a id="27275" class="Symbol">}{</a><a id="27277" href="/Substitution/#27277" class="Bound">σ</a> <a id="27279" class="Symbol">:</a> <a id="27281" href="/Substitution/#2506" class="Function">Subst</a> <a id="27287" href="/Substitution/#27246" class="Bound">Γ</a> <a id="27289" href="/Substitution/#27248" class="Bound">Δ</a> <a id="27291" class="Symbol">}</a>
    <a id="27297" class="Symbol">→</a> <a id="27299" href="/Substitution/#2663" class="Function Operator">⟪</a> <a id="27301" href="/Untyped/#6623" class="Function">exts</a> <a id="27306" href="/Substitution/#27277" class="Bound">σ</a> <a id="27308" href="/Substitution/#2663" class="Function Operator">⟫</a> <a id="27310" href="/Substitution/#27251" class="Bound">N</a> <a id="27312" href="/Untyped/#7475" class="Function Operator">[</a> <a id="27314" href="/Substitution/#2663" class="Function Operator">⟪</a> <a id="27316" href="/Substitution/#27277" class="Bound">σ</a> <a id="27318" href="/Substitution/#2663" class="Function Operator">⟫</a> <a id="27320" href="/Substitution/#27266" class="Bound">M</a> <a id="27322" href="/Untyped/#7475" class="Function Operator">]</a> <a id="27324" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="27326" href="/Substitution/#2663" class="Function Operator">⟪</a> <a id="27328" href="/Substitution/#27277" class="Bound">σ</a> <a id="27330" href="/Substitution/#2663" class="Function Operator">⟫</a> <a id="27332" class="Symbol">(</a><a id="27333" href="/Substitution/#27251" class="Bound">N</a> <a id="27335" href="/Untyped/#7475" class="Function Operator">[</a> <a id="27337" href="/Substitution/#27266" class="Bound">M</a> <a id="27339" href="/Untyped/#7475" class="Function Operator">]</a><a id="27340" class="Symbol">)</a>
<a id="27342" href="/Substitution/#27228" class="Function">subst-commute</a> <a id="27356" class="Symbol">{</a><a id="27357" href="/Substitution/#27357" class="Bound">Γ</a><a id="27358" class="Symbol">}{</a><a id="27360" href="/Substitution/#27360" class="Bound">Δ</a><a id="27361" class="Symbol">}{</a><a id="27363" href="/Substitution/#27363" class="Bound">N</a><a id="27364" class="Symbol">}{</a><a id="27366" href="/Substitution/#27366" class="Bound">M</a><a id="27367" class="Symbol">}{</a><a id="27369" href="/Substitution/#27369" class="Bound">σ</a><a id="27370" class="Symbol">}</a> <a id="27372" class="Symbol">=</a>
     <a id="27379" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4076" class="Function Operator">begin</a>
       <a id="27392" href="/Substitution/#2663" class="Function Operator">⟪</a> <a id="27394" href="/Untyped/#6623" class="Function">exts</a> <a id="27399" href="/Substitution/#27369" class="Bound">σ</a> <a id="27401" href="/Substitution/#2663" class="Function Operator">⟫</a> <a id="27403" href="/Substitution/#27363" class="Bound">N</a> <a id="27405" href="/Untyped/#7475" class="Function Operator">[</a> <a id="27407" href="/Substitution/#2663" class="Function Operator">⟪</a> <a id="27409" href="/Substitution/#27369" class="Bound">σ</a> <a id="27411" href="/Substitution/#2663" class="Function Operator">⟫</a> <a id="27413" href="/Substitution/#27366" class="Bound">M</a> <a id="27415" href="/Untyped/#7475" class="Function Operator">]</a>
     <a id="27422" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4134" class="Function Operator">≡⟨⟩</a>
       <a id="27433" href="/Substitution/#2663" class="Function Operator">⟪</a> <a id="27435" href="/Untyped/#7359" class="Function">subst-zero</a> <a id="27446" class="Symbol">(</a><a id="27447" href="/Substitution/#2663" class="Function Operator">⟪</a> <a id="27449" href="/Substitution/#27369" class="Bound">σ</a> <a id="27451" href="/Substitution/#2663" class="Function Operator">⟫</a> <a id="27453" href="/Substitution/#27366" class="Bound">M</a><a id="27454" class="Symbol">)</a> <a id="27456" href="/Substitution/#2663" class="Function Operator">⟫</a> <a id="27458" class="Symbol">(</a><a id="27459" href="/Substitution/#2663" class="Function Operator">⟪</a> <a id="27461" href="/Untyped/#6623" class="Function">exts</a> <a id="27466" href="/Substitution/#27369" class="Bound">σ</a> <a id="27468" href="/Substitution/#2663" class="Function Operator">⟫</a> <a id="27470" href="/Substitution/#27363" class="Bound">N</a><a id="27471" class="Symbol">)</a>
     <a id="27478" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">≡⟨</a> <a id="27481" href="/Substitution/#11568" class="Function">cong-sub</a> <a id="27490" class="Symbol">{</a><a id="27491" class="Argument">M</a> <a id="27493" class="Symbol">=</a> <a id="27495" href="/Substitution/#2663" class="Function Operator">⟪</a> <a id="27497" href="/Untyped/#6623" class="Function">exts</a> <a id="27502" href="/Substitution/#27369" class="Bound">σ</a> <a id="27504" href="/Substitution/#2663" class="Function Operator">⟫</a> <a id="27506" href="/Substitution/#27363" class="Bound">N</a><a id="27507" class="Symbol">}</a> <a id="27509" href="/Substitution/#16375" class="Function">subst-Z-cons-ids</a> <a id="27526" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a> <a id="27531" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">⟩</a>
       <a id="27540" href="/Substitution/#2663" class="Function Operator">⟪</a> <a id="27542" href="/Substitution/#2663" class="Function Operator">⟪</a> <a id="27544" href="/Substitution/#27369" class="Bound">σ</a> <a id="27546" href="/Substitution/#2663" class="Function Operator">⟫</a> <a id="27548" href="/Substitution/#27366" class="Bound">M</a> <a id="27550" href="/Substitution/#3592" class="Function Operator">•</a> <a id="27552" href="/Substitution/#3179" class="Function">ids</a> <a id="27556" href="/Substitution/#2663" class="Function Operator">⟫</a> <a id="27558" class="Symbol">(</a><a id="27559" href="/Substitution/#2663" class="Function Operator">⟪</a> <a id="27561" href="/Untyped/#6623" class="Function">exts</a> <a id="27566" href="/Substitution/#27369" class="Bound">σ</a> <a id="27568" href="/Substitution/#2663" class="Function Operator">⟫</a> <a id="27570" href="/Substitution/#27363" class="Bound">N</a><a id="27571" class="Symbol">)</a>
     <a id="27578" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">≡⟨</a> <a id="27581" href="/Substitution/#23724" class="Function">sub-sub</a> <a id="27589" class="Symbol">{</a><a id="27590" class="Argument">M</a> <a id="27592" class="Symbol">=</a> <a id="27594" href="/Substitution/#27363" class="Bound">N</a><a id="27595" class="Symbol">}</a> <a id="27597" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">⟩</a>
       <a id="27606" href="/Substitution/#2663" class="Function Operator">⟪</a> <a id="27608" class="Symbol">(</a><a id="27609" href="/Untyped/#6623" class="Function">exts</a> <a id="27614" href="/Substitution/#27369" class="Bound">σ</a><a id="27615" class="Symbol">)</a> <a id="27617" href="/Substitution/#3945" class="Function Operator">⨟</a> <a id="27619" class="Symbol">((</a><a id="27621" href="/Substitution/#2663" class="Function Operator">⟪</a> <a id="27623" href="/Substitution/#27369" class="Bound">σ</a> <a id="27625" href="/Substitution/#2663" class="Function Operator">⟫</a> <a id="27627" href="/Substitution/#27366" class="Bound">M</a><a id="27628" class="Symbol">)</a> <a id="27630" href="/Substitution/#3592" class="Function Operator">•</a> <a id="27632" href="/Substitution/#3179" class="Function">ids</a><a id="27635" class="Symbol">)</a> <a id="27637" href="/Substitution/#2663" class="Function Operator">⟫</a> <a id="27639" href="/Substitution/#27363" class="Bound">N</a>
     <a id="27646" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">≡⟨</a> <a id="27649" href="/Substitution/#11568" class="Function">cong-sub</a> <a id="27658" class="Symbol">{</a><a id="27659" class="Argument">M</a> <a id="27661" class="Symbol">=</a> <a id="27663" href="/Substitution/#27363" class="Bound">N</a><a id="27664" class="Symbol">}</a> <a id="27666" class="Symbol">(</a><a id="27667" href="/Substitution/#12701" class="Function">cong-seq</a> <a id="27676" href="/Substitution/#15561" class="Function">exts-cons-shift</a> <a id="27692" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a><a id="27696" class="Symbol">)</a> <a id="27698" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a> <a id="27703" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">⟩</a>
       <a id="27712" href="/Substitution/#2663" class="Function Operator">⟪</a> <a id="27714" class="Symbol">(</a><a id="27715" href="/Untyped/#4186" class="InductiveConstructor Operator">`</a> <a id="27717" href="/Untyped/#3401" class="InductiveConstructor">Z</a> <a id="27719" href="/Substitution/#3592" class="Function Operator">•</a> <a id="27721" class="Symbol">(</a><a id="27722" href="/Substitution/#27369" class="Bound">σ</a> <a id="27724" href="/Substitution/#3945" class="Function Operator">⨟</a> <a id="27726" href="/Substitution/#3334" class="Function">↑</a><a id="27727" class="Symbol">))</a> <a id="27730" href="/Substitution/#3945" class="Function Operator">⨟</a> <a id="27732" class="Symbol">(</a><a id="27733" href="/Substitution/#2663" class="Function Operator">⟪</a> <a id="27735" href="/Substitution/#27369" class="Bound">σ</a> <a id="27737" href="/Substitution/#2663" class="Function Operator">⟫</a> <a id="27739" href="/Substitution/#27366" class="Bound">M</a> <a id="27741" href="/Substitution/#3592" class="Function Operator">•</a> <a id="27743" href="/Substitution/#3179" class="Function">ids</a><a id="27746" class="Symbol">)</a> <a id="27748" href="/Substitution/#2663" class="Function Operator">⟫</a> <a id="27750" href="/Substitution/#27363" class="Bound">N</a>
     <a id="27757" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">≡⟨</a> <a id="27760" href="/Substitution/#11568" class="Function">cong-sub</a> <a id="27769" class="Symbol">{</a><a id="27770" class="Argument">M</a> <a id="27772" class="Symbol">=</a> <a id="27774" href="/Substitution/#27363" class="Bound">N</a><a id="27775" class="Symbol">}</a> <a id="27777" class="Symbol">(</a><a id="27778" href="/Substitution/#9382" class="Function">sub-dist</a> <a id="27787" class="Symbol">{</a><a id="27788" class="Argument">M</a> <a id="27790" class="Symbol">=</a> <a id="27792" href="/Untyped/#4186" class="InductiveConstructor Operator">`</a> <a id="27794" href="/Untyped/#3401" class="InductiveConstructor">Z</a><a id="27795" class="Symbol">})</a> <a id="27798" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a> <a id="27803" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">⟩</a>
       <a id="27812" href="/Substitution/#2663" class="Function Operator">⟪</a> <a id="27814" href="/Substitution/#2663" class="Function Operator">⟪</a> <a id="27816" href="/Substitution/#2663" class="Function Operator">⟪</a> <a id="27818" href="/Substitution/#27369" class="Bound">σ</a> <a id="27820" href="/Substitution/#2663" class="Function Operator">⟫</a> <a id="27822" href="/Substitution/#27366" class="Bound">M</a> <a id="27824" href="/Substitution/#3592" class="Function Operator">•</a> <a id="27826" href="/Substitution/#3179" class="Function">ids</a> <a id="27830" href="/Substitution/#2663" class="Function Operator">⟫</a> <a id="27832" class="Symbol">(</a><a id="27833" href="/Untyped/#4186" class="InductiveConstructor Operator">`</a> <a id="27835" href="/Untyped/#3401" class="InductiveConstructor">Z</a><a id="27836" class="Symbol">)</a> <a id="27838" href="/Substitution/#3592" class="Function Operator">•</a> <a id="27840" class="Symbol">((</a><a id="27842" href="/Substitution/#27369" class="Bound">σ</a> <a id="27844" href="/Substitution/#3945" class="Function Operator">⨟</a> <a id="27846" href="/Substitution/#3334" class="Function">↑</a><a id="27847" class="Symbol">)</a> <a id="27849" href="/Substitution/#3945" class="Function Operator">⨟</a> <a id="27851" class="Symbol">(</a><a id="27852" href="/Substitution/#2663" class="Function Operator">⟪</a> <a id="27854" href="/Substitution/#27369" class="Bound">σ</a> <a id="27856" href="/Substitution/#2663" class="Function Operator">⟫</a> <a id="27858" href="/Substitution/#27366" class="Bound">M</a> <a id="27860" href="/Substitution/#3592" class="Function Operator">•</a> <a id="27862" href="/Substitution/#3179" class="Function">ids</a><a id="27865" class="Symbol">))</a> <a id="27868" href="/Substitution/#2663" class="Function Operator">⟫</a> <a id="27870" href="/Substitution/#27363" class="Bound">N</a>
     <a id="27877" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4134" class="Function Operator">≡⟨⟩</a>
       <a id="27888" href="/Substitution/#2663" class="Function Operator">⟪</a> <a id="27890" href="/Substitution/#2663" class="Function Operator">⟪</a> <a id="27892" href="/Substitution/#27369" class="Bound">σ</a> <a id="27894" href="/Substitution/#2663" class="Function Operator">⟫</a> <a id="27896" href="/Substitution/#27366" class="Bound">M</a> <a id="27898" href="/Substitution/#3592" class="Function Operator">•</a> <a id="27900" class="Symbol">((</a><a id="27902" href="/Substitution/#27369" class="Bound">σ</a> <a id="27904" href="/Substitution/#3945" class="Function Operator">⨟</a> <a id="27906" href="/Substitution/#3334" class="Function">↑</a><a id="27907" class="Symbol">)</a> <a id="27909" href="/Substitution/#3945" class="Function Operator">⨟</a> <a id="27911" class="Symbol">(</a><a id="27912" href="/Substitution/#2663" class="Function Operator">⟪</a> <a id="27914" href="/Substitution/#27369" class="Bound">σ</a> <a id="27916" href="/Substitution/#2663" class="Function Operator">⟫</a> <a id="27918" href="/Substitution/#27366" class="Bound">M</a> <a id="27920" href="/Substitution/#3592" class="Function Operator">•</a> <a id="27922" href="/Substitution/#3179" class="Function">ids</a><a id="27925" class="Symbol">))</a> <a id="27928" href="/Substitution/#2663" class="Function Operator">⟫</a> <a id="27930" href="/Substitution/#27363" class="Bound">N</a>
     <a id="27937" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">≡⟨</a> <a id="27940" href="/Substitution/#11568" class="Function">cong-sub</a><a id="27948" class="Symbol">{</a><a id="27949" class="Argument">M</a> <a id="27951" class="Symbol">=</a> <a id="27953" href="/Substitution/#27363" class="Bound">N</a><a id="27954" class="Symbol">}</a> <a id="27956" class="Symbol">(</a><a id="27957" href="/Substitution/#12340" class="Function">cong-cons</a> <a id="27967" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a> <a id="27972" class="Symbol">(</a><a id="27973" href="/Substitution/#25226" class="Function">sub-assoc</a><a id="27982" class="Symbol">{</a><a id="27983" class="Argument">σ</a> <a id="27985" class="Symbol">=</a> <a id="27987" href="/Substitution/#27369" class="Bound">σ</a><a id="27988" class="Symbol">}))</a> <a id="27992" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a> <a id="27997" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">⟩</a>
       <a id="28006" href="/Substitution/#2663" class="Function Operator">⟪</a> <a id="28008" href="/Substitution/#2663" class="Function Operator">⟪</a> <a id="28010" href="/Substitution/#27369" class="Bound">σ</a> <a id="28012" href="/Substitution/#2663" class="Function Operator">⟫</a> <a id="28014" href="/Substitution/#27366" class="Bound">M</a> <a id="28016" href="/Substitution/#3592" class="Function Operator">•</a> <a id="28018" class="Symbol">(</a><a id="28019" href="/Substitution/#27369" class="Bound">σ</a> <a id="28021" href="/Substitution/#3945" class="Function Operator">⨟</a> <a id="28023" href="/Substitution/#3334" class="Function">↑</a> <a id="28025" href="/Substitution/#3945" class="Function Operator">⨟</a> <a id="28027" href="/Substitution/#2663" class="Function Operator">⟪</a> <a id="28029" href="/Substitution/#27369" class="Bound">σ</a> <a id="28031" href="/Substitution/#2663" class="Function Operator">⟫</a> <a id="28033" href="/Substitution/#27366" class="Bound">M</a> <a id="28035" href="/Substitution/#3592" class="Function Operator">•</a> <a id="28037" href="/Substitution/#3179" class="Function">ids</a><a id="28040" class="Symbol">)</a> <a id="28042" href="/Substitution/#2663" class="Function Operator">⟫</a> <a id="28044" href="/Substitution/#27363" class="Bound">N</a>
     <a id="28051" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">≡⟨</a> <a id="28054" href="/Substitution/#11568" class="Function">cong-sub</a><a id="28062" class="Symbol">{</a><a id="28063" class="Argument">M</a> <a id="28065" class="Symbol">=</a> <a id="28067" href="/Substitution/#27363" class="Bound">N</a><a id="28068" class="Symbol">}</a> <a id="28070" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a> <a id="28075" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a> <a id="28080" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">⟩</a>
       <a id="28089" href="/Substitution/#2663" class="Function Operator">⟪</a> <a id="28091" href="/Substitution/#2663" class="Function Operator">⟪</a> <a id="28093" href="/Substitution/#27369" class="Bound">σ</a> <a id="28095" href="/Substitution/#2663" class="Function Operator">⟫</a> <a id="28097" href="/Substitution/#27366" class="Bound">M</a> <a id="28099" href="/Substitution/#3592" class="Function Operator">•</a> <a id="28101" class="Symbol">(</a><a id="28102" href="/Substitution/#27369" class="Bound">σ</a> <a id="28104" href="/Substitution/#3945" class="Function Operator">⨟</a> <a id="28106" href="/Substitution/#3179" class="Function">ids</a><a id="28109" class="Symbol">)</a> <a id="28111" href="/Substitution/#2663" class="Function Operator">⟫</a> <a id="28113" href="/Substitution/#27363" class="Bound">N</a>
     <a id="28120" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">≡⟨</a> <a id="28123" href="/Substitution/#11568" class="Function">cong-sub</a><a id="28131" class="Symbol">{</a><a id="28132" class="Argument">M</a> <a id="28134" class="Symbol">=</a> <a id="28136" href="/Substitution/#27363" class="Bound">N</a><a id="28137" class="Symbol">}</a> <a id="28139" class="Symbol">(</a><a id="28140" href="/Substitution/#12340" class="Function">cong-cons</a> <a id="28150" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a> <a id="28155" class="Symbol">(</a><a id="28156" href="/Substitution/#18322" class="Function">sub-idR</a><a id="28163" class="Symbol">{</a><a id="28164" class="Argument">σ</a> <a id="28166" class="Symbol">=</a> <a id="28168" href="/Substitution/#27369" class="Bound">σ</a><a id="28169" class="Symbol">}))</a> <a id="28173" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a> <a id="28178" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">⟩</a>
       <a id="28187" href="/Substitution/#2663" class="Function Operator">⟪</a> <a id="28189" href="/Substitution/#2663" class="Function Operator">⟪</a> <a id="28191" href="/Substitution/#27369" class="Bound">σ</a> <a id="28193" href="/Substitution/#2663" class="Function Operator">⟫</a> <a id="28195" href="/Substitution/#27366" class="Bound">M</a> <a id="28197" href="/Substitution/#3592" class="Function Operator">•</a> <a id="28199" href="/Substitution/#27369" class="Bound">σ</a> <a id="28201" href="/Substitution/#2663" class="Function Operator">⟫</a> <a id="28203" href="/Substitution/#27363" class="Bound">N</a>
     <a id="28210" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">≡⟨</a> <a id="28213" href="/Substitution/#11568" class="Function">cong-sub</a><a id="28221" class="Symbol">{</a><a id="28222" class="Argument">M</a> <a id="28224" class="Symbol">=</a> <a id="28226" href="/Substitution/#27363" class="Bound">N</a><a id="28227" class="Symbol">}</a> <a id="28229" class="Symbol">(</a><a id="28230" href="/Substitution/#12340" class="Function">cong-cons</a> <a id="28240" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a> <a id="28245" class="Symbol">(</a><a id="28246" href="/Substitution/#9259" class="Function">sub-idL</a><a id="28253" class="Symbol">{</a><a id="28254" class="Argument">σ</a> <a id="28256" class="Symbol">=</a> <a id="28258" href="/Substitution/#27369" class="Bound">σ</a><a id="28259" class="Symbol">}))</a> <a id="28263" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a> <a id="28268" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">⟩</a>
       <a id="28277" href="/Substitution/#2663" class="Function Operator">⟪</a> <a id="28279" href="/Substitution/#2663" class="Function Operator">⟪</a> <a id="28281" href="/Substitution/#27369" class="Bound">σ</a> <a id="28283" href="/Substitution/#2663" class="Function Operator">⟫</a> <a id="28285" href="/Substitution/#27366" class="Bound">M</a> <a id="28287" href="/Substitution/#3592" class="Function Operator">•</a> <a id="28289" class="Symbol">(</a><a id="28290" href="/Substitution/#3179" class="Function">ids</a> <a id="28294" href="/Substitution/#3945" class="Function Operator">⨟</a> <a id="28296" href="/Substitution/#27369" class="Bound">σ</a><a id="28297" class="Symbol">)</a> <a id="28299" href="/Substitution/#2663" class="Function Operator">⟫</a> <a id="28301" href="/Substitution/#27363" class="Bound">N</a>
     <a id="28308" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">≡⟨</a> <a id="28311" href="/Substitution/#11568" class="Function">cong-sub</a><a id="28319" class="Symbol">{</a><a id="28320" class="Argument">M</a> <a id="28322" class="Symbol">=</a> <a id="28324" href="/Substitution/#27363" class="Bound">N</a><a id="28325" class="Symbol">}</a> <a id="28327" class="Symbol">(</a><a id="28328" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.Core.html#838" class="Function">sym</a> <a id="28332" href="/Substitution/#9382" class="Function">sub-dist</a><a id="28340" class="Symbol">)</a> <a id="28342" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a> <a id="28347" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">⟩</a>
       <a id="28356" href="/Substitution/#2663" class="Function Operator">⟪</a> <a id="28358" href="/Substitution/#27366" class="Bound">M</a> <a id="28360" href="/Substitution/#3592" class="Function Operator">•</a> <a id="28362" href="/Substitution/#3179" class="Function">ids</a> <a id="28366" href="/Substitution/#3945" class="Function Operator">⨟</a> <a id="28368" href="/Substitution/#27369" class="Bound">σ</a> <a id="28370" href="/Substitution/#2663" class="Function Operator">⟫</a> <a id="28372" href="/Substitution/#27363" class="Bound">N</a>
     <a id="28379" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">≡⟨</a> <a id="28382" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.Core.html#838" class="Function">sym</a> <a id="28386" class="Symbol">(</a><a id="28387" href="/Substitution/#23724" class="Function">sub-sub</a><a id="28394" class="Symbol">{</a><a id="28395" class="Argument">M</a> <a id="28397" class="Symbol">=</a> <a id="28399" href="/Substitution/#27363" class="Bound">N</a><a id="28400" class="Symbol">})</a> <a id="28403" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">⟩</a>
       <a id="28412" href="/Substitution/#2663" class="Function Operator">⟪</a> <a id="28414" href="/Substitution/#27369" class="Bound">σ</a> <a id="28416" href="/Substitution/#2663" class="Function Operator">⟫</a> <a id="28418" class="Symbol">(</a><a id="28419" href="/Substitution/#2663" class="Function Operator">⟪</a> <a id="28421" href="/Substitution/#27366" class="Bound">M</a> <a id="28423" href="/Substitution/#3592" class="Function Operator">•</a> <a id="28425" href="/Substitution/#3179" class="Function">ids</a> <a id="28429" href="/Substitution/#2663" class="Function Operator">⟫</a> <a id="28431" href="/Substitution/#27363" class="Bound">N</a><a id="28432" class="Symbol">)</a>
     <a id="28439" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">≡⟨</a> <a id="28442" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#1170" class="Function">cong</a> <a id="28447" href="/Substitution/#2663" class="Function Operator">⟪</a> <a id="28449" href="/Substitution/#27369" class="Bound">σ</a> <a id="28451" href="/Substitution/#2663" class="Function Operator">⟫</a> <a id="28453" class="Symbol">(</a><a id="28454" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.Core.html#838" class="Function">sym</a> <a id="28458" class="Symbol">(</a><a id="28459" href="/Substitution/#11568" class="Function">cong-sub</a><a id="28467" class="Symbol">{</a><a id="28468" class="Argument">M</a> <a id="28470" class="Symbol">=</a> <a id="28472" href="/Substitution/#27363" class="Bound">N</a><a id="28473" class="Symbol">}</a> <a id="28475" href="/Substitution/#16375" class="Function">subst-Z-cons-ids</a> <a id="28492" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a><a id="28496" class="Symbol">))</a> <a id="28499" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">⟩</a>
       <a id="28508" href="/Substitution/#2663" class="Function Operator">⟪</a> <a id="28510" href="/Substitution/#27369" class="Bound">σ</a> <a id="28512" href="/Substitution/#2663" class="Function Operator">⟫</a> <a id="28514" class="Symbol">(</a><a id="28515" href="/Substitution/#27363" class="Bound">N</a> <a id="28517" href="/Untyped/#7475" class="Function Operator">[</a> <a id="28519" href="/Substitution/#27366" class="Bound">M</a> <a id="28521" href="/Untyped/#7475" class="Function Operator">]</a><a id="28522" class="Symbol">)</a>
     <a id="28529" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4374" class="Function Operator">∎</a></pre>

<p>A corollary of <code class="highlighter-rouge">subst-commute</code> is that <code class="highlighter-rouge">rename</code> also commutes with
substitution. In the proof below, we first exchange <code class="highlighter-rouge">rename ρ</code> for
the substitution <code class="highlighter-rouge">⟪ ren ρ ⟫</code>, and apply <code class="highlighter-rouge">subst-commute</code>, and
then convert back to <code class="highlighter-rouge">rename ρ</code>.</p>

<pre class="Agda"><a id="rename-subst-commute"></a><a id="28785" href="/Substitution/#28785" class="Function">rename-subst-commute</a> <a id="28806" class="Symbol">:</a> <a id="28808" class="Symbol">∀{</a><a id="28810" href="/Substitution/#28810" class="Bound">Γ</a> <a id="28812" href="/Substitution/#28812" class="Bound">Δ</a><a id="28813" class="Symbol">}{</a><a id="28815" href="/Substitution/#28815" class="Bound">N</a> <a id="28817" class="Symbol">:</a> <a id="28819" href="/Substitution/#28810" class="Bound">Γ</a> <a id="28821" href="/Untyped/#3018" class="InductiveConstructor Operator">,</a> <a id="28823" href="/Untyped/#2694" class="InductiveConstructor">★</a> <a id="28825" href="/Untyped/#4150" class="Datatype Operator">⊢</a> <a id="28827" href="/Untyped/#2694" class="InductiveConstructor">★</a><a id="28828" class="Symbol">}{</a><a id="28830" href="/Substitution/#28830" class="Bound">M</a> <a id="28832" class="Symbol">:</a> <a id="28834" href="/Substitution/#28810" class="Bound">Γ</a> <a id="28836" href="/Untyped/#4150" class="Datatype Operator">⊢</a> <a id="28838" href="/Untyped/#2694" class="InductiveConstructor">★</a><a id="28839" class="Symbol">}{</a><a id="28841" href="/Substitution/#28841" class="Bound">ρ</a> <a id="28843" class="Symbol">:</a> <a id="28845" href="/Substitution/#2277" class="Function">Rename</a> <a id="28852" href="/Substitution/#28810" class="Bound">Γ</a> <a id="28854" href="/Substitution/#28812" class="Bound">Δ</a> <a id="28856" class="Symbol">}</a>
    <a id="28862" class="Symbol">→</a> <a id="28864" class="Symbol">(</a><a id="28865" href="/Untyped/#6171" class="Function">rename</a> <a id="28872" class="Symbol">(</a><a id="28873" href="/Untyped/#5845" class="Function">ext</a> <a id="28877" href="/Substitution/#28841" class="Bound">ρ</a><a id="28878" class="Symbol">)</a> <a id="28880" href="/Substitution/#28815" class="Bound">N</a><a id="28881" class="Symbol">)</a> <a id="28883" href="/Untyped/#7475" class="Function Operator">[</a> <a id="28885" href="/Untyped/#6171" class="Function">rename</a> <a id="28892" href="/Substitution/#28841" class="Bound">ρ</a> <a id="28894" href="/Substitution/#28830" class="Bound">M</a> <a id="28896" href="/Untyped/#7475" class="Function Operator">]</a> <a id="28898" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="28900" href="/Untyped/#6171" class="Function">rename</a> <a id="28907" href="/Substitution/#28841" class="Bound">ρ</a> <a id="28909" class="Symbol">(</a><a id="28910" href="/Substitution/#28815" class="Bound">N</a> <a id="28912" href="/Untyped/#7475" class="Function Operator">[</a> <a id="28914" href="/Substitution/#28830" class="Bound">M</a> <a id="28916" href="/Untyped/#7475" class="Function Operator">]</a><a id="28917" class="Symbol">)</a>
<a id="28919" href="/Substitution/#28785" class="Function">rename-subst-commute</a> <a id="28940" class="Symbol">{</a><a id="28941" href="/Substitution/#28941" class="Bound">Γ</a><a id="28942" class="Symbol">}{</a><a id="28944" href="/Substitution/#28944" class="Bound">Δ</a><a id="28945" class="Symbol">}{</a><a id="28947" href="/Substitution/#28947" class="Bound">N</a><a id="28948" class="Symbol">}{</a><a id="28950" href="/Substitution/#28950" class="Bound">M</a><a id="28951" class="Symbol">}{</a><a id="28953" href="/Substitution/#28953" class="Bound">ρ</a><a id="28954" class="Symbol">}</a> <a id="28956" class="Symbol">=</a>
     <a id="28963" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4076" class="Function Operator">begin</a>
       <a id="28976" class="Symbol">(</a><a id="28977" href="/Untyped/#6171" class="Function">rename</a> <a id="28984" class="Symbol">(</a><a id="28985" href="/Untyped/#5845" class="Function">ext</a> <a id="28989" href="/Substitution/#28953" class="Bound">ρ</a><a id="28990" class="Symbol">)</a> <a id="28992" href="/Substitution/#28947" class="Bound">N</a><a id="28993" class="Symbol">)</a> <a id="28995" href="/Untyped/#7475" class="Function Operator">[</a> <a id="28997" href="/Untyped/#6171" class="Function">rename</a> <a id="29004" href="/Substitution/#28953" class="Bound">ρ</a> <a id="29006" href="/Substitution/#28950" class="Bound">M</a> <a id="29008" href="/Untyped/#7475" class="Function Operator">]</a>
     <a id="29015" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">≡⟨</a> <a id="29018" href="/Substitution/#11568" class="Function">cong-sub</a> <a id="29027" class="Symbol">(</a><a id="29028" href="/Substitution/#12073" class="Function">cong-sub-zero</a> <a id="29042" class="Symbol">(</a><a id="29043" href="/Substitution/#14149" class="Function">rename-subst-ren</a><a id="29059" class="Symbol">{</a><a id="29060" class="Argument">M</a> <a id="29062" class="Symbol">=</a> <a id="29064" href="/Substitution/#28950" class="Bound">M</a><a id="29065" class="Symbol">}))</a>
                 <a id="29086" class="Symbol">(</a><a id="29087" href="/Substitution/#14149" class="Function">rename-subst-ren</a><a id="29103" class="Symbol">{</a><a id="29104" class="Argument">M</a> <a id="29106" class="Symbol">=</a> <a id="29108" href="/Substitution/#28947" class="Bound">N</a><a id="29109" class="Symbol">})</a> <a id="29112" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">⟩</a>
       <a id="29121" class="Symbol">(</a><a id="29122" href="/Substitution/#2663" class="Function Operator">⟪</a> <a id="29124" href="/Substitution/#6703" class="Function">ren</a> <a id="29128" class="Symbol">(</a><a id="29129" href="/Untyped/#5845" class="Function">ext</a> <a id="29133" href="/Substitution/#28953" class="Bound">ρ</a><a id="29134" class="Symbol">)</a> <a id="29136" href="/Substitution/#2663" class="Function Operator">⟫</a> <a id="29138" href="/Substitution/#28947" class="Bound">N</a><a id="29139" class="Symbol">)</a> <a id="29141" href="/Untyped/#7475" class="Function Operator">[</a> <a id="29143" href="/Substitution/#2663" class="Function Operator">⟪</a> <a id="29145" href="/Substitution/#6703" class="Function">ren</a> <a id="29149" href="/Substitution/#28953" class="Bound">ρ</a> <a id="29151" href="/Substitution/#2663" class="Function Operator">⟫</a> <a id="29153" href="/Substitution/#28950" class="Bound">M</a> <a id="29155" href="/Untyped/#7475" class="Function Operator">]</a>
     <a id="29162" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">≡⟨</a> <a id="29165" href="/Substitution/#11568" class="Function">cong-sub</a> <a id="29174" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a> <a id="29179" class="Symbol">(</a><a id="29180" href="/Substitution/#11568" class="Function">cong-sub</a><a id="29188" class="Symbol">{</a><a id="29189" class="Argument">M</a> <a id="29191" class="Symbol">=</a> <a id="29193" href="/Substitution/#28947" class="Bound">N</a><a id="29194" class="Symbol">}</a> <a id="29196" href="/Substitution/#13764" class="Function">ren-ext</a> <a id="29204" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a><a id="29208" class="Symbol">)</a> <a id="29210" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">⟩</a>
       <a id="29219" class="Symbol">(</a><a id="29220" href="/Substitution/#2663" class="Function Operator">⟪</a> <a id="29222" href="/Untyped/#6623" class="Function">exts</a> <a id="29227" class="Symbol">(</a><a id="29228" href="/Substitution/#6703" class="Function">ren</a> <a id="29232" href="/Substitution/#28953" class="Bound">ρ</a><a id="29233" class="Symbol">)</a> <a id="29235" href="/Substitution/#2663" class="Function Operator">⟫</a> <a id="29237" href="/Substitution/#28947" class="Bound">N</a><a id="29238" class="Symbol">)</a> <a id="29240" href="/Untyped/#7475" class="Function Operator">[</a> <a id="29242" href="/Substitution/#2663" class="Function Operator">⟪</a> <a id="29244" href="/Substitution/#6703" class="Function">ren</a> <a id="29248" href="/Substitution/#28953" class="Bound">ρ</a> <a id="29250" href="/Substitution/#2663" class="Function Operator">⟫</a> <a id="29252" href="/Substitution/#28950" class="Bound">M</a> <a id="29254" href="/Untyped/#7475" class="Function Operator">]</a>
     <a id="29261" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">≡⟨</a> <a id="29264" href="/Substitution/#27228" class="Function">subst-commute</a><a id="29277" class="Symbol">{</a><a id="29278" class="Argument">N</a> <a id="29280" class="Symbol">=</a> <a id="29282" href="/Substitution/#28947" class="Bound">N</a><a id="29283" class="Symbol">}</a> <a id="29285" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">⟩</a>
       <a id="29294" href="/Untyped/#6931" class="Function">subst</a> <a id="29300" class="Symbol">(</a><a id="29301" href="/Substitution/#6703" class="Function">ren</a> <a id="29305" href="/Substitution/#28953" class="Bound">ρ</a><a id="29306" class="Symbol">)</a> <a id="29308" class="Symbol">(</a><a id="29309" href="/Substitution/#28947" class="Bound">N</a> <a id="29311" href="/Untyped/#7475" class="Function Operator">[</a> <a id="29313" href="/Substitution/#28950" class="Bound">M</a> <a id="29315" href="/Untyped/#7475" class="Function Operator">]</a><a id="29316" class="Symbol">)</a>
     <a id="29323" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">≡⟨</a> <a id="29326" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.Core.html#838" class="Function">sym</a> <a id="29330" class="Symbol">(</a><a id="29331" href="/Substitution/#14149" class="Function">rename-subst-ren</a><a id="29347" class="Symbol">)</a> <a id="29349" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4193" class="Function Operator">⟩</a>
       <a id="29358" href="/Untyped/#6171" class="Function">rename</a> <a id="29365" href="/Substitution/#28953" class="Bound">ρ</a> <a id="29367" class="Symbol">(</a><a id="29368" href="/Substitution/#28947" class="Bound">N</a> <a id="29370" href="/Untyped/#7475" class="Function Operator">[</a> <a id="29372" href="/Substitution/#28950" class="Bound">M</a> <a id="29374" href="/Untyped/#7475" class="Function Operator">]</a><a id="29375" class="Symbol">)</a>
     <a id="29382" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#4374" class="Function Operator">∎</a></pre>

<p>To present the substitution lemma, we introduce the following notation
for substituting a term <code class="highlighter-rouge">M</code> for index 1 within term <code class="highlighter-rouge">N</code>.</p>

<pre class="Agda"><a id="_〔_〕"></a><a id="29538" href="/Substitution/#29538" class="Function Operator">_〔_〕</a> <a id="29543" class="Symbol">:</a> <a id="29545" class="Symbol">∀</a> <a id="29547" class="Symbol">{</a><a id="29548" href="/Substitution/#29548" class="Bound">Γ</a> <a id="29550" href="/Substitution/#29550" class="Bound">A</a> <a id="29552" href="/Substitution/#29552" class="Bound">B</a> <a id="29554" href="/Substitution/#29554" class="Bound">C</a><a id="29555" class="Symbol">}</a>
        <a id="29565" class="Symbol">→</a> <a id="29567" href="/Substitution/#29548" class="Bound">Γ</a> <a id="29569" href="/Untyped/#3018" class="InductiveConstructor Operator">,</a> <a id="29571" href="/Substitution/#29552" class="Bound">B</a> <a id="29573" href="/Untyped/#3018" class="InductiveConstructor Operator">,</a> <a id="29575" href="/Substitution/#29554" class="Bound">C</a> <a id="29577" href="/Untyped/#4150" class="Datatype Operator">⊢</a> <a id="29579" href="/Substitution/#29550" class="Bound">A</a>
        <a id="29589" class="Symbol">→</a> <a id="29591" href="/Substitution/#29548" class="Bound">Γ</a> <a id="29593" href="/Untyped/#4150" class="Datatype Operator">⊢</a> <a id="29595" href="/Substitution/#29552" class="Bound">B</a>
          <a id="29607" class="Comment">---------</a>
        <a id="29625" class="Symbol">→</a> <a id="29627" href="/Substitution/#29548" class="Bound">Γ</a> <a id="29629" href="/Untyped/#3018" class="InductiveConstructor Operator">,</a> <a id="29631" href="/Substitution/#29554" class="Bound">C</a> <a id="29633" href="/Untyped/#4150" class="Datatype Operator">⊢</a> <a id="29635" href="/Substitution/#29550" class="Bound">A</a>
<a id="29637" href="/Substitution/#29538" class="Function Operator">_〔_〕</a> <a id="29642" class="Symbol">{</a><a id="29643" href="/Substitution/#29643" class="Bound">Γ</a><a id="29644" class="Symbol">}</a> <a id="29646" class="Symbol">{</a><a id="29647" href="/Substitution/#29647" class="Bound">A</a><a id="29648" class="Symbol">}</a> <a id="29650" class="Symbol">{</a><a id="29651" href="/Substitution/#29651" class="Bound">B</a><a id="29652" class="Symbol">}</a> <a id="29654" class="Symbol">{</a><a id="29655" href="/Substitution/#29655" class="Bound">C</a><a id="29656" class="Symbol">}</a> <a id="29658" href="/Substitution/#29658" class="Bound">N</a> <a id="29660" href="/Substitution/#29660" class="Bound">M</a> <a id="29662" class="Symbol">=</a>
   <a id="29667" href="/Untyped/#6931" class="Function">subst</a> <a id="29673" class="Symbol">{</a><a id="29674" href="/Substitution/#29643" class="Bound">Γ</a> <a id="29676" href="/Untyped/#3018" class="InductiveConstructor Operator">,</a> <a id="29678" href="/Substitution/#29651" class="Bound">B</a> <a id="29680" href="/Untyped/#3018" class="InductiveConstructor Operator">,</a> <a id="29682" href="/Substitution/#29655" class="Bound">C</a><a id="29683" class="Symbol">}</a> <a id="29685" class="Symbol">{</a><a id="29686" href="/Substitution/#29643" class="Bound">Γ</a> <a id="29688" href="/Untyped/#3018" class="InductiveConstructor Operator">,</a> <a id="29690" href="/Substitution/#29655" class="Bound">C</a><a id="29691" class="Symbol">}</a> <a id="29693" class="Symbol">(</a><a id="29694" href="/Untyped/#6623" class="Function">exts</a> <a id="29699" class="Symbol">(</a><a id="29700" href="/Untyped/#7359" class="Function">subst-zero</a> <a id="29711" href="/Substitution/#29660" class="Bound">M</a><a id="29712" class="Symbol">))</a> <a id="29715" class="Symbol">{</a><a id="29716" href="/Substitution/#29647" class="Bound">A</a><a id="29717" class="Symbol">}</a> <a id="29719" href="/Substitution/#29658" class="Bound">N</a></pre>

<p>The substitution lemma is stated as follows and proved as a corollary
of the <code class="highlighter-rouge">subst-commute</code> lemma.</p>

<pre class="Agda"><a id="substitution"></a><a id="29847" href="/Substitution/#29847" class="Function">substitution</a> <a id="29860" class="Symbol">:</a> <a id="29862" class="Symbol">∀{</a><a id="29864" href="/Substitution/#29864" class="Bound">Γ</a><a id="29865" class="Symbol">}{</a><a id="29867" href="/Substitution/#29867" class="Bound">M</a> <a id="29869" class="Symbol">:</a> <a id="29871" href="/Substitution/#29864" class="Bound">Γ</a> <a id="29873" href="/Untyped/#3018" class="InductiveConstructor Operator">,</a> <a id="29875" href="/Untyped/#2694" class="InductiveConstructor">★</a> <a id="29877" href="/Untyped/#3018" class="InductiveConstructor Operator">,</a> <a id="29879" href="/Untyped/#2694" class="InductiveConstructor">★</a> <a id="29881" href="/Untyped/#4150" class="Datatype Operator">⊢</a> <a id="29883" href="/Untyped/#2694" class="InductiveConstructor">★</a><a id="29884" class="Symbol">}{</a><a id="29886" href="/Substitution/#29886" class="Bound">N</a> <a id="29888" class="Symbol">:</a> <a id="29890" href="/Substitution/#29864" class="Bound">Γ</a> <a id="29892" href="/Untyped/#3018" class="InductiveConstructor Operator">,</a> <a id="29894" href="/Untyped/#2694" class="InductiveConstructor">★</a> <a id="29896" href="/Untyped/#4150" class="Datatype Operator">⊢</a> <a id="29898" href="/Untyped/#2694" class="InductiveConstructor">★</a><a id="29899" class="Symbol">}{</a><a id="29901" href="/Substitution/#29901" class="Bound">L</a> <a id="29903" class="Symbol">:</a> <a id="29905" href="/Substitution/#29864" class="Bound">Γ</a> <a id="29907" href="/Untyped/#4150" class="Datatype Operator">⊢</a> <a id="29909" href="/Untyped/#2694" class="InductiveConstructor">★</a><a id="29910" class="Symbol">}</a>
    <a id="29916" class="Symbol">→</a> <a id="29918" class="Symbol">(</a><a id="29919" href="/Substitution/#29867" class="Bound">M</a> <a id="29921" href="/Untyped/#7475" class="Function Operator">[</a> <a id="29923" href="/Substitution/#29886" class="Bound">N</a> <a id="29925" href="/Untyped/#7475" class="Function Operator">]</a><a id="29926" class="Symbol">)</a> <a id="29928" href="/Untyped/#7475" class="Function Operator">[</a> <a id="29930" href="/Substitution/#29901" class="Bound">L</a> <a id="29932" href="/Untyped/#7475" class="Function Operator">]</a> <a id="29934" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="29936" class="Symbol">(</a><a id="29937" href="/Substitution/#29867" class="Bound">M</a> <a id="29939" href="/Substitution/#29538" class="Function Operator">〔</a> <a id="29941" href="/Substitution/#29901" class="Bound">L</a> <a id="29943" href="/Substitution/#29538" class="Function Operator">〕</a><a id="29944" class="Symbol">)</a> <a id="29946" href="/Untyped/#7475" class="Function Operator">[</a> <a id="29948" class="Symbol">(</a><a id="29949" href="/Substitution/#29886" class="Bound">N</a> <a id="29951" href="/Untyped/#7475" class="Function Operator">[</a> <a id="29953" href="/Substitution/#29901" class="Bound">L</a> <a id="29955" href="/Untyped/#7475" class="Function Operator">]</a><a id="29956" class="Symbol">)</a> <a id="29958" href="/Untyped/#7475" class="Function Operator">]</a>
<a id="29960" href="/Substitution/#29847" class="Function">substitution</a><a id="29972" class="Symbol">{</a><a id="29973" class="Argument">M</a> <a id="29975" class="Symbol">=</a> <a id="29977" href="/Substitution/#29977" class="Bound">M</a><a id="29978" class="Symbol">}{</a><a id="29980" class="Argument">N</a> <a id="29982" class="Symbol">=</a> <a id="29984" href="/Substitution/#29984" class="Bound">N</a><a id="29985" class="Symbol">}{</a><a id="29987" class="Argument">L</a> <a id="29989" class="Symbol">=</a> <a id="29991" href="/Substitution/#29991" class="Bound">L</a><a id="29992" class="Symbol">}</a> <a id="29994" class="Symbol">=</a>
   <a id="29999" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.Core.html#838" class="Function">sym</a> <a id="30003" class="Symbol">(</a><a id="30004" href="/Substitution/#27228" class="Function">subst-commute</a><a id="30017" class="Symbol">{</a><a id="30018" class="Argument">N</a> <a id="30020" class="Symbol">=</a> <a id="30022" href="/Substitution/#29977" class="Bound">M</a><a id="30023" class="Symbol">}{</a><a id="30025" class="Argument">M</a> <a id="30027" class="Symbol">=</a> <a id="30029" href="/Substitution/#29984" class="Bound">N</a><a id="30030" class="Symbol">}{</a><a id="30032" class="Argument">σ</a> <a id="30034" class="Symbol">=</a> <a id="30036" href="/Untyped/#7359" class="Function">subst-zero</a> <a id="30047" href="/Substitution/#29991" class="Bound">L</a><a id="30048" class="Symbol">})</a></pre>

<h2 id="notes">Notes</h2>

<p>Most of the properties and proofs in this file are based on the paper
<em>Autosubst: Reasoning with de Bruijn Terms and Parallel Substitution</em>
by Schafer, Tebbi, and Smolka (ITP 2015). That paper, in turn, is
based on the paper of Abadi, Cardelli, Curien, and Levy (1991) that
defines the σ algebra.</p>

<h2 id="unicode">Unicode</h2>

<p>This chapter uses the following unicode:
    ⟪  U+27EA  MATHEMATICAL LEFT DOUBLE ANGLE BRACKET (&lt;&lt;)
    ⟫  U+27EA  MATHEMATICAL RIGHT DOUBLE ANGLE BRACKET (&gt;&gt;)
    ↑  U+2191  UPWARDS ARROW (\u)
    •  U+2022  BULLET (\bub)
    ⨟  U+2A1F  Z NOTATION SCHEMA COMPOSITION (C-x 8 RET Z NOTATION SCHEMA COMPOSITION)
    〔  U+3014  LEFT TORTOISE SHELL BRACKET (( option 9 on page 2)
    〕  U+3015  RIGHT TORTOISE SHELL BRACKET () option 9 on page 2)</p>


  </div>

  <p style="text-align:center;">
    
    <a alt="Previous chapter" href="/Untyped/">Prev</a>
    &bullet;
    
    
    <a alt="Source code" href="https://github.com/plfa/plfa.github.io/blob/dev/src/plfa/Substitution.lagda">Source</a>
    
    
    &bullet;
    <a alt="Next chapter" href="/LambdaReduction/">Next</a>
    
</p>


</article>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <h2 class="footer-heading">Programming Language Foundations in Agda
</h2><div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li class="p-name">Philip Wadler</li>
          <li><a class="u-email" href="mailto:wadler@inf.ed.ac.uk">wadler@inf.ed.ac.uk</a></li>
        </ul>
      </div>

      <div class="footer-col footer-col-2"><ul class="social-media-list"><li><a href="https://github.com/wadler"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#github"></use></svg> <span class="username">wadler</span></a></li></ul>
</div>

      <div class="footer-col footer-col-3"></div>
    </div><div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li class="p-name">Wen Kokke</li>
          <li><a class="u-email" href="mailto:wen.kokke@ed.ac.uk">wen.kokke@ed.ac.uk</a></li>
        </ul>
      </div>

      <div class="footer-col footer-col-2"><ul class="social-media-list"><li><a href="https://github.com/wenkokke"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#github"></use></svg> <span class="username">wenkokke</span></a></li><li><a href="https://www.twitter.com/wenkokke"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#twitter"></use></svg> <span class="username">wenkokke</span></a></li></ul>
</div>

      <div class="footer-col footer-col-3"></div>
    </div>This work is licensed under a <a rel="license" href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution 4.0 International License</a>
  </div>
</footer>
<!-- Import jQuery -->
<script type="text/javascript" src="/assets/jquery.js"></script>

<!-- Script which allows for foldable code blocks -->
<script type="text/javascript">
 $('div.foldable pre').each(function(){
     var autoHeight = $(this).height();
     var lineHeight = parseFloat($(this).css('line-height'));

     var plus    = $("<div></div>");
     var horLine = $("<div></div>");
     var verLine = $("<div></div>");
     $(this).prepend(plus);
     plus.css({
         'position'         : 'relative',
         'float'            : 'right',
         'right'            : '-' + (0.5 * lineHeight - 1.5) + 'px',
         'width'            : lineHeight,
         'height'           : lineHeight});
     verLine.css({
         'position'         : 'relative',
         'height'           : lineHeight,
         'width'            : '3px',
         'background-color' : '#C1E0FF'});
     horLine.css({
         'position'         : 'relative',
         'top'              : '-' + (0.5 * lineHeight + 1.5) + 'px',
         'left'             : '-' + (0.5 * lineHeight - 1.5) + 'px',
         'height'           : '3px',
         'width'            : lineHeight,
         'background-color' : '#C1E0FF'});
     plus.append(verLine);
     plus.append(horLine);

     $(this).height(2.0 * lineHeight);
     $(this).css('overflow','hidden');

     $(this).click(function(){
         if ($(this).height() == autoHeight) {
             $(this).height(2.0 * lineHeight);
             plus.show();
         }
         else {
             $(this).height('auto');
             plus.hide();
         }
     });
 });
</script>

<!-- Import KaTeX -->
<script type="text/javascript" src="/assets/katex.js"></script>

<!-- Script which renders TeX using KaTeX -->
<script type="text/javascript">
 $("script[type='math/tex']").replaceWith(
     function(){
         var tex = $(this).text();
         return "<span class=\"inline-equation\">" +
                katex.renderToString(tex) +
                "</span>";
     });
 $("script[type='math/tex; mode=display']").replaceWith(
     function(){
         var tex = $(this).text().replace(/%.*?(\n|$)/g,"");
         return "<div class=\"equation\">" +
                katex.renderToString("\\displaystyle "+tex) +
                "</div>";
     });
</script>
</body>

</html>
